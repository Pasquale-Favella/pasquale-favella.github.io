(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[494],{72917:function(e,t,n){(()=>{"use strict";var t={491:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;let r=n(223),o=n(172),i=n(930),s="context",a=new r.NoopContextManager;class l{constructor(){}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalContextManager(e){return(0,o.registerGlobal)(s,e,i.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,t,n,...r){return this._getContextManager().with(e,t,n,...r)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return(0,o.getGlobal)(s)||a}disable(){this._getContextManager().disable(),(0,o.unregisterGlobal)(s,i.DiagAPI.instance())}}t.ContextAPI=l},930:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagAPI=void 0;let r=n(56),o=n(912),i=n(957),s=n(172);class a{constructor(){function e(e){return function(...t){let n=(0,s.getGlobal)("diag");if(n)return n[e](...t)}}let t=this;t.setLogger=(e,n={logLevel:i.DiagLogLevel.INFO})=>{var r,a,l;if(e===t){let e=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(r=e.stack)&&void 0!==r?r:e.message),!1}"number"==typeof n&&(n={logLevel:n});let u=(0,s.getGlobal)("diag"),c=(0,o.createLogLevelDiagLogger)(null!==(a=n.logLevel)&&void 0!==a?a:i.DiagLogLevel.INFO,e);if(u&&!n.suppressOverrideMessage){let e=null!==(l=Error().stack)&&void 0!==l?l:"<failed to generate stacktrace>";u.warn(`Current logger will be overwritten from ${e}`),c.warn(`Current logger will overwrite one already registered from ${e}`)}return(0,s.registerGlobal)("diag",c,t,!0)},t.disable=()=>{(0,s.unregisterGlobal)("diag",t)},t.createComponentLogger=e=>new r.DiagComponentLogger(e),t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}static instance(){return this._instance||(this._instance=new a),this._instance}}t.DiagAPI=a},653:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;let r=n(660),o=n(172),i=n(930),s="metrics";class a{constructor(){}static getInstance(){return this._instance||(this._instance=new a),this._instance}setGlobalMeterProvider(e){return(0,o.registerGlobal)(s,e,i.DiagAPI.instance())}getMeterProvider(){return(0,o.getGlobal)(s)||r.NOOP_METER_PROVIDER}getMeter(e,t,n){return this.getMeterProvider().getMeter(e,t,n)}disable(){(0,o.unregisterGlobal)(s,i.DiagAPI.instance())}}t.MetricsAPI=a},181:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;let r=n(172),o=n(874),i=n(194),s=n(277),a=n(369),l=n(930),u="propagation",c=new o.NoopTextMapPropagator;class p{constructor(){this.createBaggage=a.createBaggage,this.getBaggage=s.getBaggage,this.getActiveBaggage=s.getActiveBaggage,this.setBaggage=s.setBaggage,this.deleteBaggage=s.deleteBaggage}static getInstance(){return this._instance||(this._instance=new p),this._instance}setGlobalPropagator(e){return(0,r.registerGlobal)(u,e,l.DiagAPI.instance())}inject(e,t,n=i.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,t,n)}extract(e,t,n=i.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,t,n)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,r.unregisterGlobal)(u,l.DiagAPI.instance())}_getGlobalPropagator(){return(0,r.getGlobal)(u)||c}}t.PropagationAPI=p},997:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;let r=n(172),o=n(846),i=n(139),s=n(607),a=n(930),l="trace";class u{constructor(){this._proxyTracerProvider=new o.ProxyTracerProvider,this.wrapSpanContext=i.wrapSpanContext,this.isSpanContextValid=i.isSpanContextValid,this.deleteSpan=s.deleteSpan,this.getSpan=s.getSpan,this.getActiveSpan=s.getActiveSpan,this.getSpanContext=s.getSpanContext,this.setSpan=s.setSpan,this.setSpanContext=s.setSpanContext}static getInstance(){return this._instance||(this._instance=new u),this._instance}setGlobalTracerProvider(e){let t=(0,r.registerGlobal)(l,this._proxyTracerProvider,a.DiagAPI.instance());return t&&this._proxyTracerProvider.setDelegate(e),t}getTracerProvider(){return(0,r.getGlobal)(l)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){(0,r.unregisterGlobal)(l,a.DiagAPI.instance()),this._proxyTracerProvider=new o.ProxyTracerProvider}}t.TraceAPI=u},277:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBaggage=t.setBaggage=t.getActiveBaggage=t.getBaggage=void 0;let r=n(491),o=(0,n(780).createContextKey)("OpenTelemetry Baggage Key");function i(e){return e.getValue(o)||void 0}t.getBaggage=i,t.getActiveBaggage=function(){return i(r.ContextAPI.getInstance().active())},t.setBaggage=function(e,t){return e.setValue(o,t)},t.deleteBaggage=function(e){return e.deleteValue(o)}},993:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaggageImpl=void 0;class n{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){let t=this._entries.get(e);if(t)return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map(([e,t])=>[e,t])}setEntry(e,t){let r=new n(this._entries);return r._entries.set(e,t),r}removeEntry(e){let t=new n(this._entries);return t._entries.delete(e),t}removeEntries(...e){let t=new n(this._entries);for(let n of e)t._entries.delete(n);return t}clear(){return new n}}t.BaggageImpl=n},830:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataSymbol=void 0,t.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataFromString=t.createBaggage=void 0;let r=n(930),o=n(993),i=n(830),s=r.DiagAPI.instance();t.createBaggage=function(e={}){return new o.BaggageImpl(new Map(Object.entries(e)))},t.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(s.error(`Cannot create baggage metadata from unknown type: ${typeof e}`),e=""),{__TYPE__:i.baggageEntryMetadataSymbol,toString:()=>e}}},67:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.context=void 0;let r=n(491);t.context=r.ContextAPI.getInstance()},223:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;let r=n(780);class o{active(){return r.ROOT_CONTEXT}with(e,t,n,...r){return t.call(n,...r)}bind(e,t){return t}enable(){return this}disable(){return this}}t.NoopContextManager=o},780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_CONTEXT=t.createContextKey=void 0,t.createContextKey=function(e){return Symbol.for(e)};class n{constructor(e){let t=this;t._currentContext=e?new Map(e):new Map,t.getValue=e=>t._currentContext.get(e),t.setValue=(e,r)=>{let o=new n(t._currentContext);return o._currentContext.set(e,r),o},t.deleteValue=e=>{let r=new n(t._currentContext);return r._currentContext.delete(e),r}}}t.ROOT_CONTEXT=new n},506:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.diag=void 0;let r=n(930);t.diag=r.DiagAPI.instance()},56:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagComponentLogger=void 0;let r=n(172);class o{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return i("debug",this._namespace,e)}error(...e){return i("error",this._namespace,e)}info(...e){return i("info",this._namespace,e)}warn(...e){return i("warn",this._namespace,e)}verbose(...e){return i("verbose",this._namespace,e)}}function i(e,t,n){let o=(0,r.getGlobal)("diag");if(o)return n.unshift(t),o[e](...n)}t.DiagComponentLogger=o},972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagConsoleLogger=void 0;let n=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class r{constructor(){for(let e=0;e<n.length;e++)this[n[e].n]=function(e){return function(...t){if(console){let n=console[e];if("function"!=typeof n&&(n=console.log),"function"==typeof n)return n.apply(console,t)}}}(n[e].c)}}t.DiagConsoleLogger=r},912:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogLevelDiagLogger=void 0;let r=n(957);t.createLogLevelDiagLogger=function(e,t){function n(n,r){let o=t[n];return"function"==typeof o&&e>=r?o.bind(t):function(){}}return e<r.DiagLogLevel.NONE?e=r.DiagLogLevel.NONE:e>r.DiagLogLevel.ALL&&(e=r.DiagLogLevel.ALL),t=t||{},{error:n("error",r.DiagLogLevel.ERROR),warn:n("warn",r.DiagLogLevel.WARN),info:n("info",r.DiagLogLevel.INFO),debug:n("debug",r.DiagLogLevel.DEBUG),verbose:n("verbose",r.DiagLogLevel.VERBOSE)}}},957:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DiagLogLevel=void 0,(n=t.DiagLogLevel||(t.DiagLogLevel={}))[n.NONE=0]="NONE",n[n.ERROR=30]="ERROR",n[n.WARN=50]="WARN",n[n.INFO=60]="INFO",n[n.DEBUG=70]="DEBUG",n[n.VERBOSE=80]="VERBOSE",n[n.ALL=9999]="ALL"},172:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;let r=n(200),o=n(521),i=n(130),s=o.VERSION.split(".")[0],a=Symbol.for(`opentelemetry.js.api.${s}`),l=r._globalThis;t.registerGlobal=function(e,t,n,r=!1){var i;let s=l[a]=null!==(i=l[a])&&void 0!==i?i:{version:o.VERSION};if(!r&&s[e]){let t=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);return n.error(t.stack||t.message),!1}if(s.version!==o.VERSION){let t=Error(`@opentelemetry/api: Registration of version v${s.version} for ${e} does not match previously registered API v${o.VERSION}`);return n.error(t.stack||t.message),!1}return s[e]=t,n.debug(`@opentelemetry/api: Registered a global for ${e} v${o.VERSION}.`),!0},t.getGlobal=function(e){var t,n;let r=null===(t=l[a])||void 0===t?void 0:t.version;if(r&&(0,i.isCompatible)(r))return null===(n=l[a])||void 0===n?void 0:n[e]},t.unregisterGlobal=function(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${o.VERSION}.`);let n=l[a];n&&delete n[e]}},130:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCompatible=t._makeCompatibilityCheck=void 0;let r=n(521),o=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function i(e){let t=new Set([e]),n=new Set,r=e.match(o);if(!r)return()=>!1;let i={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(null!=i.prerelease)return function(t){return t===e};function s(e){return n.add(e),!1}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;let r=e.match(o);if(!r)return s(e);let a={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};return null!=a.prerelease||i.major!==a.major?s(e):0===i.major?i.minor===a.minor&&i.patch<=a.patch?(t.add(e),!0):s(e):i.minor<=a.minor?(t.add(e),!0):s(e)}}t._makeCompatibilityCheck=i,t.isCompatible=i(r.VERSION)},886:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metrics=void 0;let r=n(653);t.metrics=r.MetricsAPI.getInstance()},901:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,(n=t.ValueType||(t.ValueType={}))[n.INT=0]="INT",n[n.DOUBLE=1]="DOUBLE"},102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopMeter=t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=t.NOOP_OBSERVABLE_GAUGE_METRIC=t.NOOP_OBSERVABLE_COUNTER_METRIC=t.NOOP_UP_DOWN_COUNTER_METRIC=t.NOOP_HISTOGRAM_METRIC=t.NOOP_COUNTER_METRIC=t.NOOP_METER=t.NoopObservableUpDownCounterMetric=t.NoopObservableGaugeMetric=t.NoopObservableCounterMetric=t.NoopObservableMetric=t.NoopHistogramMetric=t.NoopUpDownCounterMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;class n{constructor(){}createHistogram(e,n){return t.NOOP_HISTOGRAM_METRIC}createCounter(e,n){return t.NOOP_COUNTER_METRIC}createUpDownCounter(e,n){return t.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,n){return t.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,n){return t.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,n){return t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}}t.NoopMeter=n;class r{}t.NoopMetric=r;class o extends r{add(e,t){}}t.NoopCounterMetric=o;class i extends r{add(e,t){}}t.NoopUpDownCounterMetric=i;class s extends r{record(e,t){}}t.NoopHistogramMetric=s;class a{addCallback(e){}removeCallback(e){}}t.NoopObservableMetric=a;class l extends a{}t.NoopObservableCounterMetric=l;class u extends a{}t.NoopObservableGaugeMetric=u;class c extends a{}t.NoopObservableUpDownCounterMetric=c,t.NOOP_METER=new n,t.NOOP_COUNTER_METRIC=new o,t.NOOP_HISTOGRAM_METRIC=new s,t.NOOP_UP_DOWN_COUNTER_METRIC=new i,t.NOOP_OBSERVABLE_COUNTER_METRIC=new l,t.NOOP_OBSERVABLE_GAUGE_METRIC=new u,t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new c,t.createNoopMeter=function(){return t.NOOP_METER}},660:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;let r=n(102);class o{getMeter(e,t,n){return r.NOOP_METER}}t.NoopMeterProvider=o,t.NOOP_METER_PROVIDER=new o},200:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(46),t)},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:n.g},46:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(651),t)},939:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=void 0;let r=n(181);t.propagation=r.PropagationAPI.getInstance()},874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTextMapPropagator=void 0;class n{inject(e,t){}extract(e,t){return e}fields(){return[]}}t.NoopTextMapPropagator=n},194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTextMapSetter=t.defaultTextMapGetter=void 0,t.defaultTextMapGetter={get(e,t){if(null!=e)return e[t]},keys:e=>null==e?[]:Object.keys(e)},t.defaultTextMapSetter={set(e,t,n){null!=e&&(e[t]=n)}}},845:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trace=void 0;let r=n(997);t.trace=r.TraceAPI.getInstance()},403:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonRecordingSpan=void 0;let r=n(476);class o{constructor(e=r.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,t){}}t.NonRecordingSpan=o},614:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracer=void 0;let r=n(491),o=n(607),i=n(403),s=n(139),a=r.ContextAPI.getInstance();class l{startSpan(e,t,n=a.active()){if(null==t?void 0:t.root)return new i.NonRecordingSpan;let r=n&&(0,o.getSpanContext)(n);return"object"==typeof r&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&(0,s.isSpanContextValid)(r)?new i.NonRecordingSpan(r):new i.NonRecordingSpan}startActiveSpan(e,t,n,r){let i,s,l;if(arguments.length<2)return;2==arguments.length?l=t:3==arguments.length?(i=t,l=n):(i=t,s=n,l=r);let u=null!=s?s:a.active(),c=this.startSpan(e,i,u),p=(0,o.setSpan)(u,c);return a.with(p,l,void 0,c)}}t.NoopTracer=l},124:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracerProvider=void 0;let r=n(614);class o{getTracer(e,t,n){return new r.NoopTracer}}t.NoopTracerProvider=o},125:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracer=void 0;let r=new(n(614)).NoopTracer;class o{constructor(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}startSpan(e,t,n){return this._getTracer().startSpan(e,t,n)}startActiveSpan(e,t,n,r){let o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)}_getTracer(){if(this._delegate)return this._delegate;let e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):r}}t.ProxyTracer=o},846:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracerProvider=void 0;let r=n(125),o=new(n(124)).NoopTracerProvider;class i{getTracer(e,t,n){var o;return null!==(o=this.getDelegateTracer(e,t,n))&&void 0!==o?o:new r.ProxyTracer(this,e,t,n)}getDelegate(){var e;return null!==(e=this._delegate)&&void 0!==e?e:o}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,n)}}t.ProxyTracerProvider=i},996:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,(n=t.SamplingDecision||(t.SamplingDecision={}))[n.NOT_RECORD=0]="NOT_RECORD",n[n.RECORD=1]="RECORD",n[n.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"},607:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpanContext=t.setSpanContext=t.deleteSpan=t.setSpan=t.getActiveSpan=t.getSpan=void 0;let r=n(780),o=n(403),i=n(491),s=(0,r.createContextKey)("OpenTelemetry Context Key SPAN");function a(e){return e.getValue(s)||void 0}function l(e,t){return e.setValue(s,t)}t.getSpan=a,t.getActiveSpan=function(){return a(i.ContextAPI.getInstance().active())},t.setSpan=l,t.deleteSpan=function(e){return e.deleteValue(s)},t.setSpanContext=function(e,t){return l(e,new o.NonRecordingSpan(t))},t.getSpanContext=function(e){var t;return null===(t=a(e))||void 0===t?void 0:t.spanContext()}},325:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceStateImpl=void 0;let r=n(564);class o{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce((e,t)=>{let n=t.trim(),o=n.indexOf("=");if(-1!==o){let i=n.slice(0,o),s=n.slice(o+1,t.length);(0,r.validateKey)(i)&&(0,r.validateValue)(s)&&e.set(i,s)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new o;return e._internalState=new Map(this._internalState),e}}t.TraceStateImpl=o},564:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateValue=t.validateKey=void 0;let n="[_0-9a-z-*/]",r=`[a-z]${n}{0,255}`,o=`[a-z0-9]${n}{0,240}@[a-z]${n}{0,13}`,i=RegExp(`^(?:${r}|${o})$`),s=/^[ -~]{0,255}[!-~]$/,a=/,|=/;t.validateKey=function(e){return i.test(e)},t.validateValue=function(e){return s.test(e)&&!a.test(e)}},98:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTraceState=void 0;let r=n(325);t.createTraceState=function(e){return new r.TraceStateImpl(e)}},476:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;let r=n(475);t.INVALID_SPANID="0000000000000000",t.INVALID_TRACEID="00000000000000000000000000000000",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:r.TraceFlags.NONE}},357:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,(n=t.SpanKind||(t.SpanKind={}))[n.INTERNAL=0]="INTERNAL",n[n.SERVER=1]="SERVER",n[n.CLIENT=2]="CLIENT",n[n.PRODUCER=3]="PRODUCER",n[n.CONSUMER=4]="CONSUMER"},139:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSpanContext=t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=void 0;let r=n(476),o=n(403),i=/^([0-9a-f]{32})$/i,s=/^[0-9a-f]{16}$/i;function a(e){return i.test(e)&&e!==r.INVALID_TRACEID}function l(e){return s.test(e)&&e!==r.INVALID_SPANID}t.isValidTraceId=a,t.isValidSpanId=l,t.isSpanContextValid=function(e){return a(e.traceId)&&l(e.spanId)},t.wrapSpanContext=function(e){return new o.NonRecordingSpan(e)}},847:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SpanStatusCode=void 0,(n=t.SpanStatusCode||(t.SpanStatusCode={}))[n.UNSET=0]="UNSET",n[n.OK=1]="OK",n[n.ERROR=2]="ERROR"},475:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,(n=t.TraceFlags||(t.TraceFlags={}))[n.NONE=0]="NONE",n[n.SAMPLED=1]="SAMPLED"},521:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="1.6.0"}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}},s=!0;try{t[e].call(i.exports,i,i.exports,o),s=!1}finally{s&&delete r[e]}return i.exports}o.ab="//";var i={};(()=>{Object.defineProperty(i,"__esModule",{value:!0}),i.trace=i.propagation=i.metrics=i.diag=i.context=i.INVALID_SPAN_CONTEXT=i.INVALID_TRACEID=i.INVALID_SPANID=i.isValidSpanId=i.isValidTraceId=i.isSpanContextValid=i.createTraceState=i.TraceFlags=i.SpanStatusCode=i.SpanKind=i.SamplingDecision=i.ProxyTracerProvider=i.ProxyTracer=i.defaultTextMapSetter=i.defaultTextMapGetter=i.ValueType=i.createNoopMeter=i.DiagLogLevel=i.DiagConsoleLogger=i.ROOT_CONTEXT=i.createContextKey=i.baggageEntryMetadataFromString=void 0;var e=o(369);Object.defineProperty(i,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return e.baggageEntryMetadataFromString}});var t=o(780);Object.defineProperty(i,"createContextKey",{enumerable:!0,get:function(){return t.createContextKey}}),Object.defineProperty(i,"ROOT_CONTEXT",{enumerable:!0,get:function(){return t.ROOT_CONTEXT}});var n=o(972);Object.defineProperty(i,"DiagConsoleLogger",{enumerable:!0,get:function(){return n.DiagConsoleLogger}});var r=o(957);Object.defineProperty(i,"DiagLogLevel",{enumerable:!0,get:function(){return r.DiagLogLevel}});var s=o(102);Object.defineProperty(i,"createNoopMeter",{enumerable:!0,get:function(){return s.createNoopMeter}});var a=o(901);Object.defineProperty(i,"ValueType",{enumerable:!0,get:function(){return a.ValueType}});var l=o(194);Object.defineProperty(i,"defaultTextMapGetter",{enumerable:!0,get:function(){return l.defaultTextMapGetter}}),Object.defineProperty(i,"defaultTextMapSetter",{enumerable:!0,get:function(){return l.defaultTextMapSetter}});var u=o(125);Object.defineProperty(i,"ProxyTracer",{enumerable:!0,get:function(){return u.ProxyTracer}});var c=o(846);Object.defineProperty(i,"ProxyTracerProvider",{enumerable:!0,get:function(){return c.ProxyTracerProvider}});var p=o(996);Object.defineProperty(i,"SamplingDecision",{enumerable:!0,get:function(){return p.SamplingDecision}});var d=o(357);Object.defineProperty(i,"SpanKind",{enumerable:!0,get:function(){return d.SpanKind}});var h=o(847);Object.defineProperty(i,"SpanStatusCode",{enumerable:!0,get:function(){return h.SpanStatusCode}});var f=o(475);Object.defineProperty(i,"TraceFlags",{enumerable:!0,get:function(){return f.TraceFlags}});var m=o(98);Object.defineProperty(i,"createTraceState",{enumerable:!0,get:function(){return m.createTraceState}});var g=o(139);Object.defineProperty(i,"isSpanContextValid",{enumerable:!0,get:function(){return g.isSpanContextValid}}),Object.defineProperty(i,"isValidTraceId",{enumerable:!0,get:function(){return g.isValidTraceId}}),Object.defineProperty(i,"isValidSpanId",{enumerable:!0,get:function(){return g.isValidSpanId}});var y=o(476);Object.defineProperty(i,"INVALID_SPANID",{enumerable:!0,get:function(){return y.INVALID_SPANID}}),Object.defineProperty(i,"INVALID_TRACEID",{enumerable:!0,get:function(){return y.INVALID_TRACEID}}),Object.defineProperty(i,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return y.INVALID_SPAN_CONTEXT}});let v=o(67);Object.defineProperty(i,"context",{enumerable:!0,get:function(){return v.context}});let b=o(506);Object.defineProperty(i,"diag",{enumerable:!0,get:function(){return b.diag}});let w=o(886);Object.defineProperty(i,"metrics",{enumerable:!0,get:function(){return w.metrics}});let x=o(939);Object.defineProperty(i,"propagation",{enumerable:!0,get:function(){return x.propagation}});let k=o(845);Object.defineProperty(i,"trace",{enumerable:!0,get:function(){return k.trace}}),i.default={context:v.context,diag:b.diag,metrics:w.metrics,propagation:x.propagation,trace:k.trace}})(),e.exports=i})()},58833:function(e,t,n){"use strict";var r=n(48764).lW;let o=void 0!==r,i=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,s=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function a(e,t,n){null==n&&null!==t&&"object"==typeof t&&(n=t,t=void 0),o&&r.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let a=JSON.parse(e,t);if(null===a||"object"!=typeof a)return a;let u=n&&n.protoAction||"error",c=n&&n.constructorAction||"error";if("ignore"===u&&"ignore"===c)return a;if("ignore"!==u&&"ignore"!==c){if(!1===i.test(e)&&!1===s.test(e))return a}else if("ignore"!==u&&"ignore"===c){if(!1===i.test(e))return a}else if(!1===s.test(e))return a;return l(a,{protoAction:u,constructorAction:c,safe:n&&n.safe})}function l(e,{protoAction:t="error",constructorAction:n="error",safe:r}={}){let o=[e];for(;o.length;){let e=o;for(let i of(o=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(i,"__proto__")){if(!0===r)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete i.__proto__}if("ignore"!==n&&Object.prototype.hasOwnProperty.call(i,"constructor")&&Object.prototype.hasOwnProperty.call(i.constructor,"prototype")){if(!0===r)return null;if("error"===n)throw SyntaxError("Object contains forbidden prototype property");delete i.constructor}for(let e in i){let t=i[e];t&&"object"==typeof t&&o.push(t)}}}return e}function u(e,t,n){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return a(e,t,n)}finally{Error.stackTraceLimit=r}}e.exports=u,e.exports.default=u,e.exports.parse=u,e.exports.safeParse=function(e,t){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return a(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=n}},e.exports.scan=l},20443:function(e,t,n){"use strict";n.d(t,{D:function(){return w}});var r=n(5045),o=n(989),i=n(1604),s=i.z.object({type:i.z.literal("error"),error:i.z.object({type:i.z.string(),message:i.z.string()})}),a=(0,o.Sq)({errorSchema:s,errorToMessage:e=>e.error.message});function l(e){switch(e){case"end_turn":case"stop_sequence":return"stop";case"tool_use":return"tool-calls";case"max_tokens":return"length";default:return"unknown"}}var u=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}supportsUrl(e){return"https:"===e.protocol}get provider(){return this.config.provider}get supportsImageUrls(){return this.config.supportsImageUrls}async getArgs({mode:e,prompt:t,maxTokens:n=4096,temperature:i,topP:s,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:p,seed:h,providerMetadata:f}){var m,g,y;let v=e.type,b=[];null!=l&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=u&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=h&&b.push({type:"unsupported-setting",setting:"seed"}),null!=p&&"text"!==p.type&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:w,betas:x}=function({prompt:e,sendReasoning:t,warnings:n}){var i,s,a,l;let u;let c=new Set,p=function(e){let t;let n=[];for(let r of e){let{role:e}=r;switch(e){case"system":(null==t?void 0:t.type)!=="system"&&(t={type:"system",messages:[]},n.push(t)),t.messages.push(r);break;case"assistant":(null==t?void 0:t.type)!=="assistant"&&(t={type:"assistant",messages:[]},n.push(t)),t.messages.push(r);break;case"user":case"tool":(null==t?void 0:t.type)!=="user"&&(t={type:"user",messages:[]},n.push(t)),t.messages.push(r);break;default:throw Error(`Unsupported role: ${e}`)}}return n}(e),d=[];function h(e){var t;let n=null==e?void 0:e.anthropic;return null!=(t=null==n?void 0:n.cacheControl)?t:null==n?void 0:n.cache_control}for(let e=0;e<p.length;e++){let f=p[e],m=e===p.length-1,g=f.type;switch(g){case"system":if(null!=u)throw new r.A_({functionality:"Multiple system messages that are separated by user/assistant messages"});u=f.messages.map(({content:e,providerMetadata:t})=>({type:"text",text:e,cache_control:h(t)}));break;case"user":{let e=[];for(let t of f.messages){let{role:n,content:l}=t;switch(n){case"user":for(let n=0;n<l.length;n++){let a=l[n],u=n===l.length-1,p=null!=(i=h(a.providerMetadata))?i:u?h(t.providerMetadata):void 0;switch(a.type){case"text":e.push({type:"text",text:a.text,cache_control:p});break;case"image":e.push({type:"image",source:a.image instanceof URL?{type:"url",url:a.image.toString()}:{type:"base64",media_type:null!=(s=a.mimeType)?s:"image/jpeg",data:(0,o.k0)(a.image)},cache_control:p});break;case"file":if("application/pdf"!==a.mimeType)throw new r.A_({functionality:"Non-PDF files in user messages"});c.add("pdfs-2024-09-25"),e.push({type:"document",source:a.data instanceof URL?{type:"url",url:a.data.toString()}:{type:"base64",media_type:"application/pdf",data:a.data},cache_control:p})}}break;case"tool":for(let n=0;n<l.length;n++){let r=l[n],o=n===l.length-1,i=null!=(a=h(r.providerMetadata))?a:o?h(t.providerMetadata):void 0,s=null!=r.content?r.content.map(e=>{var t;switch(e.type){case"text":return{type:"text",text:e.text,cache_control:void 0};case"image":return{type:"image",source:{type:"base64",media_type:null!=(t=e.mimeType)?t:"image/jpeg",data:e.data},cache_control:void 0}}}):JSON.stringify(r.result);e.push({type:"tool_result",tool_use_id:r.toolCallId,content:s,is_error:r.isError,cache_control:i})}break;default:throw Error(`Unsupported role: ${n}`)}}d.push({role:"user",content:e});break}case"assistant":{let e=[];for(let r=0;r<f.messages.length;r++){let o=f.messages[r],i=r===f.messages.length-1,{content:s}=o;for(let r=0;r<s.length;r++){let a=s[r],u=r===s.length-1,c=null!=(l=h(a.providerMetadata))?l:u?h(o.providerMetadata):void 0;switch(a.type){case"text":e.push({type:"text",text:m&&i&&u?a.text.trim():a.text,cache_control:c});break;case"reasoning":t?e.push({type:"thinking",thinking:a.text,signature:a.signature,cache_control:c}):n.push({type:"other",message:"sending reasoning content is disabled for this model"});break;case"redacted-reasoning":e.push({type:"redacted_thinking",data:a.data,cache_control:c});break;case"tool-call":e.push({type:"tool_use",id:a.toolCallId,name:a.toolName,input:a.args,cache_control:c})}}}d.push({role:"assistant",content:e});break}default:throw Error(`Unsupported type: ${g}`)}}return{prompt:{system:u,messages:d},betas:c}}({prompt:t,sendReasoning:null==(m=this.settings.sendReasoning)||m,warnings:b}),k=(0,o.c1)({provider:"anthropic",providerOptions:f,schema:d}),_=(null==(g=null==k?void 0:k.thinking)?void 0:g.type)==="enabled",S=null==(y=null==k?void 0:k.thinking)?void 0:y.budgetTokens,T={model:this.modelId,max_tokens:n,temperature:i,top_k:a,top_p:s,stop_sequences:c,..._&&{thinking:{type:"enabled",budget_tokens:S}},system:w.system,messages:w.messages};if(_){if(null==S)throw new r.A_({functionality:"thinking requires a budget"});null!=T.temperature&&(T.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported when thinking is enabled"})),null!=a&&(T.top_k=void 0,b.push({type:"unsupported-setting",setting:"topK",details:"topK is not supported when thinking is enabled"})),null!=s&&(T.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported when thinking is enabled"})),T.max_tokens=n+S}switch(v){case"regular":{let{tools:t,tool_choice:n,toolWarnings:o,betas:i}=function(e){var t;let n=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0,o=[],i=new Set;if(null==n)return{tools:void 0,tool_choice:void 0,toolWarnings:o,betas:i};let s=[];for(let e of n)switch(e.type){case"function":s.push({name:e.name,description:e.description,input_schema:e.parameters});break;case"provider-defined":switch(e.id){case"anthropic.computer_20250124":i.add("computer-use-2025-01-24"),s.push({name:e.name,type:"computer_20250124",display_width_px:e.args.displayWidthPx,display_height_px:e.args.displayHeightPx,display_number:e.args.displayNumber});break;case"anthropic.computer_20241022":i.add("computer-use-2024-10-22"),s.push({name:e.name,type:"computer_20241022",display_width_px:e.args.displayWidthPx,display_height_px:e.args.displayHeightPx,display_number:e.args.displayNumber});break;case"anthropic.text_editor_20250124":i.add("computer-use-2025-01-24"),s.push({name:e.name,type:"text_editor_20250124"});break;case"anthropic.text_editor_20241022":i.add("computer-use-2024-10-22"),s.push({name:e.name,type:"text_editor_20241022"});break;case"anthropic.bash_20250124":i.add("computer-use-2025-01-24"),s.push({name:e.name,type:"bash_20250124"});break;case"anthropic.bash_20241022":i.add("computer-use-2024-10-22"),s.push({name:e.name,type:"bash_20241022"});break;default:o.push({type:"unsupported-tool",tool:e})}break;default:o.push({type:"unsupported-tool",tool:e})}let a=e.toolChoice;if(null==a)return{tools:s,tool_choice:void 0,toolWarnings:o,betas:i};let l=a.type;switch(l){case"auto":return{tools:s,tool_choice:{type:"auto"},toolWarnings:o,betas:i};case"required":return{tools:s,tool_choice:{type:"any"},toolWarnings:o,betas:i};case"none":return{tools:void 0,tool_choice:void 0,toolWarnings:o,betas:i};case"tool":return{tools:s,tool_choice:{type:"tool",name:a.toolName},toolWarnings:o,betas:i};default:throw new r.A_({functionality:`Unsupported tool choice type: ${l}`})}}(e);return{args:{...T,tools:t,tool_choice:n},warnings:[...b,...o],betas:new Set([...x,...i])}}case"object-json":throw new r.A_({functionality:"json-mode object generation"});case"object-tool":{let{name:t,description:n,parameters:r}=e.tool;return{args:{...T,tools:[{name:t,description:n,input_schema:r}],tool_choice:{type:"tool",name:t}},warnings:b,betas:x}}default:throw Error(`Unsupported type: ${v}`)}}async getHeaders({betas:e,headers:t}){return(0,o.NF)(await (0,o.DB)(this.config.headers),e.size>0?{"anthropic-beta":Array.from(e).join(",")}:{},t)}buildRequestUrl(e){var t,n,r;return null!=(r=null==(n=(t=this.config).buildRequestUrl)?void 0:n.call(t,this.config.baseURL,e))?r:`${this.config.baseURL}/messages`}transformRequestBody(e){var t,n,r;return null!=(r=null==(n=(t=this.config).transformRequestBody)?void 0:n.call(t,e))?r:e}async doGenerate(e){var t,n,r,i;let s;let{args:u,warnings:p,betas:d}=await this.getArgs(e),{responseHeaders:h,value:f,rawValue:m}=await (0,o.A8)({url:this.buildRequestUrl(!1),headers:await this.getHeaders({betas:d,headers:e.headers}),body:this.transformRequestBody(u),failedResponseHandler:a,successfulResponseHandler:(0,o.tc)(c),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:g,...y}=u,v="";for(let e of f.content)"text"===e.type&&(v+=e.text);if(f.content.some(e=>"tool_use"===e.type))for(let e of(s=[],f.content))"tool_use"===e.type&&s.push({toolCallType:"function",toolCallId:e.id,toolName:e.name,args:JSON.stringify(e.input)});let b=f.content.filter(e=>"redacted_thinking"===e.type||"thinking"===e.type).map(e=>"thinking"===e.type?{type:"text",text:e.thinking,signature:e.signature}:{type:"redacted",data:e.data});return{text:v,reasoning:b.length>0?b:void 0,toolCalls:s,finishReason:l(f.stop_reason),usage:{promptTokens:f.usage.input_tokens,completionTokens:f.usage.output_tokens},rawCall:{rawPrompt:g,rawSettings:y},rawResponse:{headers:h,body:m},response:{id:null!=(t=f.id)?t:void 0,modelId:null!=(n=f.model)?n:void 0},warnings:p,providerMetadata:{anthropic:{cacheCreationInputTokens:null!=(r=f.usage.cache_creation_input_tokens)?r:null,cacheReadInputTokens:null!=(i=f.usage.cache_read_input_tokens)?i:null}},request:{body:JSON.stringify(u)}}}async doStream(e){let t,n;let{args:r,warnings:i,betas:s}=await this.getArgs(e),u={...r,stream:!0},{responseHeaders:c,value:d}=await (0,o.A8)({url:this.buildRequestUrl(!0),headers:await this.getHeaders({betas:s,headers:e.headers}),body:this.transformRequestBody(u),failedResponseHandler:a,successfulResponseHandler:(0,o.cP)(p),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:h,...f}=r,m="unknown",g={promptTokens:Number.NaN,completionTokens:Number.NaN},y={};return{stream:d.pipeThrough(new TransformStream({transform(e,r){var o,i,s,a;if(!e.success){r.enqueue({type:"error",error:e.error});return}let u=e.value;switch(u.type){case"ping":return;case"content_block_start":{let e=u.content_block.type;switch(n=e,e){case"text":case"thinking":return;case"redacted_thinking":r.enqueue({type:"redacted-reasoning",data:u.content_block.data});return;case"tool_use":y[u.index]={toolCallId:u.content_block.id,toolName:u.content_block.name,jsonText:""};return;default:throw Error(`Unsupported content block type: ${e}`)}}case"content_block_stop":if(null!=y[u.index]){let e=y[u.index];r.enqueue({type:"tool-call",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,args:e.jsonText}),delete y[u.index]}n=void 0;return;case"content_block_delta":{let e=u.delta.type;switch(e){case"text_delta":r.enqueue({type:"text-delta",textDelta:u.delta.text});return;case"thinking_delta":r.enqueue({type:"reasoning",textDelta:u.delta.thinking});return;case"signature_delta":"thinking"===n&&r.enqueue({type:"reasoning-signature",signature:u.delta.signature});return;case"input_json_delta":{let e=y[u.index];r.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:u.delta.partial_json}),e.jsonText+=u.delta.partial_json;return}default:throw Error(`Unsupported delta type: ${e}`)}}case"message_start":g.promptTokens=u.message.usage.input_tokens,g.completionTokens=u.message.usage.output_tokens,t={anthropic:{cacheCreationInputTokens:null!=(o=u.message.usage.cache_creation_input_tokens)?o:null,cacheReadInputTokens:null!=(i=u.message.usage.cache_read_input_tokens)?i:null}},r.enqueue({type:"response-metadata",id:null!=(s=u.message.id)?s:void 0,modelId:null!=(a=u.message.model)?a:void 0});return;case"message_delta":g.completionTokens=u.usage.output_tokens,m=l(u.delta.stop_reason);return;case"message_stop":r.enqueue({type:"finish",finishReason:m,usage:g,providerMetadata:t});return;case"error":r.enqueue({type:"error",error:u.error});return;default:throw Error(`Unsupported chunk type: ${u}`)}}})),rawCall:{rawPrompt:h,rawSettings:f},rawResponse:{headers:c},warnings:i,request:{body:JSON.stringify(u)}}}},c=i.z.object({type:i.z.literal("message"),id:i.z.string().nullish(),model:i.z.string().nullish(),content:i.z.array(i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("text"),text:i.z.string()}),i.z.object({type:i.z.literal("thinking"),thinking:i.z.string(),signature:i.z.string()}),i.z.object({type:i.z.literal("redacted_thinking"),data:i.z.string()}),i.z.object({type:i.z.literal("tool_use"),id:i.z.string(),name:i.z.string(),input:i.z.unknown()})])),stop_reason:i.z.string().nullish(),usage:i.z.object({input_tokens:i.z.number(),output_tokens:i.z.number(),cache_creation_input_tokens:i.z.number().nullish(),cache_read_input_tokens:i.z.number().nullish()})}),p=i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("message_start"),message:i.z.object({id:i.z.string().nullish(),model:i.z.string().nullish(),usage:i.z.object({input_tokens:i.z.number(),output_tokens:i.z.number(),cache_creation_input_tokens:i.z.number().nullish(),cache_read_input_tokens:i.z.number().nullish()})})}),i.z.object({type:i.z.literal("content_block_start"),index:i.z.number(),content_block:i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("text"),text:i.z.string()}),i.z.object({type:i.z.literal("thinking"),thinking:i.z.string()}),i.z.object({type:i.z.literal("tool_use"),id:i.z.string(),name:i.z.string()}),i.z.object({type:i.z.literal("redacted_thinking"),data:i.z.string()})])}),i.z.object({type:i.z.literal("content_block_delta"),index:i.z.number(),delta:i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("input_json_delta"),partial_json:i.z.string()}),i.z.object({type:i.z.literal("text_delta"),text:i.z.string()}),i.z.object({type:i.z.literal("thinking_delta"),thinking:i.z.string()}),i.z.object({type:i.z.literal("signature_delta"),signature:i.z.string()})])}),i.z.object({type:i.z.literal("content_block_stop"),index:i.z.number()}),i.z.object({type:i.z.literal("error"),error:i.z.object({type:i.z.string(),message:i.z.string()})}),i.z.object({type:i.z.literal("message_delta"),delta:i.z.object({stop_reason:i.z.string().nullish()}),usage:i.z.object({output_tokens:i.z.number()})}),i.z.object({type:i.z.literal("message_stop")}),i.z.object({type:i.z.literal("ping")})]),d=i.z.object({thinking:i.z.object({type:i.z.union([i.z.literal("enabled"),i.z.literal("disabled")]),budgetTokens:i.z.number().optional()}).optional()}),h=i.z.object({command:i.z.string(),restart:i.z.boolean().optional()}),f=i.z.object({command:i.z.string(),restart:i.z.boolean().optional()}),m=i.z.object({command:i.z.enum(["view","create","str_replace","insert","undo_edit"]),path:i.z.string(),file_text:i.z.string().optional(),insert_line:i.z.number().int().optional(),new_str:i.z.string().optional(),old_str:i.z.string().optional(),view_range:i.z.array(i.z.number().int()).optional()}),g=i.z.object({command:i.z.enum(["view","create","str_replace","insert","undo_edit"]),path:i.z.string(),file_text:i.z.string().optional(),insert_line:i.z.number().int().optional(),new_str:i.z.string().optional(),old_str:i.z.string().optional(),view_range:i.z.array(i.z.number().int()).optional()}),y=i.z.object({action:i.z.enum(["key","type","mouse_move","left_click","left_click_drag","right_click","middle_click","double_click","screenshot","cursor_position"]),coordinate:i.z.array(i.z.number().int()).optional(),text:i.z.string().optional()}),v=i.z.object({action:i.z.enum(["key","hold_key","type","cursor_position","mouse_move","left_mouse_down","left_mouse_up","left_click","left_click_drag","right_click","middle_click","double_click","triple_click","scroll","wait","screenshot"]),coordinate:i.z.tuple([i.z.number().int(),i.z.number().int()]).optional(),duration:i.z.number().optional(),scroll_amount:i.z.number().optional(),scroll_direction:i.z.enum(["up","down","left","right"]).optional(),start_coordinate:i.z.tuple([i.z.number().int(),i.z.number().int()]).optional(),text:i.z.string().optional()}),b={bash_20241022:function(e={}){return{type:"provider-defined",id:"anthropic.bash_20241022",args:{},parameters:h,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}},bash_20250124:function(e={}){return{type:"provider-defined",id:"anthropic.bash_20250124",args:{},parameters:f,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}},textEditor_20241022:function(e={}){return{type:"provider-defined",id:"anthropic.text_editor_20241022",args:{},parameters:m,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}},textEditor_20250124:function(e={}){return{type:"provider-defined",id:"anthropic.text_editor_20250124",args:{},parameters:g,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}},computer_20241022:function(e){return{type:"provider-defined",id:"anthropic.computer_20241022",args:{displayWidthPx:e.displayWidthPx,displayHeightPx:e.displayHeightPx,displayNumber:e.displayNumber},parameters:y,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}},computer_20250124:function(e){return{type:"provider-defined",id:"anthropic.computer_20250124",args:{displayWidthPx:e.displayWidthPx,displayHeightPx:e.displayHeightPx,displayNumber:e.displayNumber},parameters:v,execute:e.execute,experimental_toToolResultContent:e.experimental_toToolResultContent}}};function w(e={}){var t;let n=null!=(t=(0,o.QT)(e.baseURL))?t:"https://api.anthropic.com/v1",i=()=>({"anthropic-version":"2023-06-01","x-api-key":(0,o.pd)({apiKey:e.apiKey,environmentVariableName:"ANTHROPIC_API_KEY",description:"Anthropic"}),...e.headers}),s=(t,r={})=>new u(t,r,{provider:"anthropic.messages",baseURL:n,headers:i,fetch:e.fetch,supportsImageUrls:!0}),a=function(e,t){if(new.target)throw Error("The Anthropic model function cannot be called with the new keyword.");return s(e,t)};return a.languageModel=s,a.chat=s,a.messages=s,a.textEmbeddingModel=e=>{throw new r.JJ({modelId:e,modelType:"textEmbeddingModel"})},a.tools=b,a}w()},24622:function(e,t,n){"use strict";n.d(t,{L:function(){return C}});var r=n(989),o=n(1604),i=n(5045);function s(e){if(null!=e&&"object"==typeof e&&"object"===e.type&&(null==e.properties||0===Object.keys(e.properties).length))return;if("boolean"==typeof e)return{type:"boolean",properties:{}};let{type:t,description:n,required:r,properties:o,items:i,allOf:a,anyOf:l,oneOf:u,format:c,const:p,minLength:d,enum:h}=e,f={};if(n&&(f.description=n),r&&(f.required=r),c&&(f.format=c),void 0!==p&&(f.enum=[p]),t&&(Array.isArray(t)?t.includes("null")?(f.type=t.filter(e=>"null"!==e)[0],f.nullable=!0):f.type=t:"null"===t?f.type="null":f.type=t),void 0!==h&&(f.enum=h),null!=o&&(f.properties=Object.entries(o).reduce((e,[t,n])=>(e[t]=s(n),e),{})),i&&(f.items=Array.isArray(i)?i.map(s):s(i)),a&&(f.allOf=a.map(s)),l){if(l.some(e=>"object"==typeof e&&(null==e?void 0:e.type)==="null")){let e=l.filter(e=>!("object"==typeof e&&(null==e?void 0:e.type)==="null"));if(1===e.length){let t=s(e[0]);"object"==typeof t&&(f.nullable=!0,Object.assign(f,t))}else f.anyOf=e.map(s),f.nullable=!0}else f.anyOf=l.map(s)}return u&&(f.oneOf=u.map(s)),void 0!==d&&(f.minLength=d),f}function a(e){return e.includes("/")?e:`models/${e}`}var l=o.z.object({error:o.z.object({code:o.z.number().nullable(),message:o.z.string(),status:o.z.string()})}),u=(0,r.Sq)({errorSchema:l,errorToMessage:e=>e.error.message});function c({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var p=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return null==(e=this.settings.structuredOutputs)||e}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:o,topP:a,topK:l,frequencyPenalty:u,presencePenalty:c,stopSequences:p,responseFormat:d,seed:h,providerMetadata:f}){var m,g,y;let v=e.type,b=[],w=(0,r.c1)({provider:"google",providerOptions:f,schema:_});(null==(m=null==w?void 0:w.thinkingConfig)?void 0:m.includeThoughts)!==!0||this.config.provider.startsWith("google.vertex.")||b.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});let x={maxOutputTokens:n,temperature:o,topK:l,topP:a,frequencyPenalty:u,presencePenalty:c,stopSequences:p,seed:h,responseMimeType:(null==d?void 0:d.type)==="json"?"application/json":void 0,responseSchema:(null==d?void 0:d.type)==="json"&&null!=d.schema&&this.supportsStructuredOutputs?s(d.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:null==w?void 0:w.responseModalities,thinkingConfig:null==w?void 0:w.thinkingConfig},{contents:k,systemInstruction:S}=function(e){var t,n;let o=[],s=[],a=!0;for(let{role:l,content:u}of e)switch(l){case"system":if(!a)throw new i.A_({functionality:"system messages are only supported at the beginning of the conversation"});o.push({text:u});break;case"user":{a=!1;let e=[];for(let o of u)switch(o.type){case"text":e.push({text:o.text});break;case"image":e.push(o.image instanceof URL?{fileData:{mimeType:null!=(t=o.mimeType)?t:"image/jpeg",fileUri:o.image.toString()}}:{inlineData:{mimeType:null!=(n=o.mimeType)?n:"image/jpeg",data:(0,r.k0)(o.image)}});break;case"file":e.push(o.data instanceof URL?{fileData:{mimeType:o.mimeType,fileUri:o.data.toString()}}:{inlineData:{mimeType:o.mimeType,data:o.data}})}s.push({role:"user",parts:e});break}case"assistant":a=!1,s.push({role:"model",parts:u.map(e=>{switch(e.type){case"text":return 0===e.text.length?void 0:{text:e.text};case"file":if("image/png"!==e.mimeType)throw new i.A_({functionality:"Only PNG images are supported in assistant messages"});if(e.data instanceof URL)throw new i.A_({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:e.mimeType,data:e.data}};case"tool-call":return{functionCall:{name:e.toolName,args:e.args}}}}).filter(e=>void 0!==e)});break;case"tool":a=!1,s.push({role:"user",parts:u.map(e=>({functionResponse:{name:e.toolName,response:{name:e.toolName,content:e.result}}}))})}return{systemInstruction:o.length>0?{parts:o}:void 0,contents:s}}(t);switch(v){case"regular":{let{tools:t,toolConfig:n,toolWarnings:r}=function(e,t,n,r){var o,a;let l=(null==(o=e.tools)?void 0:o.length)?e.tools:void 0,u=[],c=r.includes("gemini-2"),p=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:c?{googleSearch:{}}:{googleSearchRetrieval:p&&n?{dynamicRetrievalConfig:n}:{}},toolConfig:void 0,toolWarnings:u};if(null==l)return{tools:void 0,toolConfig:void 0,toolWarnings:u};let d=[];for(let e of l)"provider-defined"===e.type?u.push({type:"unsupported-tool",tool:e}):d.push({name:e.name,description:null!=(a=e.description)?a:"",parameters:s(e.parameters)});let h=e.toolChoice;if(null==h)return{tools:{functionDeclarations:d},toolConfig:void 0,toolWarnings:u};let f=h.type;switch(f){case"auto":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:u};case"none":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:u};case"required":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:u};case"tool":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[h.toolName]}},toolWarnings:u};default:throw new i.A_({functionality:`Unsupported tool choice type: ${f}`})}}(e,null!=(g=this.settings.useSearchGrounding)&&g,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:x,contents:k,systemInstruction:S,safetySettings:this.settings.safetySettings,tools:t,toolConfig:n,cachedContent:this.settings.cachedContent},warnings:[...b,...r]}}case"object-json":return{args:{generationConfig:{...x,responseMimeType:"application/json",responseSchema:null!=e.schema&&this.supportsStructuredOutputs?s(e.schema):void 0},contents:k,systemInstruction:S,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:b};case"object-tool":return{args:{generationConfig:x,contents:k,tools:{functionDeclarations:[{name:e.tool.name,description:null!=(y=e.tool.description)?y:"",parameters:s(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:b};default:throw Error(`Unsupported type: ${v}`)}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,o,i,s;let{args:l,warnings:p}=await this.getArgs(e),y=JSON.stringify(l),v=(0,r.NF)(await (0,r.DB)(this.config.headers),e.headers),{responseHeaders:b,value:w,rawValue:k}=await (0,r.A8)({url:`${this.config.baseURL}/${a(this.modelId)}:generateContent`,headers:v,body:l,failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(x),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:_,...S}=l,T=w.candidates[0],E=null!=T.content&&"object"==typeof T.content&&"parts"in T.content?T.content.parts:[],C=d({parts:E,generateId:this.config.generateId}),A=w.usageMetadata;return{text:h(E),reasoning:f(E),files:null==(t=m(E))?void 0:t.map(e=>({data:e.inlineData.data,mimeType:e.inlineData.mimeType})),toolCalls:C,finishReason:c({finishReason:T.finishReason,hasToolCalls:null!=C&&C.length>0}),usage:{promptTokens:null!=(n=null==A?void 0:A.promptTokenCount)?n:NaN,completionTokens:null!=(o=null==A?void 0:A.candidatesTokenCount)?o:NaN},rawCall:{rawPrompt:_,rawSettings:S},rawResponse:{headers:b,body:k},warnings:p,providerMetadata:{google:{groundingMetadata:null!=(i=T.groundingMetadata)?i:null,safetyRatings:null!=(s=T.safetyRatings)?s:null}},sources:g({groundingMetadata:T.groundingMetadata,generateId:this.config.generateId}),request:{body:y}}}async doStream(e){let t;let{args:n,warnings:o}=await this.getArgs(e),i=JSON.stringify(n),s=(0,r.NF)(await (0,r.DB)(this.config.headers),e.headers),{responseHeaders:l,value:p}=await (0,r.A8)({url:`${this.config.baseURL}/${a(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:n,failedResponseHandler:u,successfulResponseHandler:(0,r.cP)(k),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:y,...v}=n,b="unknown",w={promptTokens:Number.NaN,completionTokens:Number.NaN},x=this.config.generateId,_=!1;return{stream:p.pipeThrough(new TransformStream({transform(e,n){var r,o,i,s,a,l;if(!e.success){n.enqueue({type:"error",error:e.error});return}let u=e.value,p=u.usageMetadata;null!=p&&(w={promptTokens:null!=(r=p.promptTokenCount)?r:NaN,completionTokens:null!=(o=p.candidatesTokenCount)?o:NaN});let y=null==(i=u.candidates)?void 0:i[0];if(null==y)return;let v=y.content;if(null!=v){let e=h(v.parts);null!=e&&n.enqueue({type:"text-delta",textDelta:e});let t=f(v.parts);if(null!=t)for(let e of t)n.enqueue({type:"reasoning",textDelta:e.text});let r=m(v.parts);if(null!=r)for(let e of r)n.enqueue({type:"file",mimeType:e.inlineData.mimeType,data:e.inlineData.data});let o=d({parts:v.parts,generateId:x});if(null!=o)for(let e of o)n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:e.args}),n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,args:e.args}),_=!0}if(null!=y.finishReason){for(let e of(b=c({finishReason:y.finishReason,hasToolCalls:_}),null!=(s=g({groundingMetadata:y.groundingMetadata,generateId:x}))?s:[]))n.enqueue({type:"source",source:e});t={google:{groundingMetadata:null!=(a=y.groundingMetadata)?a:null,safetyRatings:null!=(l=y.safetyRatings)?l:null}}}},flush(e){e.enqueue({type:"finish",finishReason:b,usage:w,providerMetadata:t})}})),rawCall:{rawPrompt:y,rawSettings:v},rawResponse:{headers:l},warnings:o,request:{body:i}}}};function d({parts:e,generateId:t}){let n=null==e?void 0:e.filter(e=>"functionCall"in e);return null==n||0===n.length?void 0:n.map(e=>({toolCallType:"function",toolCallId:t(),toolName:e.functionCall.name,args:JSON.stringify(e.functionCall.args)}))}function h(e){let t=null==e?void 0:e.filter(e=>"text"in e&&!0!==e.thought);return null==t||0===t.length?void 0:t.map(e=>e.text).join("")}function f(e){let t=null==e?void 0:e.filter(e=>"text"in e&&!0===e.thought&&null!=e.text);return null==t||0===t.length?void 0:t.map(e=>({type:"text",text:e.text}))}function m(e){return null==e?void 0:e.filter(e=>"inlineData"in e)}function g({groundingMetadata:e,generateId:t}){var n;return null==(n=null==e?void 0:e.groundingChunks)?void 0:n.filter(e=>null!=e.web).map(e=>({sourceType:"url",id:t(),url:e.web.uri,title:e.web.title}))}var y=o.z.object({parts:o.z.array(o.z.union([o.z.object({functionCall:o.z.object({name:o.z.string(),args:o.z.unknown()})}),o.z.object({inlineData:o.z.object({mimeType:o.z.string(),data:o.z.string()})}),o.z.object({text:o.z.string().nullish(),thought:o.z.boolean().nullish()})])).nullish()}),v=o.z.object({web:o.z.object({uri:o.z.string(),title:o.z.string()}).nullish(),retrievedContext:o.z.object({uri:o.z.string(),title:o.z.string()}).nullish()}),b=o.z.object({webSearchQueries:o.z.array(o.z.string()).nullish(),retrievalQueries:o.z.array(o.z.string()).nullish(),searchEntryPoint:o.z.object({renderedContent:o.z.string()}).nullish(),groundingChunks:o.z.array(v).nullish(),groundingSupports:o.z.array(o.z.object({segment:o.z.object({startIndex:o.z.number().nullish(),endIndex:o.z.number().nullish(),text:o.z.string().nullish()}),segment_text:o.z.string().nullish(),groundingChunkIndices:o.z.array(o.z.number()).nullish(),supportChunkIndices:o.z.array(o.z.number()).nullish(),confidenceScores:o.z.array(o.z.number()).nullish(),confidenceScore:o.z.array(o.z.number()).nullish()})).nullish(),retrievalMetadata:o.z.union([o.z.object({webDynamicRetrievalScore:o.z.number()}),o.z.object({})]).nullish()}),w=o.z.object({category:o.z.string().nullish(),probability:o.z.string().nullish(),probabilityScore:o.z.number().nullish(),severity:o.z.string().nullish(),severityScore:o.z.number().nullish(),blocked:o.z.boolean().nullish()}),x=o.z.object({candidates:o.z.array(o.z.object({content:y.nullish().or(o.z.object({}).strict()),finishReason:o.z.string().nullish(),safetyRatings:o.z.array(w).nullish(),groundingMetadata:b.nullish()})),usageMetadata:o.z.object({promptTokenCount:o.z.number().nullish(),candidatesTokenCount:o.z.number().nullish(),totalTokenCount:o.z.number().nullish()}).nullish()}),k=o.z.object({candidates:o.z.array(o.z.object({content:y.nullish(),finishReason:o.z.string().nullish(),safetyRatings:o.z.array(w).nullish(),groundingMetadata:b.nullish()})).nullish(),usageMetadata:o.z.object({promptTokenCount:o.z.number().nullish(),candidatesTokenCount:o.z.number().nullish(),totalTokenCount:o.z.number().nullish()}).nullish()}),_=o.z.object({responseModalities:o.z.array(o.z.enum(["TEXT","IMAGE"])).nullish(),thinkingConfig:o.z.object({thinkingBudget:o.z.number().nullish(),includeThoughts:o.z.boolean().nullish()}).nullish()}),S=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new i.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let o=(0,r.NF)(await (0,r.DB)(this.config.headers),t),{responseHeaders:s,value:a}=await (0,r.A8)({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:o,body:{requests:e.map(e=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:e}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(T),abortSignal:n,fetch:this.config.fetch});return{embeddings:a.embeddings.map(e=>e.values),usage:void 0,rawResponse:{headers:s}}}},T=o.z.object({embeddings:o.z.array(o.z.object({values:o.z.array(o.z.number())}))});function E(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function C(e={}){var t;let n=null!=(t=(0,r.QT)(e.baseURL))?t:"https://generativelanguage.googleapis.com/v1beta",o=()=>({"x-goog-api-key":(0,r.pd)({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),i=(t,i={})=>{var s;return new p(t,i,{provider:"google.generative-ai",baseURL:n,headers:o,generateId:null!=(s=e.generateId)?s:r.Ox,isSupportedUrl:E,fetch:e.fetch})},s=(t,r={})=>new S(t,r,{provider:"google.generative-ai",baseURL:n,headers:o,fetch:e.fetch}),a=function(e,t){if(new.target)throw Error("The Google Generative AI model function cannot be called with the new keyword.");return i(e,t)};return a.languageModel=i,a.chat=i,a.generativeAI=i,a.embedding=s,a.textEmbedding=s,a.textEmbeddingModel=s,a}C()},62925:function(e,t,n){"use strict";n.d(t,{J:function(){return Y}});var r=n(989),o=n(5045),i=n(1604);function s(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.content)?void 0:t.map(({token:e,logprob:t,top_logprobs:n})=>({token:e,logprob:t,topLogprobs:n?n.map(({token:e,logprob:t})=>({token:e,logprob:t})):[]})))?n:void 0}function a(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var l=i.z.object({error:i.z.object({message:i.z.string(),type:i.z.string().nullish(),param:i.z.any().nullish(),code:i.z.union([i.z.string(),i.z.number()]).nullish()})}),u=(0,r.Sq)({errorSchema:l,errorToMessage:e=>e.error.message});function c({id:e,model:t,created:n}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=n?new Date(1e3*n):void 0}}var p=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return null!=(e=this.settings.structuredOutputs)?e:m(this.modelId)}get defaultObjectGenerationMode(){return this.modelId.startsWith("gpt-4o-audio-preview")?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:i,topP:s,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:p,seed:d,providerMetadata:h}){var f,y,v,b,w,x,k,_,S,T,E;let C=e.type,A=[];null!=a&&A.push({type:"unsupported-setting",setting:"topK"}),(null==p?void 0:p.type)!=="json"||null==p.schema||this.supportsStructuredOutputs||A.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let O=this.settings.useLegacyFunctionCalling;if(O&&!0===this.settings.parallelToolCalls)throw new o.A_({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(O&&this.supportsStructuredOutputs)throw new o.A_({functionality:"structuredOutputs with useLegacyFunctionCalling"});let{messages:N,warnings:M}=function({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){let i=[],s=[];for(let{role:a,content:l}of e)switch(a){case"system":switch(n){case"system":i.push({role:"system",content:l});break;case"developer":i.push({role:"developer",content:l});break;case"remove":s.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${n}`)}break;case"user":if(1===l.length&&"text"===l[0].type){i.push({role:"user",content:l[0].text});break}i.push({role:"user",content:l.map((e,t)=>{var n,i,s,a;switch(e.type){case"text":return{type:"text",text:e.text};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(n=e.mimeType)?n:"image/jpeg"};base64,${(0,r.k0)(e.image)}`,detail:null==(s=null==(i=e.providerMetadata)?void 0:i.openai)?void 0:s.imageDetail}};case"file":if(e.data instanceof URL)throw new o.A_({functionality:"'File content parts with URL data' functionality not supported."});switch(e.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:e.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:e.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:null!=(a=e.filename)?a:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${e.data}`}};default:throw new o.A_({functionality:`File content part type ${e.mimeType} in user messages`})}}})});break;case"assistant":{let e="",n=[];for(let t of l)switch(t.type){case"text":e+=t.text;break;case"tool-call":n.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}})}if(t){if(n.length>1)throw new o.A_({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});i.push({role:"assistant",content:e,function_call:n.length>0?n[0].function:void 0})}else i.push({role:"assistant",content:e,tool_calls:n.length>0?n:void 0});break}case"tool":for(let e of l)t?i.push({role:"function",name:e.toolName,content:JSON.stringify(e.result)}):i.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${a}`)}return{messages:i,warnings:s}}({prompt:t,useLegacyFunctionCalling:O,systemMessageMode:m(S=this.modelId)?null!=(E=null==(T=g[S])?void 0:T.systemMessageMode)?E:"developer":"system"});A.push(...M);let I={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:!0===this.settings.logprobs||"number"==typeof this.settings.logprobs||void 0,top_logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:i,top_p:s,frequency_penalty:l,presence_penalty:u,response_format:(null==p?void 0:p.type)==="json"?this.supportsStructuredOutputs&&null!=p.schema?{type:"json_schema",json_schema:{schema:p.schema,strict:!0,name:null!=(f=p.name)?f:"response",description:p.description}}:{type:"json_object"}:void 0,stop:c,seed:d,max_completion_tokens:null==(y=null==h?void 0:h.openai)?void 0:y.maxCompletionTokens,store:null==(v=null==h?void 0:h.openai)?void 0:v.store,metadata:null==(b=null==h?void 0:h.openai)?void 0:b.metadata,prediction:null==(w=null==h?void 0:h.openai)?void 0:w.prediction,reasoning_effort:null!=(k=null==(x=null==h?void 0:h.openai)?void 0:x.reasoningEffort)?k:this.settings.reasoningEffort,messages:N};switch(m(this.modelId)?(null!=I.temperature&&(I.temperature=void 0,A.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=I.top_p&&(I.top_p=void 0,A.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),null!=I.frequency_penalty&&(I.frequency_penalty=void 0,A.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=I.presence_penalty&&(I.presence_penalty=void 0,A.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=I.logit_bias&&(I.logit_bias=void 0,A.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=I.logprobs&&(I.logprobs=void 0,A.push({type:"other",message:"logprobs is not supported for reasoning models"})),null!=I.top_logprobs&&(I.top_logprobs=void 0,A.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=I.max_tokens&&(null==I.max_completion_tokens&&(I.max_completion_tokens=I.max_tokens),I.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&null!=I.temperature&&(I.temperature=void 0,A.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),C){case"regular":{let{tools:t,tool_choice:n,functions:r,function_call:i,toolWarnings:s}=function({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;let i=(null==(r=e.tools)?void 0:r.length)?e.tools:void 0,s=[];if(null==i)return{tools:void 0,tool_choice:void 0,toolWarnings:s};let a=e.toolChoice;if(t){let e=[];for(let t of i)"provider-defined"===t.type?s.push({type:"unsupported-tool",tool:t}):e.push({name:t.name,description:t.description,parameters:t.parameters});if(null==a)return{functions:e,function_call:void 0,toolWarnings:s};switch(a.type){case"auto":case"none":case void 0:return{functions:e,function_call:void 0,toolWarnings:s};case"required":throw new o.A_({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:e,function_call:{name:a.toolName},toolWarnings:s}}}let l=[];for(let e of i)"provider-defined"===e.type?s.push({type:"unsupported-tool",tool:e}):l.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters,strict:!!n||void 0}});if(null==a)return{tools:l,tool_choice:void 0,toolWarnings:s};let u=a.type;switch(u){case"auto":case"none":case"required":return{tools:l,tool_choice:u,toolWarnings:s};case"tool":return{tools:l,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:s};default:throw new o.A_({functionality:`Unsupported tool choice type: ${u}`})}}({mode:e,useLegacyFunctionCalling:O,structuredOutputs:this.supportsStructuredOutputs});return{args:{...I,tools:t,tool_choice:n,functions:r,function_call:i},warnings:[...A,...s]}}case"object-json":return{args:{...I,response_format:this.supportsStructuredOutputs&&null!=e.schema?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:null!=(_=e.name)?_:"response",description:e.description}}:{type:"json_object"}},warnings:A};case"object-tool":return{args:O?{...I,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...I,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:!!this.supportsStructuredOutputs||void 0}}]},warnings:A};default:throw Error(`Unsupported type: ${C}`)}}async doGenerate(e){var t,n,o,i,l,p,d,f;let{args:m,warnings:g}=this.getArgs(e),{responseHeaders:y,value:v,rawValue:b}=await (0,r.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),body:m,failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(h),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...x}=m,k=v.choices[0],_=null==(t=v.usage)?void 0:t.completion_tokens_details,S=null==(n=v.usage)?void 0:n.prompt_tokens_details,T={openai:{}};return(null==_?void 0:_.reasoning_tokens)!=null&&(T.openai.reasoningTokens=null==_?void 0:_.reasoning_tokens),(null==_?void 0:_.accepted_prediction_tokens)!=null&&(T.openai.acceptedPredictionTokens=null==_?void 0:_.accepted_prediction_tokens),(null==_?void 0:_.rejected_prediction_tokens)!=null&&(T.openai.rejectedPredictionTokens=null==_?void 0:_.rejected_prediction_tokens),(null==S?void 0:S.cached_tokens)!=null&&(T.openai.cachedPromptTokens=null==S?void 0:S.cached_tokens),{text:null!=(o=k.message.content)?o:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&k.message.function_call?[{toolCallType:"function",toolCallId:(0,r.Ox)(),toolName:k.message.function_call.name,args:k.message.function_call.arguments}]:null==(i=k.message.tool_calls)?void 0:i.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:(0,r.Ox)(),toolName:e.function.name,args:e.function.arguments}}),finishReason:a(k.finish_reason),usage:{promptTokens:null!=(p=null==(l=v.usage)?void 0:l.prompt_tokens)?p:NaN,completionTokens:null!=(f=null==(d=v.usage)?void 0:d.completion_tokens)?f:NaN},rawCall:{rawPrompt:w,rawSettings:x},rawResponse:{headers:y,body:b},request:{body:JSON.stringify(m)},response:c(v),warnings:g,logprobs:s(k.logprobs),providerMetadata:T}}async doStream(e){let t;if(this.settings.simulateStreaming){let t=await this.doGenerate(e);return{stream:new ReadableStream({start(e){if(e.enqueue({type:"response-metadata",...t.response}),t.text&&e.enqueue({type:"text-delta",textDelta:t.text}),t.toolCalls)for(let n of t.toolCalls)e.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:n.toolCallId,toolName:n.toolName,argsTextDelta:n.args}),e.enqueue({type:"tool-call",...n});e.enqueue({type:"finish",finishReason:t.finishReason,usage:t.usage,logprobs:t.logprobs,providerMetadata:t.providerMetadata}),e.close()}}),rawCall:t.rawCall,rawResponse:t.rawResponse,warnings:t.warnings}}let{args:n,warnings:i}=this.getArgs(e),l={...n,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:p,value:d}=await (0,r.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),body:l,failedResponseHandler:u,successfulResponseHandler:(0,r.cP)(f),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:h,...m}=n,g=[],y="unknown",v={promptTokens:void 0,completionTokens:void 0},b=!0,{useLegacyFunctionCalling:w}=this.settings,x={openai:{}};return{stream:d.pipeThrough(new TransformStream({transform(e,n){var i,l,u,p,d,h,f,m,k,_,S,T;if(!e.success){y="error",n.enqueue({type:"error",error:e.error});return}let E=e.value;if("error"in E){y="error",n.enqueue({type:"error",error:E.error});return}if(b&&(b=!1,n.enqueue({type:"response-metadata",...c(E)})),null!=E.usage){let{prompt_tokens:e,completion_tokens:t,prompt_tokens_details:n,completion_tokens_details:r}=E.usage;v={promptTokens:null!=e?e:void 0,completionTokens:null!=t?t:void 0},(null==r?void 0:r.reasoning_tokens)!=null&&(x.openai.reasoningTokens=null==r?void 0:r.reasoning_tokens),(null==r?void 0:r.accepted_prediction_tokens)!=null&&(x.openai.acceptedPredictionTokens=null==r?void 0:r.accepted_prediction_tokens),(null==r?void 0:r.rejected_prediction_tokens)!=null&&(x.openai.rejectedPredictionTokens=null==r?void 0:r.rejected_prediction_tokens),(null==n?void 0:n.cached_tokens)!=null&&(x.openai.cachedPromptTokens=null==n?void 0:n.cached_tokens)}let C=E.choices[0];if((null==C?void 0:C.finish_reason)!=null&&(y=a(C.finish_reason)),(null==C?void 0:C.delta)==null)return;let A=C.delta;null!=A.content&&n.enqueue({type:"text-delta",textDelta:A.content});let O=s(null==C?void 0:C.logprobs);(null==O?void 0:O.length)&&(void 0===t&&(t=[]),t.push(...O));let N=w&&null!=A.function_call?[{type:"function",id:(0,r.Ox)(),function:A.function_call,index:0}]:A.tool_calls;if(null!=N)for(let e of N){let t=e.index;if(null==g[t]){if("function"!==e.type)throw new o.Rt({data:e,message:"Expected 'function' type."});if(null==e.id)throw new o.Rt({data:e,message:"Expected 'id' to be a string."});if((null==(i=e.function)?void 0:i.name)==null)throw new o.Rt({data:e,message:"Expected 'function.name' to be a string."});g[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(l=e.function.arguments)?l:""},hasFinished:!1};let s=g[t];(null==(u=s.function)?void 0:u.name)!=null&&(null==(p=s.function)?void 0:p.arguments)!=null&&(s.function.arguments.length>0&&n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:s.id,toolName:s.function.name,argsTextDelta:s.function.arguments}),(0,r.Gr)(s.function.arguments)&&(n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(d=s.id)?d:(0,r.Ox)(),toolName:s.function.name,args:s.function.arguments}),s.hasFinished=!0));continue}let s=g[t];!s.hasFinished&&((null==(h=e.function)?void 0:h.arguments)!=null&&(s.function.arguments+=null!=(m=null==(f=e.function)?void 0:f.arguments)?m:""),n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:s.id,toolName:s.function.name,argsTextDelta:null!=(k=e.function.arguments)?k:""}),(null==(_=s.function)?void 0:_.name)!=null&&(null==(S=s.function)?void 0:S.arguments)!=null&&(0,r.Gr)(s.function.arguments)&&(n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(T=s.id)?T:(0,r.Ox)(),toolName:s.function.name,args:s.function.arguments}),s.hasFinished=!0))}},flush(e){var n,r;e.enqueue({type:"finish",finishReason:y,logprobs:t,usage:{promptTokens:null!=(n=v.promptTokens)?n:NaN,completionTokens:null!=(r=v.completionTokens)?r:NaN},...null!=x?{providerMetadata:x}:{}})}})),rawCall:{rawPrompt:h,rawSettings:m},rawResponse:{headers:p},request:{body:JSON.stringify(l)},warnings:i}}},d=i.z.object({prompt_tokens:i.z.number().nullish(),completion_tokens:i.z.number().nullish(),prompt_tokens_details:i.z.object({cached_tokens:i.z.number().nullish()}).nullish(),completion_tokens_details:i.z.object({reasoning_tokens:i.z.number().nullish(),accepted_prediction_tokens:i.z.number().nullish(),rejected_prediction_tokens:i.z.number().nullish()}).nullish()}).nullish(),h=i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({message:i.z.object({role:i.z.literal("assistant").nullish(),content:i.z.string().nullish(),function_call:i.z.object({arguments:i.z.string(),name:i.z.string()}).nullish(),tool_calls:i.z.array(i.z.object({id:i.z.string().nullish(),type:i.z.literal("function"),function:i.z.object({name:i.z.string(),arguments:i.z.string()})})).nullish()}),index:i.z.number(),logprobs:i.z.object({content:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number(),top_logprobs:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number()}))})).nullable()}).nullish(),finish_reason:i.z.string().nullish()})),usage:d}),f=i.z.union([i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({delta:i.z.object({role:i.z.enum(["assistant"]).nullish(),content:i.z.string().nullish(),function_call:i.z.object({name:i.z.string().optional(),arguments:i.z.string().optional()}).nullish(),tool_calls:i.z.array(i.z.object({index:i.z.number(),id:i.z.string().nullish(),type:i.z.literal("function").nullish(),function:i.z.object({name:i.z.string().nullish(),arguments:i.z.string().nullish()})})).nullish()}).nullish(),logprobs:i.z.object({content:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number(),top_logprobs:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number()}))})).nullable()}).nullish(),finish_reason:i.z.string().nullish(),index:i.z.number()})),usage:d}),l]);function m(e){return e.startsWith("o")}var g={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function y(e){return null==e?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([e,t])=>({token:e,logprob:t})):[]}))}var v=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:i,topP:s,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:p,seed:d}){var h;let f=e.type,m=[];null!=a&&m.push({type:"unsupported-setting",setting:"topK"}),null!=p&&"text"!==p.type&&m.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:g,stopSequences:y}=function({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if("prompt"===t&&1===e.length&&"user"===e[0].role&&1===e[0].content.length&&"text"===e[0].content[0].type)return{prompt:e[0].content[0].text};let i="";for(let{role:t,content:s}of("system"===e[0].role&&(i+=`${e[0].content}

`,e=e.slice(1)),e))switch(t){case"system":throw new o.Mt({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=s.map(e=>{switch(e.type){case"text":return e.text;case"image":throw new o.A_({functionality:"images"})}}).join("");i+=`${n}:
${e}

`;break}case"assistant":{let e=s.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new o.A_({functionality:"tool-call messages"})}}).join("");i+=`${r}:
${e}

`;break}case"tool":throw new o.A_({functionality:"tool messages"});default:throw Error(`Unsupported role: ${t}`)}return{prompt:i+=`${r}:
`,stopSequences:[`
${n}:`]}}({prompt:n,inputFormat:t}),v=[...null!=y?y:[],...null!=c?c:[]],b={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:i,top_p:s,frequency_penalty:l,presence_penalty:u,seed:d,prompt:g,stop:v.length>0?v:void 0};switch(f){case"regular":if(null==(h=e.tools)?void 0:h.length)throw new o.A_({functionality:"tools"});if(e.toolChoice)throw new o.A_({functionality:"toolChoice"});return{args:b,warnings:m};case"object-json":throw new o.A_({functionality:"object-json mode"});case"object-tool":throw new o.A_({functionality:"object-tool mode"});default:throw Error(`Unsupported type: ${f}`)}}async doGenerate(e){let{args:t,warnings:n}=this.getArgs(e),{responseHeaders:o,value:i,rawValue:s}=await (0,r.A8)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),body:t,failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(b),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:l,...p}=t,d=i.choices[0];return{text:d.text,usage:{promptTokens:i.usage.prompt_tokens,completionTokens:i.usage.completion_tokens},finishReason:a(d.finish_reason),logprobs:y(d.logprobs),rawCall:{rawPrompt:l,rawSettings:p},rawResponse:{headers:o,body:s},response:c(i),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){let t;let{args:n,warnings:o}=this.getArgs(e),i={...n,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:s,value:l}=await (0,r.A8)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),body:i,failedResponseHandler:u,successfulResponseHandler:(0,r.cP)(w),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:p,...d}=n,h="unknown",f={promptTokens:Number.NaN,completionTokens:Number.NaN},m=!0;return{stream:l.pipeThrough(new TransformStream({transform(e,n){if(!e.success){h="error",n.enqueue({type:"error",error:e.error});return}let r=e.value;if("error"in r){h="error",n.enqueue({type:"error",error:r.error});return}m&&(m=!1,n.enqueue({type:"response-metadata",...c(r)})),null!=r.usage&&(f={promptTokens:r.usage.prompt_tokens,completionTokens:r.usage.completion_tokens});let o=r.choices[0];(null==o?void 0:o.finish_reason)!=null&&(h=a(o.finish_reason)),(null==o?void 0:o.text)!=null&&n.enqueue({type:"text-delta",textDelta:o.text});let i=y(null==o?void 0:o.logprobs);(null==i?void 0:i.length)&&(void 0===t&&(t=[]),t.push(...i))},flush(e){e.enqueue({type:"finish",finishReason:h,logprobs:t,usage:f})}})),rawCall:{rawPrompt:p,rawSettings:d},rawResponse:{headers:s},warnings:o,request:{body:JSON.stringify(i)}}}},b=i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({text:i.z.string(),finish_reason:i.z.string(),logprobs:i.z.object({tokens:i.z.array(i.z.string()),token_logprobs:i.z.array(i.z.number()),top_logprobs:i.z.array(i.z.record(i.z.string(),i.z.number())).nullable()}).nullish()})),usage:i.z.object({prompt_tokens:i.z.number(),completion_tokens:i.z.number()})}),w=i.z.union([i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({text:i.z.string(),finish_reason:i.z.string().nullish(),index:i.z.number(),logprobs:i.z.object({tokens:i.z.array(i.z.string()),token_logprobs:i.z.array(i.z.number()),top_logprobs:i.z.array(i.z.record(i.z.string(),i.z.number())).nullable()}).nullish()})),usage:i.z.object({prompt_tokens:i.z.number(),completion_tokens:i.z.number()}).nullish()}),l]),x=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.settings.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){var e;return null==(e=this.settings.supportsParallelCalls)||e}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new o.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:i,value:s}=await (0,r.A8)({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(k),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(e=>e.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:i}}}},k=i.z.object({data:i.z.array(i.z.object({embedding:i.z.array(i.z.number())})),usage:i.z.object({prompt_tokens:i.z.number()}).nullish()}),_={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},S=new Set(["gpt-image-1"]),T=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return null!=(t=null!=(e=this.settings.maxImagesPerCall)?e:_[this.modelId])?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:o,seed:i,providerOptions:s,headers:a,abortSignal:l}){var c,p,d,h;let f=[];null!=o&&f.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=i&&f.push({type:"unsupported-setting",setting:"seed"});let m=null!=(d=null==(p=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:p.call(c))?d:new Date,{value:g,responseHeaders:y}=await (0,r.A8)({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...null!=(h=s.openai)?h:{},...S.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(E),abortSignal:l,fetch:this.config.fetch});return{images:g.data.map(e=>e.b64_json),warnings:f,response:{timestamp:m,modelId:this.modelId,headers:y}}}},E=i.z.object({data:i.z.array(i.z.object({b64_json:i.z.string()}))}),C=i.z.object({include:i.z.array(i.z.string()).nullish(),language:i.z.string().nullish(),prompt:i.z.string().nullish(),temperature:i.z.number().min(0).max(1).nullish().default(0),timestampGranularities:i.z.array(i.z.enum(["word","segment"])).nullish().default(["segment"])}),A={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},O=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var o,i,s,a,l;let u=(0,r.c1)({provider:"openai",providerOptions:n,schema:C}),c=new FormData,p=new Blob(e instanceof Uint8Array?[e]:[(0,r.MS)(e)]);if(c.append("model",this.modelId),c.append("file",new File([p],"audio",{type:t})),u){let e={include:null!=(o=u.include)?o:void 0,language:null!=(i=u.language)?i:void 0,prompt:null!=(s=u.prompt)?s:void 0,temperature:null!=(a=u.temperature)?a:void 0,timestamp_granularities:null!=(l=u.timestampGranularities)?l:void 0};for(let t in e){let n=e[t];void 0!==n&&c.append(t,String(n))}}return{formData:c,warnings:[]}}async doGenerate(e){var t,n,o,i,s,a;let l=null!=(o=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?o:new Date,{formData:c,warnings:p}=this.getArgs(e),{value:d,responseHeaders:h,rawValue:f}=await (0,r.do)({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),formData:c,failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(N),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=null!=d.language&&d.language in A?A[d.language]:void 0;return{text:d.text,segments:null!=(s=null==(i=d.words)?void 0:i.map(e=>({text:e.word,startSecond:e.start,endSecond:e.end})))?s:[],language:m,durationInSeconds:null!=(a=d.duration)?a:void 0,warnings:p,response:{timestamp:l,modelId:this.modelId,headers:h,body:f}}}},N=i.z.object({text:i.z.string(),language:i.z.string().nullish(),duration:i.z.number().nullish(),words:i.z.array(i.z.object({word:i.z.string(),start:i.z.number(),end:i.z.number()})).nullish()});function M({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}var I=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:i,topP:s,topK:a,presencePenalty:l,frequencyPenalty:u,seed:c,prompt:p,providerMetadata:d,responseFormat:h}){var f,m,g,y;let v=[],b=(y=this.modelId).startsWith("o")?y.startsWith("o1-mini")||y.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1},w=e.type;null!=a&&v.push({type:"unsupported-setting",setting:"topK"}),null!=c&&v.push({type:"unsupported-setting",setting:"seed"}),null!=l&&v.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=u&&v.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=i&&v.push({type:"unsupported-setting",setting:"stopSequences"});let{messages:x,warnings:k}=function({prompt:e,systemMessageMode:t}){let n=[],i=[];for(let{role:s,content:a}of e)switch(s){case"system":switch(t){case"system":n.push({role:"system",content:a});break;case"developer":n.push({role:"developer",content:a});break;case"remove":i.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${t}`)}break;case"user":n.push({role:"user",content:a.map((e,t)=>{var n,i,s,a;switch(e.type){case"text":return{type:"input_text",text:e.text};case"image":return{type:"input_image",image_url:e.image instanceof URL?e.image.toString():`data:${null!=(n=e.mimeType)?n:"image/jpeg"};base64,${(0,r.k0)(e.image)}`,detail:null==(s=null==(i=e.providerMetadata)?void 0:i.openai)?void 0:s.imageDetail};case"file":if(e.data instanceof URL)throw new o.A_({functionality:"File URLs in user messages"});if("application/pdf"===e.mimeType)return{type:"input_file",filename:null!=(a=e.filename)?a:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${e.data}`};throw new o.A_({functionality:"Only PDF files are supported in user messages"})}})});break;case"assistant":for(let e of a)switch(e.type){case"text":n.push({role:"assistant",content:[{type:"output_text",text:e.text}]});break;case"tool-call":n.push({type:"function_call",call_id:e.toolCallId,name:e.toolName,arguments:JSON.stringify(e.args)})}break;case"tool":for(let e of a)n.push({type:"function_call_output",call_id:e.toolCallId,output:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${s}`)}return{messages:n,warnings:i}}({prompt:p,systemMessageMode:b.systemMessageMode});v.push(...k);let _=(0,r.c1)({provider:"openai",providerOptions:d,schema:U}),S=null==(f=null==_?void 0:_.strictSchemas)||f,T={model:this.modelId,input:x,temperature:n,top_p:s,max_output_tokens:t,...(null==h?void 0:h.type)==="json"&&{text:{format:null!=h.schema?{type:"json_schema",strict:S,name:null!=(m=h.name)?m:"response",description:h.description,schema:h.schema}:{type:"json_object"}}},metadata:null==_?void 0:_.metadata,parallel_tool_calls:null==_?void 0:_.parallelToolCalls,previous_response_id:null==_?void 0:_.previousResponseId,store:null==_?void 0:_.store,user:null==_?void 0:_.user,instructions:null==_?void 0:_.instructions,...b.isReasoningModel&&((null==_?void 0:_.reasoningEffort)!=null||(null==_?void 0:_.reasoningSummary)!=null)&&{reasoning:{...(null==_?void 0:_.reasoningEffort)!=null&&{effort:_.reasoningEffort},...(null==_?void 0:_.reasoningSummary)!=null&&{summary:_.reasoningSummary}}},...b.requiredAutoTruncation&&{truncation:"auto"}};switch(b.isReasoningModel&&(null!=T.temperature&&(T.temperature=void 0,v.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=T.top_p&&(T.top_p=void 0,v.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),w){case"regular":{let{tools:t,tool_choice:n,toolWarnings:r}=function({mode:e,strict:t}){var n;let r=(null==(n=e.tools)?void 0:n.length)?e.tools:void 0,i=[];if(null==r)return{tools:void 0,tool_choice:void 0,toolWarnings:i};let s=e.toolChoice,a=[];for(let e of r)switch(e.type){case"function":a.push({type:"function",name:e.name,description:e.description,parameters:e.parameters,strict:!!t||void 0});break;case"provider-defined":"openai.web_search_preview"===e.id?a.push({type:"web_search_preview",search_context_size:e.args.searchContextSize,user_location:e.args.userLocation}):i.push({type:"unsupported-tool",tool:e});break;default:i.push({type:"unsupported-tool",tool:e})}if(null==s)return{tools:a,tool_choice:void 0,toolWarnings:i};let l=s.type;switch(l){case"auto":case"none":case"required":return{tools:a,tool_choice:l,toolWarnings:i};case"tool":if("web_search_preview"===s.toolName)return{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:i};return{tools:a,tool_choice:{type:"function",name:s.toolName},toolWarnings:i};default:throw new o.A_({functionality:`Unsupported tool choice type: ${l}`})}}({mode:e,strict:S});return{args:{...T,tools:t,tool_choice:n},warnings:[...v,...r]}}case"object-json":return{args:{...T,text:{format:null!=e.schema?{type:"json_schema",strict:S,name:null!=(g=e.name)?g:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:v};case"object-tool":return{args:{...T,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:S}]},warnings:v};default:throw Error(`Unsupported type: ${w}`)}}async doGenerate(e){var t,n,o,s,a,l,c;let{args:p,warnings:d}=this.getArgs(e),{responseHeaders:h,value:f,rawValue:m}=await (0,r.A8)({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),body:p,failedResponseHandler:u,successfulResponseHandler:(0,r.tc)(i.z.object({id:i.z.string(),created_at:i.z.number(),model:i.z.string(),output:i.z.array(i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("message"),role:i.z.literal("assistant"),content:i.z.array(i.z.object({type:i.z.literal("output_text"),text:i.z.string(),annotations:i.z.array(i.z.object({type:i.z.literal("url_citation"),start_index:i.z.number(),end_index:i.z.number(),url:i.z.string(),title:i.z.string()}))}))}),i.z.object({type:i.z.literal("function_call"),call_id:i.z.string(),name:i.z.string(),arguments:i.z.string()}),i.z.object({type:i.z.literal("web_search_call")}),i.z.object({type:i.z.literal("computer_call")}),i.z.object({type:i.z.literal("reasoning"),summary:i.z.array(i.z.object({type:i.z.literal("summary_text"),text:i.z.string()}))})])),incomplete_details:i.z.object({reason:i.z.string()}).nullable(),usage:R})),abortSignal:e.abortSignal,fetch:this.config.fetch}),g=f.output.filter(e=>"message"===e.type).flatMap(e=>e.content).filter(e=>"output_text"===e.type),y=f.output.filter(e=>"function_call"===e.type).map(e=>({toolCallType:"function",toolCallId:e.call_id,toolName:e.name,args:e.arguments})),v=null!=(n=null==(t=f.output.find(e=>"reasoning"===e.type))?void 0:t.summary)?n:null;return{text:g.map(e=>e.text).join("\n"),sources:g.flatMap(e=>e.annotations.map(e=>{var t,n,o;return{sourceType:"url",id:null!=(o=null==(n=(t=this.config).generateId)?void 0:n.call(t))?o:(0,r.Ox)(),url:e.url,title:e.title}})),finishReason:M({finishReason:null==(o=f.incomplete_details)?void 0:o.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:v?v.map(e=>({type:"text",text:e.text})):void 0,usage:{promptTokens:f.usage.input_tokens,completionTokens:f.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:h,body:m},request:{body:JSON.stringify(p)},response:{id:f.id,timestamp:new Date(1e3*f.created_at),modelId:f.model},providerMetadata:{openai:{responseId:f.id,cachedPromptTokens:null!=(a=null==(s=f.usage.input_tokens_details)?void 0:s.cached_tokens)?a:null,reasoningTokens:null!=(c=null==(l=f.usage.output_tokens_details)?void 0:l.reasoning_tokens)?c:null}},warnings:d}}async doStream(e){let{args:t,warnings:n}=this.getArgs(e),{responseHeaders:o,value:i}=await (0,r.A8)({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:u,successfulResponseHandler:(0,r.cP)(F),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=this,a="unknown",l=NaN,c=NaN,p=null,d=null,h=null,f={},m=!1;return{stream:i.pipeThrough(new TransformStream({transform(e,t){var n,o,i,u,g,y,v,b;if(!e.success){a="error",t.enqueue({type:"error",error:e.error});return}let w=e.value;if("response.output_item.added"===w.type)"function_call"===w.item.type&&(f[w.output_index]={toolName:w.item.name,toolCallId:w.item.call_id},t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.item.call_id,toolName:w.item.name,argsTextDelta:w.item.arguments}));else if("response.function_call_arguments.delta"===w.type){let e=f[w.output_index];null!=e&&t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:w.delta})}else"response.created"===w.type?(h=w.response.id,t.enqueue({type:"response-metadata",id:w.response.id,timestamp:new Date(1e3*w.response.created_at),modelId:w.response.model})):"response.output_text.delta"===w.type?t.enqueue({type:"text-delta",textDelta:w.delta}):"response.reasoning_summary_text.delta"===w.type?t.enqueue({type:"reasoning",textDelta:w.delta}):"response.output_item.done"===w.type&&"function_call"===w.item.type?(f[w.output_index]=void 0,m=!0,t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:w.item.call_id,toolName:w.item.name,args:w.item.arguments})):"response.completed"===w.type||"response.incomplete"===w.type?(a=M({finishReason:null==(n=w.response.incomplete_details)?void 0:n.reason,hasToolCalls:m}),l=w.response.usage.input_tokens,c=w.response.usage.output_tokens,p=null!=(i=null==(o=w.response.usage.input_tokens_details)?void 0:o.cached_tokens)?i:p,d=null!=(g=null==(u=w.response.usage.output_tokens_details)?void 0:u.reasoning_tokens)?g:d):"response.output_text.annotation.added"===w.type&&t.enqueue({type:"source",source:{sourceType:"url",id:null!=(b=null==(v=(y=s.config).generateId)?void 0:v.call(y))?b:(0,r.Ox)(),url:w.annotation.url,title:w.annotation.title}})},flush(e){e.enqueue({type:"finish",finishReason:a,usage:{promptTokens:l,completionTokens:c},...(null!=p||null!=d)&&{providerMetadata:{openai:{responseId:h,cachedPromptTokens:p,reasoningTokens:d}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:o},request:{body:JSON.stringify(t)},warnings:n}}},R=i.z.object({input_tokens:i.z.number(),input_tokens_details:i.z.object({cached_tokens:i.z.number().nullish()}).nullish(),output_tokens:i.z.number(),output_tokens_details:i.z.object({reasoning_tokens:i.z.number().nullish()}).nullish()}),z=i.z.object({type:i.z.literal("response.output_text.delta"),delta:i.z.string()}),P=i.z.object({type:i.z.enum(["response.completed","response.incomplete"]),response:i.z.object({incomplete_details:i.z.object({reason:i.z.string()}).nullish(),usage:R})}),L=i.z.object({type:i.z.literal("response.created"),response:i.z.object({id:i.z.string(),created_at:i.z.number(),model:i.z.string()})}),j=i.z.object({type:i.z.literal("response.output_item.done"),output_index:i.z.number(),item:i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("message")}),i.z.object({type:i.z.literal("function_call"),id:i.z.string(),call_id:i.z.string(),name:i.z.string(),arguments:i.z.string(),status:i.z.literal("completed")})])}),D=i.z.object({type:i.z.literal("response.function_call_arguments.delta"),item_id:i.z.string(),output_index:i.z.number(),delta:i.z.string()}),$=i.z.object({type:i.z.literal("response.output_item.added"),output_index:i.z.number(),item:i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("message")}),i.z.object({type:i.z.literal("function_call"),id:i.z.string(),call_id:i.z.string(),name:i.z.string(),arguments:i.z.string()})])}),H=i.z.object({type:i.z.literal("response.output_text.annotation.added"),annotation:i.z.object({type:i.z.literal("url_citation"),url:i.z.string(),title:i.z.string()})}),B=i.z.object({type:i.z.literal("response.reasoning_summary_text.delta"),item_id:i.z.string(),output_index:i.z.number(),summary_index:i.z.number(),delta:i.z.string()}),F=i.z.union([z,P,L,j,D,$,H,B,i.z.object({type:i.z.string()}).passthrough()]),U=i.z.object({metadata:i.z.any().nullish(),parallelToolCalls:i.z.boolean().nullish(),previousResponseId:i.z.string().nullish(),store:i.z.boolean().nullish(),user:i.z.string().nullish(),reasoningEffort:i.z.string().nullish(),strictSchemas:i.z.boolean().nullish(),instructions:i.z.string().nullish(),reasoningSummary:i.z.string().nullish()}),V=i.z.object({}),W={webSearchPreview:function({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:V}}},q=i.z.object({instructions:i.z.string().nullish(),speed:i.z.number().min(.25).max(4).default(1).nullish()}),J=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:o,instructions:i,providerOptions:s}){let a=[],l=(0,r.c1)({provider:"openai",providerOptions:s,schema:q}),u={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:o,instructions:i};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?u.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),l){let e={};for(let t in e){let n=e[t];void 0!==n&&(u[t]=n)}}return{requestBody:u,warnings:a}}async doGenerate(e){var t,n,o;let i=null!=(o=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?o:new Date,{requestBody:s,warnings:a}=this.getArgs(e),{value:l,responseHeaders:c,rawValue:p}=await (0,r.A8)({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:(0,r.NF)(this.config.headers(),e.headers),body:s,failedResponseHandler:u,successfulResponseHandler:(0,r.XH)(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:l,warnings:a,request:{body:JSON.stringify(s)},response:{timestamp:i,modelId:this.modelId,headers:c,body:p}}}};function Y(e={}){var t,n,o;let i=null!=(t=(0,r.QT)(e.baseURL))?t:"https://api.openai.com/v1",s=null!=(n=e.compatibility)?n:"compatible",a=null!=(o=e.name)?o:"openai",l=()=>({Authorization:`Bearer ${(0,r.pd)({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),u=(t,n={})=>new p(t,n,{provider:`${a}.chat`,url:({path:e})=>`${i}${e}`,headers:l,compatibility:s,fetch:e.fetch}),c=(t,n={})=>new v(t,n,{provider:`${a}.completion`,url:({path:e})=>`${i}${e}`,headers:l,compatibility:s,fetch:e.fetch}),d=(t,n={})=>new x(t,n,{provider:`${a}.embedding`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),h=(t,n={})=>new T(t,n,{provider:`${a}.image`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),f=t=>new O(t,{provider:`${a}.transcription`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),m=t=>new J(t,{provider:`${a}.speech`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),g=(e,t)=>{if(new.target)throw Error("The OpenAI model function cannot be called with the new keyword.");return"gpt-3.5-turbo-instruct"===e?c(e,t):u(e,t)},y=function(e,t){return g(e,t)};return y.languageModel=g,y.chat=u,y.completion=c,y.responses=t=>new I(t,{provider:`${a}.responses`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),y.embedding=d,y.textEmbedding=d,y.textEmbeddingModel=d,y.image=h,y.imageModel=h,y.transcription=f,y.transcriptionModel=f,y.speech=m,y.speechModel=m,y.tools=W,y}Y({compatibility:"strict"})},989:function(e,t,n){"use strict";n.d(t,{NF:function(){return a},RV:function(){return l},MS:function(){return I},k0:function(){return R},XH:function(){return O},cP:function(){return C},bF:function(){return p},Sq:function(){return E},tc:function(){return A},gw:function(){return u},Ox:function(){return d},e$:function(){return h},D_:function(){return f},Gr:function(){return b},pd:function(){return m},c1:function(){return w},do:function(){return _},A8:function(){return k},DB:function(){return T},NX:function(){return v},pW:function(){return y},pY:function(){return g},QT:function(){return z}});var r=n(5045);let o=(e,t=21)=>(n=t)=>{let r="",o=0|n;for(;o--;)r+=e[Math.random()*e.length|0];return r};var i=n(58833),s=n(83454);function a(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function l(e){return new ReadableStream({async pull(t){try{let{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(e){t.error(e)}},cancel(){}})}async function u(e){return null==e?Promise.resolve():new Promise(t=>setTimeout(t,e))}function c(e){let t={};return e.headers.forEach((e,n)=>{t[n]=e}),t}var p=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:i="-"}={})=>{let s=o(n,t);if(null==e)return s;if(n.includes(i))throw new r.RU({argument:"separator",message:`The separator "${i}" must not be part of the alphabet "${n}".`});return t=>`${e}${i}${s(t)}`},d=p();function h(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}function f(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}function m({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:o}){if("string"==typeof e)return e;if(null!=e)throw new r.tZ({message:`${o} API key must be a string.`});if(void 0===s)throw new r.tZ({message:`${o} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(null==(e=s.env[t]))throw new r.tZ({message:`${o} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new r.tZ({message:`${o} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var g=Symbol.for("vercel.ai.validator");function y({value:e,schema:t}){let n="object"==typeof t&&null!==t&&g in t&&!0===t[g]&&"validate"in t?t:{[g]:!0,validate:e=>{let n=t.safeParse(e);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}};try{if(null==n.validate)return{success:!0,value:e};let t=n.validate(e);if(t.success)return t;return{success:!1,error:r.Gz.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:r.Gz.wrap({value:e,cause:t})}}}function v({text:e,schema:t}){try{let n=i.parse(e);if(null==t)return{success:!0,value:n,rawValue:n};let r=y({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(t){return{success:!1,error:r.xU.isInstance(t)?t:new r.xU({text:e,cause:t})}}}function b(e){try{return i.parse(e),!0}catch(e){return!1}}function w({provider:e,providerOptions:t,schema:n}){if((null==t?void 0:t[e])==null)return;let o=y({value:t[e],schema:n});if(!o.success)throw new r.RU({argument:"providerOptions",message:`invalid ${e} provider options`,cause:o.error});return o.value}var x=()=>globalThis.fetch,k=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:o,abortSignal:i,fetch:s})=>S({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:o,abortSignal:i,fetch:s}),_=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:o,abortSignal:i,fetch:s})=>S({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:o,abortSignal:i,fetch:s}),S=async({url:e,headers:t={},body:n,successfulResponseHandler:o,failedResponseHandler:i,abortSignal:s,fetch:a=x()})=>{try{let l=await a(e,{method:"POST",headers:Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t)),body:n.content,signal:s}),u=c(l);if(!l.ok){let t;try{t=await i({response:l,url:e,requestBodyValues:n.values})}catch(t){if(f(t)||r.w.isInstance(t))throw t;throw new r.w({message:"Failed to process error response",cause:t,statusCode:l.status,url:e,responseHeaders:u,requestBodyValues:n.values})}throw t.value}try{return await o({response:l,url:e,requestBodyValues:n.values})}catch(t){if(t instanceof Error&&(f(t)||r.w.isInstance(t)))throw t;throw new r.w({message:"Failed to process successful response",cause:t,statusCode:l.status,url:e,responseHeaders:u,requestBodyValues:n.values})}}catch(t){if(f(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let o=t.cause;if(null!=o)throw new r.w({message:`Cannot connect to API: ${o.message}`,cause:o,url:e,requestBodyValues:n.values,isRetryable:!0})}throw t}};async function T(e){return"function"==typeof e&&(e=e()),Promise.resolve(e)}var E=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:o,url:s,requestBodyValues:a})=>{let l=await o.text(),u=c(o);if(""===l.trim())return{responseHeaders:u,value:new r.w({message:o.statusText,url:s,requestBodyValues:a,statusCode:o.status,responseHeaders:u,responseBody:l,isRetryable:null==n?void 0:n(o)})};try{let c=function({text:e,schema:t}){try{let n=i.parse(e);if(null==t)return n;return function({value:e,schema:t}){let n=y({value:e,schema:t});if(!n.success)throw r.Gz.wrap({value:e,cause:n.error});return n.value}({value:n,schema:t})}catch(t){if(r.xU.isInstance(t)||r.Gz.isInstance(t))throw t;throw new r.xU({text:e,cause:t})}}({text:l,schema:e});return{responseHeaders:u,value:new r.w({message:t(c),url:s,requestBodyValues:a,statusCode:o.status,responseHeaders:u,responseBody:l,data:c,isRetryable:null==n?void 0:n(o,c)})}}catch(e){return{responseHeaders:u,value:new r.w({message:o.statusText,url:s,requestBodyValues:a,statusCode:o.status,responseHeaders:u,responseBody:l,isRetryable:null==n?void 0:n(o)})}}},C=e=>async({response:t})=>{let n=c(t);if(null==t.body)throw new r.g8({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(function(){let e,t,n,r="",o=[];function i(e,t){if(""===e){s(t);return}if(e.startsWith(":"))return;let n=e.indexOf(":");if(-1===n){a(e,"");return}let r=e.slice(0,n),o=n+1;a(r,o<e.length&&" "===e[o]?e.slice(o+1):e.slice(o))}function s(r){o.length>0&&(r.enqueue({event:e,data:o.join("\n"),id:t,retry:n}),o=[],e=void 0,n=void 0)}function a(r,i){switch(r){case"event":e=i;break;case"data":o.push(i);break;case"id":t=i;break;case"retry":let s=parseInt(i,10);isNaN(s)||(n=s)}}return new TransformStream({transform(e,t){let{lines:n,incompleteLine:o}=function(e,t){let n=[],r=e;for(let e=0;e<t.length;){let o=t[e++];"\n"===o?(n.push(r),r=""):"\r"===o?(n.push(r),r="","\n"===t[e]&&e++):r+=o}return{lines:n,incompleteLine:r}}(r,e);r=o;for(let e=0;e<n.length;e++)i(n[e],t)},flush(e){i(r,e),s(e)}})}()).pipeThrough(new TransformStream({transform({data:t},n){"[DONE]"!==t&&n.enqueue(v({text:t,schema:e}))}}))}},A=e=>async({response:t,url:n,requestBodyValues:o})=>{let i=await t.text(),s=v({text:i,schema:e}),a=c(t);if(!s.success)throw new r.w({message:"Invalid JSON response",cause:s.error,statusCode:t.status,responseHeaders:a,responseBody:i,url:n,requestBodyValues:o});return{responseHeaders:a,value:s.value,rawValue:s.rawValue}},O=()=>async({response:e,url:t,requestBodyValues:n})=>{let o=c(e);if(!e.body)throw new r.w({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:o,responseBody:void 0});try{let t=await e.arrayBuffer();return{responseHeaders:o,value:new Uint8Array(t)}}catch(i){throw new r.w({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:o,responseBody:void 0,cause:i})}},{btoa:N,atob:M}=globalThis;function I(e){let t=M(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}function R(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return N(t)}function z(e){return null==e?void 0:e.replace(/\/$/,"")}},5045:function(e,t,n){"use strict";n.d(t,{AX:function(){return v},A_:function(){return ec},Gz:function(){return es},JJ:function(){return Z},Mt:function(){return P},ON:function(){return et},RU:function(){return M},Rt:function(){return $},e$:function(){return C},g8:function(){return E},tZ:function(){return J},w:function(){return k},xU:function(){return U}});var r,o,i,s,a,l,u,c,p,d,h,f,m="vercel.ai.error",g=Symbol.for(m),y=class e extends Error{constructor({name:e,message:t,cause:n}){super(t),this[r]=!0,this.name=e,this.cause=n}static isInstance(t){return e.hasMarker(t,m)}static hasMarker(e,t){let n=Symbol.for(t);return null!=e&&"object"==typeof e&&n in e&&"boolean"==typeof e[n]&&!0===e[n]}};r=g;var v=y,b="AI_APICallError",w=`vercel.ai.error.${b}`,x=Symbol.for(w),k=class extends v{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:i,responseBody:s,cause:a,isRetryable:l=null!=r&&(408===r||409===r||429===r||r>=500),data:u}){super({name:b,message:e,cause:a}),this[o]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=i,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(e){return v.hasMarker(e,w)}};o=x;var _="AI_EmptyResponseBodyError",S=`vercel.ai.error.${_}`,T=Symbol.for(S),E=class extends v{constructor({message:e="Empty response body"}={}){super({name:_,message:e}),this[i]=!0}static isInstance(e){return v.hasMarker(e,S)}};function C(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}i=T;var A="AI_InvalidArgumentError",O=`vercel.ai.error.${A}`,N=Symbol.for(O),M=class extends v{constructor({message:e,cause:t,argument:n}){super({name:A,message:e,cause:t}),this[s]=!0,this.argument=n}static isInstance(e){return v.hasMarker(e,O)}};s=N;var I="AI_InvalidPromptError",R=`vercel.ai.error.${I}`,z=Symbol.for(R),P=class extends v{constructor({prompt:e,message:t,cause:n}){super({name:I,message:`Invalid prompt: ${t}`,cause:n}),this[a]=!0,this.prompt=e}static isInstance(e){return v.hasMarker(e,R)}};a=z;var L="AI_InvalidResponseDataError",j=`vercel.ai.error.${L}`,D=Symbol.for(j),$=class extends v{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:L,message:t}),this[l]=!0,this.data=e}static isInstance(e){return v.hasMarker(e,j)}};l=D;var H="AI_JSONParseError",B=`vercel.ai.error.${H}`,F=Symbol.for(B),U=class extends v{constructor({text:e,cause:t}){super({name:H,message:`JSON parsing failed: Text: ${e}.
Error message: ${C(t)}`,cause:t}),this[u]=!0,this.text=e}static isInstance(e){return v.hasMarker(e,B)}};u=F;var V="AI_LoadAPIKeyError",W=`vercel.ai.error.${V}`,q=Symbol.for(W),J=class extends v{constructor({message:e}){super({name:V,message:e}),this[c]=!0}static isInstance(e){return v.hasMarker(e,W)}};c=q,Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var Y="AI_NoSuchModelError",G=`vercel.ai.error.${Y}`,K=Symbol.for(G),Z=class extends v{constructor({errorName:e=Y,modelId:t,modelType:n,message:r=`No such ${n}: ${t}`}){super({name:e,message:r}),this[p]=!0,this.modelId=t,this.modelType=n}static isInstance(e){return v.hasMarker(e,G)}};p=K;var X="AI_TooManyEmbeddingValuesForCallError",Q=`vercel.ai.error.${X}`,ee=Symbol.for(Q),et=class extends v{constructor(e){super({name:X,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[d]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return v.hasMarker(e,Q)}};d=ee;var en="AI_TypeValidationError",er=`vercel.ai.error.${en}`,eo=Symbol.for(er),ei=class e extends v{constructor({value:e,cause:t}){super({name:en,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${C(t)}`,cause:t}),this[h]=!0,this.value=e}static isInstance(e){return v.hasMarker(e,er)}static wrap({value:t,cause:n}){return e.isInstance(n)&&n.value===t?n:new e({value:t,cause:n})}};h=eo;var es=ei,ea="AI_UnsupportedFunctionalityError",el=`vercel.ai.error.${ea}`,eu=Symbol.for(el),ec=class extends v{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:ea,message:t}),this[f]=!0,this.functionality=e}static isInstance(e){return v.hasMarker(e,el)}};f=eu},65339:function(e,t,n){"use strict";let r;n.d(t,{C3:function(){return W},Xy:function(){return U},gP:function(){return B}});var o=n(989);let i=Symbol("Let zodToJsonSchema decide on which parser to use"),s={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},a=e=>"string"==typeof e?{...s,name:e}:{...s,...e},l=e=>{let t=a(e),n=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,n])=>[n._def,{def:n._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}};var u=n(1604);let c=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")};function p(e){if("openAi"!==e.target)return{};let t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===e.$refStrategy?c(t,e.currentPath):t.join("/")}}function d(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function h(e,t,n,r,o){e[t]=n,d(e,t,r,o)}function f(e,t){return I(e.type._def,t)}let m=(e,t)=>I(e.innerType._def,t),g=(e,t)=>{let n={type:"integer",format:"unix-time"};if("openApi3"===t.target)return n;for(let r of e.checks)switch(r.kind){case"min":h(n,"minimum",r.value,r.message,t);break;case"max":h(n,"maximum",r.value,r.message,t)}return n},y=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,v={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===r&&(r=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),r),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function b(e,t){let n={type:"string"};if(e.checks)for(let r of e.checks)switch(r.kind){case"min":h(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":h(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":k(n,"email",r.message,t);break;case"format:idn-email":k(n,"idn-email",r.message,t);break;case"pattern:zod":_(n,v.email,r.message,t)}break;case"url":k(n,"uri",r.message,t);break;case"uuid":k(n,"uuid",r.message,t);break;case"regex":_(n,r.regex,r.message,t);break;case"cuid":_(n,v.cuid,r.message,t);break;case"cuid2":_(n,v.cuid2,r.message,t);break;case"startsWith":_(n,RegExp(`^${w(r.value,t)}`),r.message,t);break;case"endsWith":_(n,RegExp(`${w(r.value,t)}$`),r.message,t);break;case"datetime":k(n,"date-time",r.message,t);break;case"date":k(n,"date",r.message,t);break;case"time":k(n,"time",r.message,t);break;case"duration":k(n,"duration",r.message,t);break;case"length":h(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,r.value):r.value,r.message,t),h(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":_(n,RegExp(w(r.value,t)),r.message,t);break;case"ip":"v6"!==r.version&&k(n,"ipv4",r.message,t),"v4"!==r.version&&k(n,"ipv6",r.message,t);break;case"base64url":_(n,v.base64url,r.message,t);break;case"jwt":_(n,v.jwt,r.message,t);break;case"cidr":"v6"!==r.version&&_(n,v.ipv4Cidr,r.message,t),"v4"!==r.version&&_(n,v.ipv6Cidr,r.message,t);break;case"emoji":_(n,v.emoji(),r.message,t);break;case"ulid":_(n,v.ulid,r.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":k(n,"binary",r.message,t);break;case"contentEncoding:base64":h(n,"contentEncoding","base64",r.message,t);break;case"pattern:zod":_(n,v.base64,r.message,t)}break;case"nanoid":_(n,v.nanoid,r.message,t)}return n}function w(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let n=0;n<e.length;n++)x.has(e[n])||(t+="\\"),t+=e[n];return t}(e):e}let x=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function k(e,t,n,r){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):h(e,"format",t,n,r)}function _(e,t,n,r){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:S(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):h(e,"pattern",S(t,r),n,r)}function S(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source,o="",i=!1,s=!1,a=!1;for(let e=0;e<r.length;e++){if(i){o+=r[e],i=!1;continue}if(n.i){if(s){if(r[e].match(/[a-z]/)){a?(o+=r[e]+`${r[e-2]}-${r[e]}`.toUpperCase(),a=!1):"-"===r[e+1]&&r[e+2]?.match(/[a-z]/)?(o+=r[e],a=!0):o+=`${r[e]}${r[e].toUpperCase()}`;continue}}else if(r[e].match(/[a-z]/)){o+=`[${r[e]}${r[e].toUpperCase()}]`;continue}}if(n.m){if("^"===r[e]){o+=`(^|(?<=[\r
]))`;continue}if("$"===r[e]){o+=`($|(?=[\r
]))`;continue}}if(n.s&&"."===r[e]){o+=s?`${r[e]}\r
`:`[${r[e]}\r
]`;continue}o+=r[e],"\\"===r[e]?i=!0:s&&"]"===r[e]?s=!1:s||"["!==r[e]||(s=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return o}function T(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===u.pA.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((n,r)=>({...n,[r]:I(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",r]})??p(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};let n={type:"object",additionalProperties:I(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if("openApi3"===t.target)return n;if(e.keyType?._def.typeName===u.pA.ZodString&&e.keyType._def.checks?.length){let{type:r,...o}=b(e.keyType._def,t);return{...n,propertyNames:o}}if(e.keyType?._def.typeName===u.pA.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===u.pA.ZodBranded&&e.keyType._def.type._def.typeName===u.pA.ZodString&&e.keyType._def.type._def.checks?.length){let{type:r,...o}=f(e.keyType._def,t);return{...n,propertyNames:o}}return n}let E={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},C=(e,t)=>{let n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,n)=>I(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${n}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return n.length?{anyOf:n}:void 0},A=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return I(e.innerType._def,t);let n=I(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:p(t)},n]}:p(t)},O=(e,t)=>{if("input"===t.pipeStrategy)return I(e.in._def,t);if("output"===t.pipeStrategy)return I(e.out._def,t);let n=I(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=I(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(e=>void 0!==e)}},N=(e,t)=>I(e.innerType._def,t),M=(e,t,n)=>{switch(t){case u.pA.ZodString:return b(e,n);case u.pA.ZodNumber:return function(e,t){let n={type:"number"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"int":n.type="integer",d(n,"type",r.message,t);break;case"min":"jsonSchema7"===t.target?r.inclusive?h(n,"minimum",r.value,r.message,t):h(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),h(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?h(n,"maximum",r.value,r.message,t):h(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),h(n,"maximum",r.value,r.message,t));break;case"multipleOf":h(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case u.pA.ZodObject:return function(e,t){let n="openAi"===t.target,r={type:"object",properties:{}},o=[],i=e.shape();for(let e in i){let s=i[e];if(void 0===s||void 0===s._def)continue;let a=function(e){try{return e.isOptional()}catch{return!0}}(s);a&&n&&("ZodOptional"===s._def.typeName&&(s=s._def.innerType),s.isNullable()||(s=s.nullable()),a=!1);let l=I(s._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==l&&(r.properties[e]=l,a||o.push(e))}o.length&&(r.required=o);let s=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return I(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==s&&(r.additionalProperties=s),r}(e,n);case u.pA.ZodBigInt:return function(e,t){let n={type:"integer",format:"int64"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"min":"jsonSchema7"===t.target?r.inclusive?h(n,"minimum",r.value,r.message,t):h(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),h(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?h(n,"maximum",r.value,r.message,t):h(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),h(n,"maximum",r.value,r.message,t));break;case"multipleOf":h(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case u.pA.ZodBoolean:return{type:"boolean"};case u.pA.ZodDate:return function e(t,n,r){let o=r??n.dateStrategy;if(Array.isArray(o))return{anyOf:o.map((r,o)=>e(t,n,r))};switch(o){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return g(t,n)}}(e,n);case u.pA.ZodUndefined:return{not:p(n)};case u.pA.ZodNull:return"openApi3"===n.target?{enum:["null"],nullable:!0}:{type:"null"};case u.pA.ZodArray:return function(e,t){let n={type:"array"};return e.type?._def&&e.type?._def?.typeName!==u.pA.ZodAny&&(n.items=I(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&h(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&h(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(h(n,"minItems",e.exactLength.value,e.exactLength.message,t),h(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}(e,n);case u.pA.ZodUnion:case u.pA.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return C(e,t);let n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(e=>e._def.typeName in E&&(!e._def.checks||!e._def.checks.length))){let e=n.reduce((e,t)=>{let n=E[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e},[]);return{type:e.length>1?e:e[0]}}if(n.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=n.reduce((e,t)=>{let n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[...e,n];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===n.length){let t=e.filter((e,t,n)=>n.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:n.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(n.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:n.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return C(e,t)}(e,n);case u.pA.ZodIntersection:return function(e,t){let n=[I(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),I(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),r="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,o=[];return n.forEach(e=>{if(y(e))o.push(...e.allOf),void 0===e.unevaluatedProperties&&(r=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:n,...r}=e;t=r}else r=void 0;o.push(t)}}),o.length?{allOf:o,...r}:void 0}(e,n);case u.pA.ZodTuple:return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,t)=>I(e._def,{...n,currentPath:[...n.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:I(e.rest._def,{...n,currentPath:[...n.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,t)=>I(e._def,{...n,currentPath:[...n.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])};case u.pA.ZodRecord:return T(e,n);case u.pA.ZodLiteral:return function(e,t){let n=typeof e.value;return"bigint"!==n&&"number"!==n&&"boolean"!==n&&"string"!==n?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===n?"integer":n,enum:[e.value]}:{type:"bigint"===n?"integer":n,const:e.value}}(e,n);case u.pA.ZodEnum:return{type:"string",enum:Array.from(e.values)};case u.pA.ZodNativeEnum:return function(e){let t=e.values,n=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),r=Array.from(new Set(n.map(e=>typeof e)));return{type:1===r.length?"string"===r[0]?"string":"number":["string","number"],enum:n}}(e);case u.pA.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:E[e.innerType._def.typeName],nullable:!0}:{type:[E[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let n=I(e.innerType._def,{...t,currentPath:[...t.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let n=I(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}(e,n);case u.pA.ZodOptional:return A(e,n);case u.pA.ZodMap:return"record"===n.mapStrategy?T(e,n):{type:"array",maxItems:125,items:{type:"array",items:[I(e.keyType._def,{...n,currentPath:[...n.currentPath,"items","items","0"]})||p(n),I(e.valueType._def,{...n,currentPath:[...n.currentPath,"items","items","1"]})||p(n)],minItems:2,maxItems:2}};case u.pA.ZodSet:return function(e,t){let n={type:"array",uniqueItems:!0,items:I(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&h(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&h(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}(e,n);case u.pA.ZodLazy:return()=>e.getter()._def;case u.pA.ZodPromise:return I(e.type._def,n);case u.pA.ZodNaN:case u.pA.ZodNever:return"openAi"===n.target?void 0:{not:p({...n,currentPath:[...n.currentPath,"not"]})};case u.pA.ZodEffects:return"input"===n.effectStrategy?I(e.schema._def,n):p(n);case u.pA.ZodAny:case u.pA.ZodUnknown:return p(n);case u.pA.ZodDefault:return{...I(e.innerType._def,n),default:e.defaultValue()};case u.pA.ZodBranded:return f(e,n);case u.pA.ZodReadonly:return N(e,n);case u.pA.ZodCatch:return m(e,n);case u.pA.ZodPipeline:return O(e,n);case u.pA.ZodFunction:case u.pA.ZodVoid:case u.pA.ZodSymbol:default:return}};function I(e,t,n=!1){let r=t.seen.get(e);if(t.override){let o=t.override?.(e,t,r,n);if(o!==i)return o}if(r&&!n){let e=R(r,t);if(void 0!==e)return e}let o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);let s=M(e,e.typeName,t),a="function"==typeof s?I(s(),t):s;if(a&&z(e,t,a),t.postProcess){let n=t.postProcess(a,e,t);return o.jsonSchema=a,n}return o.jsonSchema=a,a}let R=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:c(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,n)=>t.currentPath[n]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),p(t);return"seen"===t.$refStrategy?p(t):void 0}},z=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n);var P=(e,t)=>{let n=l(t),r="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>({...e,[t]:I(r._def,{...n,currentPath:[...n.basePath,n.definitionPath,t]},!0)??p(n)}),{}):void 0,o="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,i=I(e._def,void 0===o?n:{...n,currentPath:[...n.basePath,n.definitionPath,o]},!1)??p(n),s="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==s&&(i.title=s),n.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[n.openAiAnyTypeName]||(r[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===n.$refStrategy?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));let a=void 0===o?r?{...i,[n.definitionPath]:r}:i:{$ref:[..."relative"===n.$refStrategy?[]:n.basePath,n.definitionPath,o].join("/"),[n.definitionPath]:{...r,[o]:i}};return"jsonSchema7"===n.target?a.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===n.target||"openAi"===n.target)&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===n.target&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a},L={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},j={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},D={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},$={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},H={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}};function B(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=(0,o.NX)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=(0,o.NX)({text:function(e){let t=["ROOT"],n=-1,r=null;function o(e,o,i){switch(e){case'"':n=o,t.pop(),t.push(i),t.push("INSIDE_STRING");break;case"f":case"t":case"n":n=o,r=o,t.pop(),t.push(i),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=o,t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"{":n=o,t.pop(),t.push(i),t.push("INSIDE_OBJECT_START");break;case"[":n=o,t.pop(),t.push(i),t.push("INSIDE_ARRAY_START")}}function i(e,r){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":n=r,t.pop()}}function s(e,r){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":n=r,t.pop()}}for(let a=0;a<e.length;a++){let l=e[a];switch(t[t.length-1]){case"ROOT":o(l,a,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":n=a,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,a,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":i(l,a);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),n=a;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:n=a}break;case"INSIDE_ARRAY_START":"]"===l?(n=a,t.pop()):(n=a,o(l,a,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":n=a,t.pop();break;default:n=a}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,a,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),n=a;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=a;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,a),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(l,a);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(l,a);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,a);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(r,a+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?n=a:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?i(l,a):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,a))}}}let a=e.slice(0,n+1);for(let n=t.length-1;n>=0;n--)switch(t[n]){case"INSIDE_STRING":a+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":a+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":a+="]";break;case"INSIDE_LITERAL":{let t=e.substring(r,e.length);"true".startsWith(t)?a+="true".slice(t.length):"false".startsWith(t)?a+="false".slice(t.length):"null".startsWith(t)&&(a+="null".slice(t.length))}}return a}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}L.code,j.code,D.code,$.code,H.code,L.name,L.code,j.name,j.code,D.name,D.code,$.name,$.code,H.name,H.code,[L,j,D,$,H].map(e=>e.code);var F=[{code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},{code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},{code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},{code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},{code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},{code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},{code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},{code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},{code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},{code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},{code:"f",name:"start_step",parse:e=>{if(null==e||"object"!=typeof e||!("messageId"in e)||"string"!=typeof e.messageId)throw Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},{code:"g",name:"reasoning",parse:e=>{if("string"!=typeof e)throw Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},{code:"h",name:"source",parse:e=>{if(null==e||"object"!=typeof e)throw Error('"source" parts expect a Source object.');return{type:"source",value:e}}},{code:"i",name:"redacted_reasoning",parse:e=>{if(null==e||"object"!=typeof e||!("data"in e)||"string"!=typeof e.data)throw Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},{code:"j",name:"reasoning_signature",parse:e=>{if(null==e||"object"!=typeof e||!("signature"in e)||"string"!=typeof e.signature)throw Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},{code:"k",name:"file",parse:e=>{if(null==e||"object"!=typeof e||!("data"in e)||"string"!=typeof e.data||!("mimeType"in e)||"string"!=typeof e.mimeType)throw Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}}];function U(e,t){let n=F.find(t=>t.name===e);if(!n)throw Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}Object.fromEntries(F.map(e=>[e.code,e])),Object.fromEntries(F.map(e=>[e.name,e.code])),F.map(e=>e.code);var V=Symbol.for("vercel.ai.schema");function W(e){var t,n;return"object"==typeof e&&null!==e&&V in e&&!0===e[V]&&"jsonSchema"in e&&"validate"in e?e:function(e,{validate:t}={}){return{[V]:!0,_type:void 0,[o.pY]:!0,jsonSchema:e,validate:t}}(P(e,{$refStrategy:null!=(n=null==t?void 0:t.useReferences)&&n?"root":"none",target:"jsonSchema7"}),{validate:t=>{let n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}})}},89056:function(e,t,n){"use strict";let r;n.d(t,{x8:function(){return eQ},VY:function(){return eK},dk:function(){return eX},aV:function(){return eG},h_:function(){return eY},fC:function(){return eq},Dx:function(){return eZ},xz:function(){return eJ}});var o,i=n(67294),s=n.t(i,2);function a(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e?.(r),!1===n||!r.defaultPrevented)return t?.(r)}}function l(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function u(...e){return t=>{let n=!1,r=e.map(e=>{let r=l(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof n?n():l(e[t],null)}}}}function c(...e){return i.useCallback(u(...e),e)}var p=n(85893),d=globalThis?.document?i.useLayoutEffect:()=>{},h=s[" useId ".trim().toString()]||(()=>void 0),f=0;function m(e){let[t,n]=i.useState(h());return d(()=>{e||n(e=>e??String(f++))},[e]),e||(t?`radix-${t}`:"")}var g=s[" useInsertionEffect ".trim().toString()]||d;Symbol("RADIX:SYNC_STATE");var y=n(73935);function v(e){let t=function(e){let t=i.forwardRef((e,t)=>{let{children:n,...r}=e;if(i.isValidElement(n)){let e,o;let s=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?n.props.ref:n.props.ref||n.ref,a=function(e,t){let n={...t};for(let r in t){let o=e[r],i=t[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...e)=>{let t=i(...e);return o(...e),t}:o&&(n[r]=o):"style"===r?n[r]={...o,...i}:"className"===r&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==i.Fragment&&(a.ref=t?u(t,s):s),i.cloneElement(n,a)}return i.Children.count(n)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),n=i.forwardRef((e,n)=>{let{children:r,...o}=e,s=i.Children.toArray(r),a=s.find(w);if(a){let e=a.props.children,r=s.map(t=>t!==a?t:i.Children.count(e)>1?i.Children.only(null):i.isValidElement(e)?e.props.children:null);return(0,p.jsx)(t,{...o,ref:n,children:i.isValidElement(e)?i.cloneElement(e,void 0,r):null})}return(0,p.jsx)(t,{...o,ref:n,children:r})});return n.displayName=`${e}.Slot`,n}var b=Symbol("radix.slottable");function w(e){return i.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===b}var x=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let n=v(`Primitive.${t}`),r=i.forwardRef((e,r)=>{let{asChild:o,...i}=e,s=o?n:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,p.jsx)(s,{...i,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function k(e){let t=i.useRef(e);return i.useEffect(()=>{t.current=e}),i.useMemo(()=>(...e)=>t.current?.(...e),[])}var _="dismissableLayer.update",S=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),T=i.forwardRef((e,t)=>{let{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:l,onInteractOutside:u,onDismiss:d,...h}=e,f=i.useContext(S),[m,g]=i.useState(null),y=m?.ownerDocument??globalThis?.document,[,v]=i.useState({}),b=c(t,e=>g(e)),w=Array.from(f.layers),[T]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),A=w.indexOf(T),O=m?w.indexOf(m):-1,N=f.layersWithOutsidePointerEventsDisabled.size>0,M=O>=A,I=function(e,t=globalThis?.document){let n=k(e),r=i.useRef(!1),o=i.useRef(()=>{});return i.useEffect(()=>{let e=e=>{if(e.target&&!r.current){let r=function(){C("dismissableLayer.pointerDownOutside",n,i,{discrete:!0})},i={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",o.current),o.current=r,t.addEventListener("click",o.current,{once:!0})):r()}else t.removeEventListener("click",o.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",e),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}(e=>{let t=e.target,n=[...f.branches].some(e=>e.contains(t));!M||n||(s?.(e),u?.(e),e.defaultPrevented||d?.())},y),R=function(e,t=globalThis?.document){let n=k(e),r=i.useRef(!1);return i.useEffect(()=>{let e=e=>{e.target&&!r.current&&C("dismissableLayer.focusOutside",n,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}(e=>{let t=e.target;[...f.branches].some(e=>e.contains(t))||(l?.(e),u?.(e),e.defaultPrevented||d?.())},y);return!function(e,t=globalThis?.document){let n=k(e);i.useEffect(()=>{let e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[n,t])}(e=>{O!==f.layers.size-1||(r?.(e),!e.defaultPrevented&&d&&(e.preventDefault(),d()))},y),i.useEffect(()=>{if(m)return n&&(0===f.layersWithOutsidePointerEventsDisabled.size&&(o=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(m)),f.layers.add(m),E(),()=>{n&&1===f.layersWithOutsidePointerEventsDisabled.size&&(y.body.style.pointerEvents=o)}},[m,y,n,f]),i.useEffect(()=>()=>{m&&(f.layers.delete(m),f.layersWithOutsidePointerEventsDisabled.delete(m),E())},[m,f]),i.useEffect(()=>{let e=()=>v({});return document.addEventListener(_,e),()=>document.removeEventListener(_,e)},[]),(0,p.jsx)(x.div,{...h,ref:b,style:{pointerEvents:N?M?"auto":"none":void 0,...e.style},onFocusCapture:a(e.onFocusCapture,R.onFocusCapture),onBlurCapture:a(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:a(e.onPointerDownCapture,I.onPointerDownCapture)})});function E(){let e=new CustomEvent(_);document.dispatchEvent(e)}function C(e,t,n,{discrete:r}){let o=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});(t&&o.addEventListener(e,t,{once:!0}),r)?o&&y.flushSync(()=>o.dispatchEvent(i)):o.dispatchEvent(i)}T.displayName="DismissableLayer",i.forwardRef((e,t)=>{let n=i.useContext(S),r=i.useRef(null),o=c(t,r);return i.useEffect(()=>{let e=r.current;if(e)return n.branches.add(e),()=>{n.branches.delete(e)}},[n.branches]),(0,p.jsx)(x.div,{...e,ref:o})}).displayName="DismissableLayerBranch";var A="focusScope.autoFocusOnMount",O="focusScope.autoFocusOnUnmount",N={bubbles:!1,cancelable:!0},M=i.forwardRef((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...a}=e,[l,u]=i.useState(null),d=k(o),h=k(s),f=i.useRef(null),m=c(t,e=>u(e)),g=i.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;i.useEffect(()=>{if(r){let e=function(e){if(g.paused||!l)return;let t=e.target;l.contains(t)?f.current=t:z(f.current,{select:!0})},t=function(e){if(g.paused||!l)return;let t=e.relatedTarget;null===t||l.contains(t)||z(f.current,{select:!0})};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let n=new MutationObserver(function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&z(l)});return l&&n.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}},[r,l,g.paused]),i.useEffect(()=>{if(l){P.add(g);let e=document.activeElement;if(!l.contains(e)){let t=new CustomEvent(A,N);l.addEventListener(A,d),l.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let n=document.activeElement;for(let r of e)if(z(r,{select:t}),document.activeElement!==n)return}(I(l).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&z(l))}return()=>{l.removeEventListener(A,d),setTimeout(()=>{let t=new CustomEvent(O,N);l.addEventListener(O,h),l.dispatchEvent(t),t.defaultPrevented||z(e??document.body,{select:!0}),l.removeEventListener(O,h),P.remove(g)},0)}}},[l,d,h,g]);let y=i.useCallback(e=>{if(!n&&!r||g.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,o=document.activeElement;if(t&&o){let t=e.currentTarget,[r,i]=function(e){let t=I(e);return[R(t,e),R(t.reverse(),e)]}(t);r&&i?e.shiftKey||o!==i?e.shiftKey&&o===r&&(e.preventDefault(),n&&z(i,{select:!0})):(e.preventDefault(),n&&z(r,{select:!0})):o===t&&e.preventDefault()}},[n,r,g.paused]);return(0,p.jsx)(x.div,{tabIndex:-1,...a,ref:m,onKeyDown:y})});function I(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function R(e,t){for(let n of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(n,{upTo:t}))return n}function z(e,{select:t=!1}={}){if(e&&e.focus){var n;let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&(n=e)instanceof HTMLInputElement&&"select"in n&&t&&e.select()}}M.displayName="FocusScope";var P=(r=[],{add(e){let t=r[0];e!==t&&t?.pause(),(r=L(r,e)).unshift(e)},remove(e){r=L(r,e),r[0]?.resume()}});function L(e,t){let n=[...e],r=n.indexOf(t);return -1!==r&&n.splice(r,1),n}var j=i.forwardRef((e,t)=>{let{container:n,...r}=e,[o,s]=i.useState(!1);d(()=>s(!0),[]);let a=n||o&&globalThis?.document?.body;return a?y.createPortal((0,p.jsx)(x.div,{...r,ref:t}),a):null});j.displayName="Portal";var D=e=>{let t,n;let{present:r,children:o}=e,s=function(e){var t,n;let[r,o]=i.useState(),s=i.useRef(null),a=i.useRef(e),l=i.useRef("none"),[u,c]=(t=e?"mounted":"unmounted",n={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},i.useReducer((e,t)=>n[e][t]??e,t));return i.useEffect(()=>{let e=$(s.current);l.current="mounted"===u?e:"none"},[u]),d(()=>{let t=s.current,n=a.current;if(n!==e){let r=l.current,o=$(t);e?c("MOUNT"):"none"===o||t?.display==="none"?c("UNMOUNT"):n&&r!==o?c("ANIMATION_OUT"):c("UNMOUNT"),a.current=e}},[e,c]),d(()=>{if(r){let e;let t=r.ownerDocument.defaultView??window,n=n=>{let o=$(s.current).includes(n.animationName);if(n.target===r&&o&&(c("ANIMATION_END"),!a.current)){let n=r.style.animationFillMode;r.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===r.style.animationFillMode&&(r.style.animationFillMode=n)})}},o=e=>{e.target===r&&(l.current=$(s.current))};return r.addEventListener("animationstart",o),r.addEventListener("animationcancel",n),r.addEventListener("animationend",n),()=>{t.clearTimeout(e),r.removeEventListener("animationstart",o),r.removeEventListener("animationcancel",n),r.removeEventListener("animationend",n)}}c("ANIMATION_END")},[r,c]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:i.useCallback(e=>{s.current=e?getComputedStyle(e):null,o(e)},[])}}(r),a="function"==typeof o?o({present:s.isPresent}):i.Children.only(o),l=c(s.ref,(t=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning?a.ref:(t=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning?a.props.ref:a.props.ref||a.ref);return"function"==typeof o||s.isPresent?i.cloneElement(a,{ref:l}):null};function $(e){return e?.animationName||"none"}D.displayName="Presence";var H=0;function B(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var F=n(70655),U=n(71642),V=n(99495),W=(0,n(87122)._)(),q=function(){},J=i.forwardRef(function(e,t){var n=i.useRef(null),r=i.useState({onScrollCapture:q,onWheelCapture:q,onTouchMoveCapture:q}),o=r[0],s=r[1],a=e.forwardProps,l=e.children,u=e.className,c=e.removeScrollBar,p=e.enabled,d=e.shards,h=e.sideCar,f=e.noRelative,m=e.noIsolation,g=e.inert,y=e.allowPinchZoom,v=e.as,b=e.gapMode,w=(0,F._T)(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=(0,V.q)([n,t]),k=(0,F.pi)((0,F.pi)({},w),o);return i.createElement(i.Fragment,null,p&&i.createElement(h,{sideCar:W,removeScrollBar:c,shards:d,noRelative:f,noIsolation:m,inert:g,setCallbacks:s,allowPinchZoom:!!y,lockRef:n,gapMode:b}),a?i.cloneElement(i.Children.only(l),(0,F.pi)((0,F.pi)({},k),{ref:x})):i.createElement(void 0===v?"div":v,(0,F.pi)({},k,{className:u,ref:x}),l))});J.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},J.classNames={fullWidth:U.zi,zeroRight:U.pF};var Y=n(66781),G=n(37087),K=n(6525),Z=!1;if("undefined"!=typeof window)try{var X=Object.defineProperty({},"passive",{get:function(){return Z=!0,!0}});window.addEventListener("test",X,X),window.removeEventListener("test",X,X)}catch(e){Z=!1}var Q=!!Z&&{passive:!1},ee=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&"TEXTAREA"!==e.tagName&&"visible"===n[t])},et=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),en(e,r)){var o=er(e,r);if(o[1]>o[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},en=function(e,t){return"v"===e?ee(t,"overflowY"):ee(t,"overflowX")},er=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},eo=function(e,t,n,r,o){var i,s=(i=window.getComputedStyle(t).direction,"h"===e&&"rtl"===i?-1:1),a=s*r,l=n.target,u=t.contains(l),c=!1,p=a>0,d=0,h=0;do{if(!l)break;var f=er(e,l),m=f[0],g=f[1]-f[2]-s*m;(m||g)&&en(e,l)&&(d+=g,h+=m);var y=l.parentNode;l=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!u&&l!==document.body||u&&(t.contains(l)||t===l));return p&&(o&&1>Math.abs(d)||!o&&a>d)?c=!0:!p&&(o&&1>Math.abs(h)||!o&&-a>h)&&(c=!0),c},ei=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},es=function(e){return[e.deltaX,e.deltaY]},ea=function(e){return e&&"current"in e?e.current:e},el=0,eu=[],ec=(0,Y.L)(W,function(e){var t=i.useRef([]),n=i.useRef([0,0]),r=i.useRef(),o=i.useState(el++)[0],s=i.useState(K.Ws)[0],a=i.useRef(e);i.useEffect(function(){a.current=e},[e]),i.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var t=(0,F.ev)([e.lockRef.current],(e.shards||[]).map(ea),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var l=i.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!a.current.allowPinchZoom;var o,i=ei(e),s=n.current,l="deltaX"in e?e.deltaX:s[0]-i[0],u="deltaY"in e?e.deltaY:s[1]-i[1],c=e.target,p=Math.abs(l)>Math.abs(u)?"h":"v";if("touches"in e&&"h"===p&&"range"===c.type)return!1;var d=et(p,c);if(!d)return!0;if(d?o=p:(o="v"===p?"h":"v",d=et(p,c)),!d)return!1;if(!r.current&&"changedTouches"in e&&(l||u)&&(r.current=o),!o)return!0;var h=r.current||o;return eo(h,t,e,"h"===h?l:u,!0)},[]),u=i.useCallback(function(e){if(eu.length&&eu[eu.length-1]===s){var n="deltaY"in e?es(e):ei(e),r=t.current.filter(function(t){var r;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(r=t.delta)[0]===n[0]&&r[1]===n[1]})[0];if(r&&r.should){e.cancelable&&e.preventDefault();return}if(!r){var o=(a.current.shards||[]).map(ea).filter(Boolean).filter(function(t){return t.contains(e.target)});(o.length>0?l(e,o[0]):!a.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),c=i.useCallback(function(e,n,r,o){var i={name:e,delta:n,target:r,should:o,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(r)};t.current.push(i),setTimeout(function(){t.current=t.current.filter(function(e){return e!==i})},1)},[]),p=i.useCallback(function(e){n.current=ei(e),r.current=void 0},[]),d=i.useCallback(function(t){c(t.type,es(t),t.target,l(t,e.lockRef.current))},[]),h=i.useCallback(function(t){c(t.type,ei(t),t.target,l(t,e.lockRef.current))},[]);i.useEffect(function(){return eu.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",u,Q),document.addEventListener("touchmove",u,Q),document.addEventListener("touchstart",p,Q),function(){eu=eu.filter(function(e){return e!==s}),document.removeEventListener("wheel",u,Q),document.removeEventListener("touchmove",u,Q),document.removeEventListener("touchstart",p,Q)}},[]);var f=e.removeScrollBar,m=e.inert;return i.createElement(i.Fragment,null,m?i.createElement(s,{styles:"\n  .block-interactivity-".concat(o," {pointer-events: none;}\n  .allow-interactivity-").concat(o," {pointer-events: all;}\n")}):null,f?i.createElement(G.jp,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}),ep=i.forwardRef(function(e,t){return i.createElement(J,(0,F.pi)({},e,{ref:t,sideCar:ec}))});ep.classNames=J.classNames;var ed=n(23541),eh="Dialog",[ef,em]=function(e,t=[]){let n=[],r=()=>{let t=n.map(e=>i.createContext(e));return function(n){let r=n?.[e]||t;return i.useMemo(()=>({[`__scope${e}`]:{...n,[e]:r}}),[n,r])}};return r.scopeName=e,[function(t,r){let o=i.createContext(r),s=n.length;n=[...n,r];let a=t=>{let{scope:n,children:r,...a}=t,l=n?.[e]?.[s]||o,u=i.useMemo(()=>a,Object.values(a));return(0,p.jsx)(l.Provider,{value:u,children:r})};return a.displayName=t+"Provider",[a,function(n,a){let l=a?.[e]?.[s]||o,u=i.useContext(l);if(u)return u;if(void 0!==r)return r;throw Error(`\`${n}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=n.reduce((t,{useScope:n,scopeName:r})=>{let o=n(e)[`__scope${r}`];return{...t,...o}},{});return i.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return n.scopeName=t.scopeName,n}(r,...t)]}(eh),[eg,ey]=ef(eh),ev=e=>{let{__scopeDialog:t,children:n,open:r,defaultOpen:o,onOpenChange:s,modal:a=!0}=e,l=i.useRef(null),u=i.useRef(null),[c,d]=function({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){let[o,s,a]=function({defaultProp:e,onChange:t}){let[n,r]=i.useState(e),o=i.useRef(n),s=i.useRef(t);return g(()=>{s.current=t},[t]),i.useEffect(()=>{o.current!==n&&(s.current?.(n),o.current=n)},[n,o]),[n,r,s]}({defaultProp:t,onChange:n}),l=void 0!==e,u=l?e:o;{let t=i.useRef(void 0!==e);i.useEffect(()=>{let e=t.current;if(e!==l){let t=l?"controlled":"uncontrolled";console.warn(`${r} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=l},[l,r])}return[u,i.useCallback(t=>{if(l){let n="function"==typeof t?t(e):t;n!==e&&a.current?.(n)}else s(t)},[l,e,s,a])]}({prop:r,defaultProp:o??!1,onChange:s,caller:eh});return(0,p.jsx)(eg,{scope:t,triggerRef:l,contentRef:u,contentId:m(),titleId:m(),descriptionId:m(),open:c,onOpenChange:d,onOpenToggle:i.useCallback(()=>d(e=>!e),[d]),modal:a,children:n})};ev.displayName=eh;var eb="DialogTrigger",ew=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,o=ey(eb,n),i=c(t,o.triggerRef);return(0,p.jsx)(x.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":eH(o.open),...r,ref:i,onClick:a(e.onClick,o.onOpenToggle)})});ew.displayName=eb;var ex="DialogPortal",[ek,e_]=ef(ex,{forceMount:void 0}),eS=e=>{let{__scopeDialog:t,forceMount:n,children:r,container:o}=e,s=ey(ex,t);return(0,p.jsx)(ek,{scope:t,forceMount:n,children:i.Children.map(r,e=>(0,p.jsx)(D,{present:n||s.open,children:(0,p.jsx)(j,{asChild:!0,container:o,children:e})}))})};eS.displayName=ex;var eT="DialogOverlay",eE=i.forwardRef((e,t)=>{let n=e_(eT,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,i=ey(eT,e.__scopeDialog);return i.modal?(0,p.jsx)(D,{present:r||i.open,children:(0,p.jsx)(eA,{...o,ref:t})}):null});eE.displayName=eT;var eC=v("DialogOverlay.RemoveScroll"),eA=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,o=ey(eT,n);return(0,p.jsx)(ep,{as:eC,allowPinchZoom:!0,shards:[o.contentRef],children:(0,p.jsx)(x.div,{"data-state":eH(o.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),eO="DialogContent",eN=i.forwardRef((e,t)=>{let n=e_(eO,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,i=ey(eO,e.__scopeDialog);return(0,p.jsx)(D,{present:r||i.open,children:i.modal?(0,p.jsx)(eM,{...o,ref:t}):(0,p.jsx)(eI,{...o,ref:t})})});eN.displayName=eO;var eM=i.forwardRef((e,t)=>{let n=ey(eO,e.__scopeDialog),r=i.useRef(null),o=c(t,n.contentRef,r);return i.useEffect(()=>{let e=r.current;if(e)return(0,ed.Ry)(e)},[]),(0,p.jsx)(eR,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:a(e.onCloseAutoFocus,e=>{e.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:a(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()}),onFocusOutside:a(e.onFocusOutside,e=>e.preventDefault())})}),eI=i.forwardRef((e,t)=>{let n=ey(eO,e.__scopeDialog),r=i.useRef(!1),o=i.useRef(!1);return(0,p.jsx)(eR,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(r.current||n.triggerRef.current?.focus(),t.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(r.current=!0,"pointerdown"!==t.detail.originalEvent.type||(o.current=!0));let i=t.target;n.triggerRef.current?.contains(i)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&o.current&&t.preventDefault()}})}),eR=i.forwardRef((e,t)=>{let{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:s,...a}=e,l=ey(eO,n),u=i.useRef(null),d=c(t,u);return i.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??B()),document.body.insertAdjacentElement("beforeend",e[1]??B()),H++,()=>{1===H&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),H--}},[]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(M,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:s,children:(0,p.jsx)(T,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":eH(l.open),...a,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(eV,{titleId:l.titleId}),(0,p.jsx)(eW,{contentRef:u,descriptionId:l.descriptionId})]})]})}),ez="DialogTitle",eP=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,o=ey(ez,n);return(0,p.jsx)(x.h2,{id:o.titleId,...r,ref:t})});eP.displayName=ez;var eL="DialogDescription",ej=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,o=ey(eL,n);return(0,p.jsx)(x.p,{id:o.descriptionId,...r,ref:t})});ej.displayName=eL;var eD="DialogClose",e$=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,o=ey(eD,n);return(0,p.jsx)(x.button,{type:"button",...r,ref:t,onClick:a(e.onClick,()=>o.onOpenChange(!1))})});function eH(e){return e?"open":"closed"}e$.displayName=eD;var eB="DialogTitleWarning",[eF,eU]=function(e,t){let n=i.createContext(t),r=e=>{let{children:t,...r}=e,o=i.useMemo(()=>r,Object.values(r));return(0,p.jsx)(n.Provider,{value:o,children:t})};return r.displayName=e+"Provider",[r,function(r){let o=i.useContext(n);if(o)return o;if(void 0!==t)return t;throw Error(`\`${r}\` must be used within \`${e}\``)}]}(eB,{contentName:eO,titleName:ez,docsSlug:"dialog"}),eV=({titleId:e})=>{let t=eU(eB),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return i.useEffect(()=>{e&&!document.getElementById(e)&&console.error(n)},[n,e]),null},eW=({contentRef:e,descriptionId:t})=>{let n=eU("DialogDescriptionWarning"),r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${n.contentName}}.`;return i.useEffect(()=>{let n=e.current?.getAttribute("aria-describedby");t&&n&&!document.getElementById(t)&&console.warn(r)},[r,e,t]),null},eq=ev,eJ=ew,eY=eS,eG=eE,eK=eN,eZ=eP,eX=ej,eQ=e$},26761:function(e,t,n){"use strict";n.d(t,{ZP:function(){return i}});var r=n(5865);let o=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,i=r.NB.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",(0,r.P1)(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[(0,r.x2)({find:o,type:this.type,getAttributes:e=>{let[,,t,n,r]=e;return{src:n,alt:t,title:r}}})]}})},85915:function(e,t,n){"use strict";n.d(t,{ZP:function(){return eU}});var r=n(5865);let o=(e,t)=>{for(let n in t)e[n]=t[n];return e},i="numeric",s="ascii",a="alpha",l="asciinumeric",u="alphanumeric",c="domain",p="emoji",d="whitespace";function h(e,t,n){for(let r in t[i]&&(t[l]=!0,t[u]=!0),t[s]&&(t[l]=!0,t[a]=!0),t[l]&&(t[u]=!0),t[a]&&(t[u]=!0),t[u]&&(t[c]=!0),t[p]&&(t[c]=!0),t){let t=(r in n||(n[r]=[]),n[r]);0>t.indexOf(e)&&t.push(e)}}function f(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}f.groups={},f.prototype={accepts(){return!!this.t},go(e){let t=this.j[e];if(t)return t;for(let t=0;t<this.jr.length;t++){let n=this.jr[t][0],r=this.jr[t][1];if(r&&n.test(e))return r}return this.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,n,r){for(let o=0;o<e.length;o++)this.tt(e[o],t,n,r)},tr(e,t,n,r){let o;return r=r||f.groups,t&&t.j?o=t:(o=new f(t),n&&r&&h(t,n,r)),this.jr.push([e,o]),o},ts(e,t,n,r){let o=this,i=e.length;if(!i)return o;for(let t=0;t<i-1;t++)o=o.tt(e[t]);return o.tt(e[i-1],t,n,r)},tt(e,t,n,r){if(r=r||f.groups,t&&t.j)return this.j[e]=t,t;let i,s=this.go(e);return s?(o((i=new f).j,s.j),i.jr.push.apply(i.jr,s.jr),i.jd=s.jd,i.t=s.t):i=new f,t&&(r&&(i.t&&"string"==typeof i.t?h(t,o(function(e,t){let n={};for(let r in t)t[r].indexOf(e)>=0&&(n[r]=!0);return n}(i.t,r),n),r):n&&h(t,n,r)),i.t=t),this.j[e]=i,i}};let m=(e,t,n,r,o)=>e.ta(t,n,r,o),g=(e,t,n,r,o)=>e.tr(t,n,r,o),y=(e,t,n,r,o)=>e.ts(t,n,r,o),v=(e,t,n,r,o)=>e.tt(t,n,r,o),b="WORD",w="UWORD",x="ASCIINUMERICAL",k="ALPHANUMERICAL",_="LOCALHOST",S="UTLD",T="SCHEME",E="SLASH_SCHEME",C="OPENBRACE",A="CLOSEBRACE",O="OPENBRACKET",N="CLOSEBRACKET",M="OPENPAREN",I="CLOSEPAREN",R="OPENANGLEBRACKET",z="CLOSEANGLEBRACKET",P="FULLWIDTHLEFTPAREN",L="FULLWIDTHRIGHTPAREN",j="LEFTCORNERBRACKET",D="RIGHTCORNERBRACKET",$="LEFTWHITECORNERBRACKET",H="RIGHTWHITECORNERBRACKET",B="FULLWIDTHLESSTHAN",F="FULLWIDTHGREATERTHAN",U="AMPERSAND",V="APOSTROPHE",W="ASTERISK",q="BACKSLASH",J="BACKTICK",Y="CARET",G="COLON",K="COMMA",Z="DOLLAR",X="EQUALS",Q="EXCLAMATION",ee="HYPHEN",et="PERCENT",en="PIPE",er="PLUS",eo="POUND",ei="QUERY",es="QUOTE",ea="FULLWIDTHMIDDLEDOT",el="SEMI",eu="SLASH",ec="TILDE",ep="UNDERSCORE",ed="EMOJI";var eh=Object.freeze({__proto__:null,ALPHANUMERICAL:k,AMPERSAND:U,APOSTROPHE:V,ASCIINUMERICAL:x,ASTERISK:W,AT:"AT",BACKSLASH:q,BACKTICK:J,CARET:Y,CLOSEANGLEBRACKET:z,CLOSEBRACE:A,CLOSEBRACKET:N,CLOSEPAREN:I,COLON:G,COMMA:K,DOLLAR:Z,DOT:"DOT",EMOJI:ed,EQUALS:X,EXCLAMATION:Q,FULLWIDTHGREATERTHAN:F,FULLWIDTHLEFTPAREN:P,FULLWIDTHLESSTHAN:B,FULLWIDTHMIDDLEDOT:ea,FULLWIDTHRIGHTPAREN:L,HYPHEN:ee,LEFTCORNERBRACKET:j,LEFTWHITECORNERBRACKET:$,LOCALHOST:_,NL:"NL",NUM:"NUM",OPENANGLEBRACKET:R,OPENBRACE:C,OPENBRACKET:O,OPENPAREN:M,PERCENT:et,PIPE:en,PLUS:er,POUND:eo,QUERY:ei,QUOTE:es,RIGHTCORNERBRACKET:D,RIGHTWHITECORNERBRACKET:H,SCHEME:T,SEMI:el,SLASH:eu,SLASH_SCHEME:E,SYM:"SYM",TILDE:ec,TLD:"TLD",UNDERSCORE:ep,UTLD:S,UWORD:w,WORD:b,WS:"WS"});let ef=/[a-z]/,em=/\p{L}/u,eg=/\p{Emoji}/u,ey=/\d/,ev=/\s/,eb=null,ew=null;function ex(e,t){let n=function(e){let t=[],n=e.length,r=0;for(;r<n;){let o,i=e.charCodeAt(r),s=i<55296||i>56319||r+1===n||(o=e.charCodeAt(r+1))<56320||o>57343?e[r]:e.slice(r,r+2);t.push(s),r+=s.length}return t}(t.replace(/[A-Z]/g,e=>e.toLowerCase())),r=n.length,o=[],i=0,s=0;for(;s<r;){let a=e,l=null,u=0,c=null,p=-1,d=-1;for(;s<r&&(l=a.go(n[s]));)(a=l).accepts()?(p=0,d=0,c=a):p>=0&&(p+=n[s].length,d++),u+=n[s].length,i+=n[s].length,s++;i-=p,s-=d,u-=p,o.push({t:c.t,v:t.slice(i-u,i),s:i-u,e:i})}return o}function ek(e,t,n,r,o){let i;let s=t.length;for(let n=0;n<s-1;n++){let s=t[n];e.j[s]?i=e.j[s]:((i=new f(r)).jr=o.slice(),e.j[s]=i),e=i}return(i=new f(n)).jr=o.slice(),e.j[t[s-1]]=i,i}function e_(e){let t=[],n=[],r=0;for(;r<e.length;){let o=0;for(;"0123456789".indexOf(e[r+o])>=0;)o++;if(o>0){t.push(n.join(""));for(let t=parseInt(e.substring(r,r+o),10);t>0;t--)n.pop();r+=o}else n.push(e[r]),r++}return t}let eS={defaultProtocol:"http",events:null,format:eE,formatHref:eE,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function eT(e,t=null){let n=o({},eS);e&&(n=o(n,e instanceof eT?e.o:e));let r=n.ignoreTags,i=[];for(let e=0;e<r.length;e++)i.push(r[e].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=i}function eE(e){return e}function eC(e,t){this.t="token",this.v=e,this.tk=t}function eA(e,t){class n extends eC{constructor(t,n){super(t,n),this.t=e}}for(let e in t)n.prototype[e]=t[e];return n.t=e,n}eT.prototype={o:eS,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,n){let r=null!=t,o=this.o[e];return o&&("object"==typeof o?"function"==typeof(o=n.t in o?o[n.t]:eS[e])&&r&&(o=o(t,n)):"function"==typeof o&&r&&(o=o(t,n.t,n))),o},getObj(e,t,n){let r=this.o[e];return"function"==typeof r&&null!=t&&(r=r(t,n.t,n)),r},render(e){let t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}},eC.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){let t=this.toString(),n=e.get("truncate",t,this),r=e.get("format",t,this);return n&&r.length>n?r.substring(0,n)+"…":r},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=eS.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){let t=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",t,this),r=e.get("tagName",t,this),i=this.toFormattedString(e),s={},a=e.get("className",t,this),l=e.get("target",t,this),u=e.get("rel",t,this),c=e.getObj("attributes",t,this),p=e.getObj("events",t,this);return s.href=n,a&&(s.class=a),l&&(s.target=l),u&&(s.rel=u),c&&o(s,c),{tagName:r,attributes:s,content:i,eventListeners:p}}};let eO=eA("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),eN=eA("text"),eM=eA("nl"),eI=eA("url",{isLink:!0,toHref(e=eS.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){let e=this.tk;return e.length>=2&&e[0].t!==_&&e[1].t===G}}),eR=e=>new f(e);function ez(e,t,n){let r=n[0].s,o=n[n.length-1].e;return new e(t.slice(r,o),n)}let eP="undefined"!=typeof console&&console&&console.warn||(()=>{}),eL={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function ej(e,t=!1){if(eL.initialized&&eP(`linkifyjs: already initialized - will not register custom scheme "${e}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);eL.customSchemes.push([e,t])}function eD(e){return eL.initialized||function(){eL.scanner=function(e=[]){let t={};f.groups=t;let n=new f;null==eb&&(eb=e_("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xf6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==ew&&(ew=e_("ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2")),v(n,"'",V),v(n,"{",C),v(n,"}",A),v(n,"[",O),v(n,"]",N),v(n,"(",M),v(n,")",I),v(n,"<",R),v(n,">",z),v(n,"（",P),v(n,"）",L),v(n,"「",j),v(n,"」",D),v(n,"『",$),v(n,"』",H),v(n,"＜",B),v(n,"＞",F),v(n,"&",U),v(n,"*",W),v(n,"@","AT"),v(n,"`",J),v(n,"^",Y),v(n,":",G),v(n,",",K),v(n,"$",Z),v(n,".","DOT"),v(n,"=",X),v(n,"!",Q),v(n,"-",ee),v(n,"%",et),v(n,"|",en),v(n,"+",er),v(n,"#",eo),v(n,"?",ei),v(n,'"',es),v(n,"/",eu),v(n,";",el),v(n,"~",ec),v(n,"_",ep),v(n,"\\",q),v(n,"・",ea);let r=g(n,ey,"NUM",{[i]:!0});g(r,ey,r);let m=g(r,ef,x,{[l]:!0}),ex=g(r,em,k,{[u]:!0}),eS=g(n,ef,b,{[s]:!0});g(eS,ey,m),g(eS,ef,eS),g(m,ey,m),g(m,ef,m);let eT=g(n,em,w,{[a]:!0});g(eT,ef),g(eT,ey,ex),g(eT,em,eT),g(ex,ey,ex),g(ex,ef),g(ex,em,ex);let eE=v(n,"\n","NL",{[d]:!0}),eC=v(n,"\r","WS",{[d]:!0}),eA=g(n,ev,"WS",{[d]:!0});v(n,"￼",eA),v(eC,"\n",eE),v(eC,"￼",eA),g(eC,ev,eA),v(eA,"\r"),v(eA,"\n"),g(eA,ev,eA),v(eA,"￼",eA);let eO=g(n,eg,ed,{[p]:!0});v(eO,"#"),g(eO,eg,eO),v(eO,"️",eO);let eN=v(eO,"‍");v(eN,"#"),g(eN,eg,eO);let eM=[[ef,eS],[ey,m]],eI=[[ef,null],[em,eT],[ey,ex]];for(let e=0;e<eb.length;e++)ek(n,eb[e],"TLD",b,eM);for(let e=0;e<ew.length;e++)ek(n,ew[e],S,w,eI);h("TLD",{tld:!0,ascii:!0},t),h(S,{utld:!0,alpha:!0},t),ek(n,"file",T,b,eM),ek(n,"mailto",T,b,eM),ek(n,"http",E,b,eM),ek(n,"https",E,b,eM),ek(n,"ftp",E,b,eM),ek(n,"ftps",E,b,eM),h(T,{scheme:!0,ascii:!0},t),h(E,{slashscheme:!0,ascii:!0},t),e=e.sort((e,t)=>e[0]>t[0]?1:-1);for(let t=0;t<e.length;t++){let r=e[t][0],o=e[t][1]?{scheme:!0}:{slashscheme:!0};r.indexOf("-")>=0?o[c]=!0:ef.test(r)?ey.test(r)?o[l]=!0:o[s]=!0:o[i]=!0,y(n,r,r,o)}return y(n,"localhost",_,{ascii:!0}),n.jd=new f("SYM"),{start:n,tokens:o({groups:t},eh)}}(eL.customSchemes);for(let e=0;e<eL.tokenQueue.length;e++)eL.tokenQueue[e][1]({scanner:eL.scanner});eL.parser=function({groups:e}){let t=e.domain.concat([U,W,"AT",q,J,Y,Z,X,ee,"NUM",et,en,er,eo,eu,"SYM",ec,ep]),n=[V,G,K,"DOT",Q,et,ei,es,el,R,z,C,A,N,O,M,I,P,L,j,D,$,H,B,F],r=[U,V,W,q,J,Y,Z,X,ee,C,A,et,en,er,eo,ei,eu,"SYM",ec,ep],o=eR(),i=v(o,ec);m(i,r,i),m(i,e.domain,i);let s=eR(),a=eR(),l=eR();m(o,e.domain,s),m(o,e.scheme,a),m(o,e.slashscheme,l),m(s,r,i),m(s,e.domain,s);let u=v(s,"AT");v(i,"AT",u),v(a,"AT",u),v(l,"AT",u);let c=v(i,"DOT");m(c,r,i),m(c,e.domain,i);let p=eR();m(u,e.domain,p),m(p,e.domain,p);let d=v(p,"DOT");m(d,e.domain,p);let h=eR(eO);m(d,e.tld,h),m(d,e.utld,h),v(u,_,h);let f=v(p,ee);v(f,ee,f),m(f,e.domain,p),m(h,e.domain,p),v(h,"DOT",d),v(h,ee,f),m(v(h,G),e.numeric,eO);let g=v(s,ee),y=v(s,"DOT");v(g,ee,g),m(g,e.domain,s),m(y,r,i),m(y,e.domain,s);let b=eR(eI);m(y,e.tld,b),m(y,e.utld,b),m(b,e.domain,s),m(b,r,i),v(b,"DOT",y),v(b,ee,g),v(b,"AT",u);let w=v(b,G),x=eR(eI);m(w,e.numeric,x);let k=eR(eI),S=eR();m(k,t,k),m(k,n,S),m(S,t,k),m(S,n,S),v(b,eu,k),v(x,eu,k);let T=v(a,G),E=v(l,G),ea=v(E,eu),ed=v(ea,eu);m(a,e.domain,s),v(a,"DOT",y),v(a,ee,g),m(l,e.domain,s),v(l,"DOT",y),v(l,ee,g),m(T,e.domain,k),v(T,eu,k),v(T,ei,k),m(ed,e.domain,k),m(ed,t,k),v(ed,eu,k);let ef=[[C,A],[O,N],[M,I],[R,z],[P,L],[j,D],[$,H],[B,F]];for(let e=0;e<ef.length;e++){let[r,o]=ef[e],i=v(k,r);v(S,r,i),v(i,o,k);let s=eR(eI);m(i,t,s);let a=eR();m(i,n),m(s,t,s),m(s,n,a),m(a,t,s),m(a,n,a),v(s,o,k),v(a,o,k)}return v(o,_,b),v(o,"NL",eM),{start:o,tokens:eh}}(eL.scanner.tokens);for(let e=0;e<eL.pluginQueue.length;e++)eL.pluginQueue[e][1]({scanner:eL.scanner,parser:eL.parser});eL.initialized=!0}(),function(e,t,n){let r=n.length,o=0,i=[],s=[];for(;o<r;){let a=e,l=null,u=null,c=0,p=null,d=-1;for(;o<r&&!(l=a.go(n[o].t));)s.push(n[o++]);for(;o<r&&(u=l||a.go(n[o].t));)l=null,(a=u).accepts()?(d=0,p=a):d>=0&&d++,o++,c++;if(d<0)(o-=c)<r&&(s.push(n[o]),o++);else{s.length>0&&(i.push(ez(eN,t,s)),s=[]),o-=d,c-=d;let e=p.t,r=n.slice(o-c,o);i.push(ez(e,t,r))}}return s.length>0&&i.push(ez(eN,t,s)),i}(eL.parser.start,e,ex(eL.scanner.start,e))}function e$(e,t=null,n=null){if(t&&"object"==typeof t){if(n)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);n=t,t=null}let r=new eT(n),o=eD(e),i=[];for(let e=0;e<o.length;e++){let n=o[e];n.isLink&&(!t||n.t===t)&&r.check(n)&&i.push(n.toFormattedObject(r))}return i}eD.scan=ex;var eH=n(2376);let eB=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function eF(e,t){let n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(e=>{let t="string"==typeof e?e:e.scheme;t&&n.push(t)}),!e||e.replace(eB,"").match(RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}let eU=r.vc.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if("string"==typeof e){ej(e);return}ej(e.scheme,e.optionalSlashes)})},onDestroy(){f.groups={},eL.scanner=null,eL.parser=null,eL.tokenQueue=[],eL.pluginQueue=[],eL.customSchemes=[],eL.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!eF(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}),addAttributes(){return{href:{default:null,parseHTML:e=>e.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{let t=e.getAttribute("href");return!!(t&&this.options.isAllowedUri(t,{defaultValidate:e=>!!eF(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:e=>!!eF(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",(0,r.P1)(this.options.HTMLAttributes,e),0]:["a",(0,r.P1)(this.options.HTMLAttributes,{...e,href:""}),0]},addCommands(){return{setLink:e=>({chain:t})=>{let{href:n}=e;return!!this.options.isAllowedUri(n,{defaultValidate:e=>!!eF(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&t().setMark(this.name,e).setMeta("preventAutolink",!0).run()},toggleLink:e=>({chain:t})=>{let{href:n}=e;return!!this.options.isAllowedUri(n,{defaultValidate:e=>!!eF(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[(0,r.K9)({find:e=>{let t=[];if(e){let{protocols:n,defaultProtocol:r}=this.options,o=e$(e).filter(e=>e.isLink&&this.options.isAllowedUri(e.value,{defaultValidate:e=>!!eF(e,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(e=>t.push({text:e.value,data:{href:e.href},index:e.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:null===(t=e.data)||void 0===t?void 0:t.href}}})]},addProseMirrorPlugins(){var e,t,n;let o=[],{protocols:i,defaultProtocol:s}=this.options;return this.options.autolink&&o.push((e={type:this.type,defaultProtocol:this.options.defaultProtocol,validate:e=>this.options.isAllowedUri(e,{defaultValidate:e=>!!eF(e,i),protocols:i,defaultProtocol:s}),shouldAutoLink:this.options.shouldAutoLink},new eH.Sy({key:new eH.H$("autolink"),appendTransaction:(t,n,o)=>{let i=t.some(e=>e.docChanged)&&!n.doc.eq(o.doc),s=t.some(e=>e.getMeta("preventAutolink"));if(!i||s)return;let{tr:a}=o,l=(0,r.XP)(n.doc,[...t]);if((0,r.QC)(l).forEach(({newRange:t})=>{let n,i;let s=(0,r.b5)(o.doc,t,e=>e.isTextblock);if(s.length>1?(n=s[0],i=o.doc.textBetween(n.pos,n.pos+n.node.nodeSize,void 0," ")):s.length&&o.doc.textBetween(t.from,t.to," "," ").endsWith(" ")&&(n=s[0],i=o.doc.textBetween(n.pos,t.to,void 0," ")),n&&i){let t=i.split(" ").filter(e=>""!==e);if(t.length<=0)return!1;let s=t[t.length-1],l=n.pos+i.lastIndexOf(s);if(!s)return!1;let u=eD(s).map(t=>t.toObject(e.defaultProtocol));if(!(1===u.length?u[0].isLink:3===u.length&&!!u[1].isLink&&["()","[]"].includes(u[0].value+u[2].value)))return!1;u.filter(e=>e.isLink).map(e=>({...e,from:l+e.start+1,to:l+e.end+1})).filter(e=>!o.schema.marks.code||!o.doc.rangeHasMark(e.from,e.to,o.schema.marks.code)).filter(t=>e.validate(t.value)).filter(t=>e.shouldAutoLink(t.value)).forEach(t=>{(0,r.tI)(t.from,t.to,o.doc).some(t=>t.mark.type===e.type)||a.addMark(t.from,t.to,e.type.create({href:t.href}))})}}),a.steps.length)return a}}))),!0===this.options.openOnClick&&o.push((t={type:this.type},new eH.Sy({key:new eH.H$("handleClickLink"),props:{handleClick:(e,n,o)=>{var i,s;if(0!==o.button||!e.editable)return!1;let a=o.target,l=[];for(;"DIV"!==a.nodeName;)l.push(a),a=a.parentNode;if(!l.find(e=>"A"===e.nodeName))return!1;let u=(0,r.u9)(e.state,t.type.name),c=o.target,p=null!==(i=null==c?void 0:c.href)&&void 0!==i?i:u.href,d=null!==(s=null==c?void 0:c.target)&&void 0!==s?s:u.target;return!!c&&!!p&&(window.open(p,d),!0)}}}))),this.options.linkOnPaste&&o.push((n={editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type},new eH.Sy({key:new eH.H$("handlePasteLink"),props:{handlePaste:(e,t,r)=>{let{state:o}=e,{selection:i}=o,{empty:s}=i;if(s)return!1;let a="";r.content.forEach(e=>{a+=e.textContent});let l=e$(a,{defaultProtocol:n.defaultProtocol}).find(e=>e.isLink&&e.value===a);return!!a&&!!l&&n.editor.commands.setMark(n.type,{href:l.href})}}}))),o}})},658:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5865);let o=r.NB.create({name:"tableCell",addOptions:()=>({HTMLAttributes:{}}),content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?t.split(",").map(e=>parseInt(e,10)):null}}}),tableRole:"cell",isolating:!0,parseHTML:()=>[{tag:"td"}],renderHTML({HTMLAttributes:e}){return["td",(0,r.P1)(this.options.HTMLAttributes,e),0]}})},43626:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5865);let o=r.NB.create({name:"tableHeader",addOptions:()=>({HTMLAttributes:{}}),content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?t.split(",").map(e=>parseInt(e,10)):null}}}),tableRole:"header_cell",isolating:!0,parseHTML:()=>[{tag:"th"}],renderHTML({HTMLAttributes:e}){return["th",(0,r.P1)(this.options.HTMLAttributes,e),0]}})},33991:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5865);let o=r.NB.create({name:"tableRow",addOptions:()=>({HTMLAttributes:{}}),content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML:()=>[{tag:"tr"}],renderHTML({HTMLAttributes:e}){return["tr",(0,r.P1)(this.options.HTMLAttributes,e),0]}})},60363:function(e,t,n){"use strict";n.d(t,{ZP:function(){return ep}});var r,o,i=n(5865),s=n(2376),a=n(12806),l=n(84348),u=n(82696),c=n(16560);if("undefined"!=typeof WeakMap){let e=new WeakMap;r=t=>e.get(t),o=(t,n)=>(e.set(t,n),n)}else{let e=[],t=0;r=t=>{for(let n=0;n<e.length;n+=2)if(e[n]==t)return e[n+1]},o=(n,r)=>(10==t&&(t=0),e[t++]=n,e[t++]=r)}var p=class{constructor(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r}findCell(e){for(let t=0;t<this.map.length;t++){let n=this.map[t];if(n!=e)continue;let r=t%this.width,o=t/this.width|0,i=r+1,s=o+1;for(let e=1;i<this.width&&this.map[t+e]==n;e++)i++;for(let e=1;s<this.height&&this.map[t+this.width*e]==n;e++)s++;return{left:r,top:o,right:i,bottom:s}}throw RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw RangeError(`No cell with offset ${e} found`)}nextCell(e,t,n){let{left:r,right:o,top:i,bottom:s}=this.findCell(e);return"horiz"==t?(n<0?0==r:o==this.width)?null:this.map[i*this.width+(n<0?r-1:o)]:(n<0?0==i:s==this.height)?null:this.map[r+this.width*(n<0?i-1:s)]}rectBetween(e,t){let{left:n,right:r,top:o,bottom:i}=this.findCell(e),{left:s,right:a,top:l,bottom:u}=this.findCell(t);return{left:Math.min(n,s),top:Math.min(o,l),right:Math.max(r,a),bottom:Math.max(i,u)}}cellsInRect(e){let t=[],n={};for(let r=e.top;r<e.bottom;r++)for(let o=e.left;o<e.right;o++){let i=r*this.width+o,s=this.map[i];if(!n[s]){if(n[s]=!0,o==e.left&&o&&this.map[i-1]==s||r==e.top&&r&&this.map[i-this.width]==s)continue;t.push(s)}}return t}positionAt(e,t,n){for(let r=0,o=0;;r++){let i=o+n.child(r).nodeSize;if(r==e){let n=t+e*this.width,r=(e+1)*this.width;for(;n<r&&this.map[n]<o;)n++;return n==r?i-1:this.map[n]}o=i}}static get(e){return r(e)||o(e,function(e){if("table"!=e.type.spec.tableRole)throw RangeError("Not a table node: "+e.type.name);let t=function(e){let t=-1,n=!1;for(let r=0;r<e.childCount;r++){let o=e.child(r),i=0;if(n)for(let t=0;t<r;t++){let n=e.child(t);for(let e=0;e<n.childCount;e++){let o=n.child(e);t+o.attrs.rowspan>r&&(i+=o.attrs.colspan)}}for(let e=0;e<o.childCount;e++){let t=o.child(e);i+=t.attrs.colspan,t.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[],o=0,i=null,s=[];for(let e=0,o=t*n;e<o;e++)r[e]=0;for(let a=0,l=0;a<n;a++){let u=e.child(a);l++;for(let e=0;;e++){for(;o<r.length&&0!=r[o];)o++;if(e==u.childCount)break;let c=u.child(e),{colspan:p,rowspan:d,colwidth:h}=c.attrs;for(let e=0;e<d;e++){if(e+a>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:l,n:d-e});break}let u=o+e*t;for(let e=0;e<p;e++){0==r[u+e]?r[u+e]=l:(i||(i=[])).push({type:"collision",row:a,pos:l,n:p-e});let n=h&&h[e];if(n){let r=(u+e)%t*2,o=s[r];null==o||o!=n&&1==s[r+1]?(s[r]=n,s[r+1]=1):o==n&&s[r+1]++}}}o+=p,l+=c.nodeSize}let c=(a+1)*t,p=0;for(;o<c;)0==r[o++]&&p++;p&&(i||(i=[])).push({type:"missing",row:a,n:p}),l++}(0===t||0===n)&&(i||(i=[])).push({type:"zero_sized"});let a=new p(t,n,r,i),l=!1;for(let e=0;!l&&e<s.length;e+=2)null!=s[e]&&s[e+1]<n&&(l=!0);return l&&function(e,t,n){e.problems||(e.problems=[]);let r={};for(let o=0;o<e.map.length;o++){let i=e.map[o];if(r[i])continue;r[i]=!0;let s=n.nodeAt(i);if(!s)throw RangeError(`No cell with offset ${i} found`);let a=null,l=s.attrs;for(let n=0;n<l.colspan;n++){let r=t[(o+n)%e.width*2];null==r||l.colwidth&&l.colwidth[n]==r||((a||(a=function(e){if(e.colwidth)return e.colwidth.slice();let t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}(l)))[n]=r)}a&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}(a,s,e),a}(e))}};function d(e){let t=e.cached.tableNodeTypes;if(!t)for(let n in t=e.cached.tableNodeTypes={},e.nodes){let r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}return t}var h=new s.H$("selectingCells");function f(e){for(let t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function m(e){let t=e.selection.$head;for(let e=t.depth;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return!0;return!1}function g(e){let t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&"cell"==t.node.type.spec.tableRole)return t.$anchor;let n=f(t.$head)||function(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n-t.nodeSize)}}(t.$head);if(n)return n;throw RangeError(`No cell found around position ${t.head}`)}function y(e){return"row"==e.parent.type.spec.tableRole&&!!e.nodeAfter}function v(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function b(e,t,n){let r=e.node(-1),o=p.get(r),i=e.start(-1),s=o.nextCell(e.pos-i,t,n);return null==s?null:e.node(0).resolve(i+s)}function w(e,t,n=1){let r={...e,colspan:e.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some(e=>e>0)||(r.colwidth=null)),r}function x(e,t,n=1){let r={...e,colspan:e.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let e=0;e<n;e++)r.colwidth.splice(t,0,0)}return r}var k=class e extends s.Y1{constructor(e,t=e){let n=e.node(-1),r=p.get(n),o=e.start(-1),i=r.rectBetween(e.pos-o,t.pos-o),a=e.node(0),l=r.cellsInRect(i).filter(e=>e!=t.pos-o);l.unshift(t.pos-o);let u=l.map(e=>{let t=n.nodeAt(e);if(!t)throw RangeError(`No cell with offset ${e} found`);let r=o+e+1;return new s.xm(a.resolve(r),a.resolve(r+t.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=e,this.$headCell=t}map(t,n){let r=t.resolve(n.map(this.$anchorCell.pos)),o=t.resolve(n.map(this.$headCell.pos));if(y(r)&&y(o)&&v(r,o)){let t=this.$anchorCell.node(-1)!=r.node(-1);return t&&this.isRowSelection()?e.rowSelection(r,o):t&&this.isColSelection()?e.colSelection(r,o):new e(r,o)}return s.Bs.between(r,o)}content(){let e=this.$anchorCell.node(-1),t=p.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[];for(let n=r.top;n<r.bottom;n++){let s=[];for(let i=n*t.width+r.left,a=r.left;a<r.right;a++,i++){let n=t.map[i];if(o[n])continue;o[n]=!0;let a=t.findCell(n),l=e.nodeAt(n);if(!l)throw RangeError(`No cell with offset ${n} found`);let u=r.left-a.left,c=a.right-r.right;if(u>0||c>0){let e=l.attrs;if(u>0&&(e=w(e,0,u)),c>0&&(e=w(e,e.colspan-c,c)),a.left<r.left){if(!(l=l.type.createAndFill(e)))throw RangeError(`Could not create cell with attrs ${JSON.stringify(e)}`)}else l=l.type.create(e,l.content)}if(a.top<r.top||a.bottom>r.bottom){let e={...l.attrs,rowspan:Math.min(a.bottom,r.bottom)-Math.max(a.top,r.top)};l=a.top<r.top?l.type.createAndFill(e):l.type.create(e,l.content)}s.push(l)}i.push(e.child(n).copy(a.HY.from(s)))}let s=this.isColSelection()&&this.isRowSelection()?e:i;return new a.p2(a.HY.from(s),1,1)}replace(e,t=a.p2.empty){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],l=e.mapping.slice(n);e.replace(l.map(i.pos),l.map(s.pos),o?a.p2.empty:t)}let o=s.Y1.findFrom(e.doc.resolve(e.mapping.slice(n).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new a.p2(a.HY.from(t),0,0))}forEachCell(e){let t=this.$anchorCell.node(-1),n=p.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let n=0;n<o.length;n++)e(t.nodeAt(o[n]),r+o[n])}isColSelection(){let e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);return!(Math.min(e,t)>0)&&Math.max(e+this.$anchorCell.nodeAfter.attrs.rowspan,t+this.$headCell.nodeAfter.attrs.rowspan)==this.$headCell.node(-1).childCount}static colSelection(t,n=t){let r=t.node(-1),o=p.get(r),i=t.start(-1),s=o.findCell(t.pos-i),a=o.findCell(n.pos-i),l=t.node(0);return s.top<=a.top?(s.top>0&&(t=l.resolve(i+o.map[s.left])),a.bottom<o.height&&(n=l.resolve(i+o.map[o.width*(o.height-1)+a.right-1]))):(a.top>0&&(n=l.resolve(i+o.map[a.left])),s.bottom<o.height&&(t=l.resolve(i+o.map[o.width*(o.height-1)+s.right-1]))),new e(t,n)}isRowSelection(){let e=this.$anchorCell.node(-1),t=p.get(e),n=this.$anchorCell.start(-1),r=t.colCount(this.$anchorCell.pos-n),o=t.colCount(this.$headCell.pos-n);return!(Math.min(r,o)>0)&&Math.max(r+this.$anchorCell.nodeAfter.attrs.colspan,o+this.$headCell.nodeAfter.attrs.colspan)==t.width}eq(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,n=t){let r=t.node(-1),o=p.get(r),i=t.start(-1),s=o.findCell(t.pos-i),a=o.findCell(n.pos-i),l=t.node(0);return s.left<=a.left?(s.left>0&&(t=l.resolve(i+o.map[s.top*o.width])),a.right<o.width&&(n=l.resolve(i+o.map[o.width*(a.top+1)-1]))):(a.left>0&&(n=l.resolve(i+o.map[a.top*o.width])),s.right<o.width&&(t=l.resolve(i+o.map[o.width*(s.top+1)-1]))),new e(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,n){return new e(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,r=n){return new e(t.resolve(n),t.resolve(r))}getBookmark(){return new _(this.$anchorCell.pos,this.$headCell.pos)}};k.prototype.visible=!1,s.Y1.jsonID("cell",k);var _=class e{constructor(e,t){this.anchor=e,this.head=t}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(e){let t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&v(t,n)?new k(t,n):s.Y1.near(n,1)}};function S(e){if(!(e.selection instanceof k))return null;let t=[];return e.selection.forEachCell((e,n)=>{t.push(l.p.node(n,n+e.nodeSize,{class:"selectedCell"}))}),l.EH.create(e.doc,t)}var T=new s.H$("fix-tables");function E(e,t){let n;let r=(t,r)=>{"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){let o,i;let s=p.get(t);if(!s.problems)return r;r||(r=e.tr);let a=[];for(let e=0;e<s.height;e++)a.push(0);for(let e=0;e<s.problems.length;e++){let o=s.problems[e];if("collision"==o.type){let e=t.nodeAt(o.pos);if(!e)continue;let i=e.attrs;for(let e=0;e<i.rowspan;e++)a[o.row+e]+=o.n;r.setNodeMarkup(r.mapping.map(n+1+o.pos),null,w(i,i.colspan-o.n,o.n))}else if("missing"==o.type)a[o.row]+=o.n;else if("overlong_rowspan"==o.type){let e=t.nodeAt(o.pos);if(!e)continue;r.setNodeMarkup(r.mapping.map(n+1+o.pos),null,{...e.attrs,rowspan:e.attrs.rowspan-o.n})}else if("colwidth mismatch"==o.type){let e=t.nodeAt(o.pos);if(!e)continue;r.setNodeMarkup(r.mapping.map(n+1+o.pos),null,{...e.attrs,colwidth:o.colwidth})}else if("zero_sized"==o.type){let e=r.mapping.map(n);r.delete(e,e+t.nodeSize)}}for(let e=0;e<a.length;e++)a[e]&&(null==o&&(o=e),i=e);for(let l=0,u=n+1;l<s.height;l++){let n=t.child(l),s=u+n.nodeSize,c=a[l];if(c>0){let t="cell";n.firstChild&&(t=n.firstChild.type.spec.tableRole);let a=[];for(let n=0;n<c;n++){let n=d(e.schema)[t].createAndFill();n&&a.push(n)}let p=(0==l||o==l-1)&&i==l?u+1:s-1;r.insert(r.mapping.map(p),a)}u=s}return r.setMeta(T,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&function e(t,n,r,o){let i=t.childCount,s=n.childCount;e:for(let a=0,l=0;a<s;a++){let s=n.child(a);for(let e=l,n=Math.min(i,a+3);e<n;e++)if(t.child(e)==s){l=e+1,r+=s.nodeSize;continue e}o(s,r),l<i&&t.child(l).sameMarkup(s)?e(t.child(l),s,r+1,o):s.nodesBetween(0,s.content.size,o,r+1),r+=s.nodeSize}}(t.doc,e.doc,0,r):e.doc.descendants(r),n}function C(e){let t=e.selection,n=g(e),r=n.node(-1),o=n.start(-1),i=p.get(r);return{...t instanceof k?i.rectBetween(t.$anchorCell.pos-o,t.$headCell.pos-o):i.findCell(n.pos-o),tableStart:o,map:i,table:r}}function A(e,{map:t,tableStart:n,table:r},o){let i=o>0?-1:0;(function(e,t,n){let r=d(t.type.schema).header_cell;for(let o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(t,r,o+i)&&(i=0==o||o==t.width?null:0);for(let s=0;s<t.height;s++){let a=s*t.width+o;if(o>0&&o<t.width&&t.map[a-1]==t.map[a]){let i=t.map[a],l=r.nodeAt(i);e.setNodeMarkup(e.mapping.map(n+i),null,x(l.attrs,o-t.colCount(i))),s+=l.attrs.rowspan-1}else{let l=null==i?d(r.type.schema).cell:r.nodeAt(t.map[a+i]).type,u=t.positionAt(s,o,r);e.insert(e.mapping.map(n+u),l.createAndFill())}}return e}function O(e,{map:t,tableStart:n,table:r},o){var i;let s=n;for(let e=0;e<o;e++)s+=r.child(e).nodeSize;let a=[],l=o>0?-1:0;(function(e,t,n){var r;let o=d(t.type.schema).header_cell;for(let i=0;i<e.width;i++)if((null==(r=t.nodeAt(e.map[i+n*e.width]))?void 0:r.type)!=o)return!1;return!0})(t,r,o+l)&&(l=0==o||o==t.height?null:0);for(let s=0,u=t.width*o;s<t.width;s++,u++)if(o>0&&o<t.height&&t.map[u]==t.map[u-t.width]){let o=t.map[u],i=r.nodeAt(o).attrs;e.setNodeMarkup(n+o,null,{...i,rowspan:i.rowspan+1}),s+=i.colspan-1}else{let e=null==l?d(r.type.schema).cell:null==(i=r.nodeAt(t.map[u+l*t.width]))?void 0:i.type,n=null==e?void 0:e.createAndFill();n&&a.push(n)}return e.insert(s,d(r.type.schema).row.create(null,a)),e}function N(e){let t=e.content;return 1==t.childCount&&t.child(0).isTextblock&&0==t.child(0).childCount}function M(e,t){let n=e.selection;if(!(n instanceof k)||n.$anchorCell.pos==n.$headCell.pos)return!1;let r=C(e),{map:o}=r;if(function({width:e,height:t,map:n},r){let o=r.top*e+r.left,i=o,s=(r.bottom-1)*e+r.left,a=o+(r.right-r.left-1);for(let t=r.top;t<r.bottom;t++){if(r.left>0&&n[i]==n[i-1]||r.right<e&&n[a]==n[a+1])return!0;i+=e,a+=e}for(let i=r.left;i<r.right;i++){if(r.top>0&&n[o]==n[o-e]||r.bottom<t&&n[s]==n[s+e])return!0;o++,s++}return!1}(o,r))return!1;if(t){let n,i;let s=e.tr,l={},u=a.HY.empty;for(let e=r.top;e<r.bottom;e++)for(let t=r.left;t<r.right;t++){let a=o.map[e*o.width+t],c=r.table.nodeAt(a);if(!l[a]&&c){if(l[a]=!0,null==n)n=a,i=c;else{N(c)||(u=u.append(c.content));let e=s.mapping.map(a+r.tableStart);s.delete(e,e+c.nodeSize)}}}if(null==n||null==i)return!0;if(s.setNodeMarkup(n+r.tableStart,null,{...x(i.attrs,i.attrs.colspan,r.right-r.left-i.attrs.colspan),rowspan:r.bottom-r.top}),u.size){let e=n+1+i.content.size,t=N(i)?n+1:e;s.replaceWith(t+r.tableStart,e+r.tableStart,u)}s.setSelection(new k(s.doc.resolve(n+r.tableStart))),t(s)}return!0}function I(e,t){var n;let r=d(e.schema);return(n=({node:e})=>r[e.type.spec.tableRole],(e,t)=>{var r;let o,i;let s=e.selection;if(s instanceof k){if(s.$anchorCell.pos!=s.$headCell.pos)return!1;o=s.$anchorCell.nodeAfter,i=s.$anchorCell.pos}else{if(!(o=function(e){for(let t=e.depth;t>0;t--){let n=e.node(t).type.spec.tableRole;if("cell"===n||"header_cell"===n)return e.node(t)}return null}(s.$from)))return!1;i=null==(r=f(s.$from))?void 0:r.pos}if(null==o||null==i||1==o.attrs.colspan&&1==o.attrs.rowspan)return!1;if(t){let r,a=o.attrs,l=[],u=a.colwidth;a.rowspan>1&&(a={...a,rowspan:1}),a.colspan>1&&(a={...a,colspan:1});let c=C(e),p=e.tr;for(let e=0;e<c.right-c.left;e++)l.push(u?{...a,colwidth:u&&u[e]?[u[e]]:null}:a);for(let e=c.top;e<c.bottom;e++){let t=c.map.positionAt(e,c.left,c.table);e==c.top&&(t+=o.nodeSize);for(let i=c.left,s=0;i<c.right;i++,s++)(i!=c.left||e!=c.top)&&p.insert(r=p.mapping.map(t+c.tableStart,1),n({node:o,row:e,col:i}).createAndFill(l[s]))}p.setNodeMarkup(i,n({node:o,row:c.top,col:c.left}),l[0]),s instanceof k&&p.setSelection(new k(p.doc.resolve(s.$anchorCell.pos),r?p.doc.resolve(r):void 0)),t(p)}return!0})(e,t)}function R(e,t,n){let r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1});for(let e=0;e<r.length;e++){let o=t.table.nodeAt(r[e]);if(o&&o.type!==n.header_cell)return!1}return!0}function z(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(t,n){if(!m(t))return!1;if(n){let r=d(t.schema),o=C(t),i=t.tr,s=o.map.cellsInRect("column"==e?{left:o.left,top:0,right:o.right,bottom:o.map.height}:"row"==e?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),a=s.map(e=>o.table.nodeAt(e));for(let e=0;e<s.length;e++)a[e].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[e],r.cell,a[e].attrs);if(0==i.steps.length)for(let e=0;e<s.length;e++)i.setNodeMarkup(o.tableStart+s[e],r.header_cell,a[e].attrs);n(i)}return!0}:function(t,n){if(!m(t))return!1;if(n){let r=d(t.schema),o=C(t),i=t.tr,s=R("row",o,r),a=R("column",o,r),l=("column"===e?s:"row"===e&&a)?1:0,u="column"==e?{left:0,top:l,right:1,bottom:o.map.height}:"row"==e?{left:l,top:0,right:o.map.width,bottom:1}:o,c="column"==e?a?r.cell:r.header_cell:"row"==e?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(u).forEach(e=>{let t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,c,n.attrs)}),n(i)}return!0}}z("row",{useDeprecatedLogic:!0}),z("column",{useDeprecatedLogic:!0});var P=z("cell",{useDeprecatedLogic:!0});function L(e){return function(t,n){if(!m(t))return!1;let r=function(e,t){if(t<0){let t=e.nodeBefore;if(t)return e.pos-t.nodeSize;for(let t=e.index(-1)-1,n=e.before();t>=0;t--){let r=e.node(-1).child(t),o=r.lastChild;if(o)return n-1-o.nodeSize;n-=r.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;let t=e.node(-1);for(let n=e.indexAfter(-1),r=e.after();n<t.childCount;n++){let e=t.child(n);if(e.childCount)return r+1;r+=e.nodeSize}}return null}(g(t),e);if(null==r)return!1;if(n){let e=t.doc.resolve(r);n(t.tr.setSelection(s.Bs.between(e,e.node(0).resolve(e.pos+e.nodeAfter.nodeSize))).scrollIntoView())}return!0}}function j(e,t){let n=e.selection;if(!(n instanceof k))return!1;if(t){let r=e.tr,o=d(e.schema).cell.createAndFill().content;n.forEachCell((e,t)=>{e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new a.p2(o,0,0))}),r.docChanged&&t(r)}return!0}function D(e,t){let n=e.createAndFill();return new c.wx(n).replace(0,n.content.size,t).doc}function $(e,t,n,r,o,i,s,a){if(0==s||s==t.height)return!1;let l=!1;for(let u=o;u<i;u++){let o=s*t.width+u,i=t.map[o];if(t.map[o-t.width]==i){l=!0;let o=n.nodeAt(i),{top:c,left:p}=t.findCell(i);e.setNodeMarkup(e.mapping.slice(a).map(i+r),null,{...o.attrs,rowspan:s-c}),e.insert(e.mapping.slice(a).map(t.positionAt(s,p,n)),o.type.createAndFill({...o.attrs,rowspan:c+o.attrs.rowspan-s})),u+=o.attrs.colspan-1}}return l}function H(e,t,n,r,o,i,s,a){if(0==s||s==t.width)return!1;let l=!1;for(let u=o;u<i;u++){let o=u*t.width+s,i=t.map[o];if(t.map[o-1]==i){l=!0;let o=n.nodeAt(i),c=t.colCount(i),p=e.mapping.slice(a).map(i+r);e.setNodeMarkup(p,null,w(o.attrs,s-c,o.attrs.colspan-(s-c))),e.insert(p+o.nodeSize,o.type.createAndFill(w(o.attrs,0,s-c))),u+=o.attrs.rowspan-1}}return l}function B(e,t,n,r,o){let i=n?e.doc.nodeAt(n-1):e.doc;if(!i)throw Error("No table found");let s=p.get(i),{top:l,left:u}=r,c=u+o.width,h=l+o.height,f=e.tr,m=0;function g(){if(!(i=n?f.doc.nodeAt(n-1):f.doc))throw Error("No table found");s=p.get(i),m=f.mapping.maps.length}(function(e,t,n,r,o,i,s){let l,u;let c=d(e.doc.type.schema);if(o>t.width)for(let i=0,a=0;i<t.height;i++){let p;let d=n.child(i);a+=d.nodeSize;let h=[];p=null==d.lastChild||d.lastChild.type==c.cell?l||(l=c.cell.createAndFill()):u||(u=c.header_cell.createAndFill());for(let e=t.width;e<o;e++)h.push(p);e.insert(e.mapping.slice(s).map(a-1+r),h)}if(i>t.height){let p=[];for(let e=0,r=(t.height-1)*t.width;e<Math.max(t.width,o);e++){let o=!(e>=t.width)&&n.nodeAt(t.map[r+e]).type==c.header_cell;p.push(o?u||(u=c.header_cell.createAndFill()):l||(l=c.cell.createAndFill()))}let d=c.row.create(null,a.HY.from(p)),h=[];for(let e=t.height;e<i;e++)h.push(d);e.insert(e.mapping.slice(s).map(r+n.nodeSize-2),h)}return!!(l||u)})(f,s,i,n,c,h,0)&&g(),$(f,s,i,n,u,c,l,m)&&g(),$(f,s,i,n,u,c,h,m)&&g(),H(f,s,i,n,l,h,u,m)&&g(),H(f,s,i,n,l,h,c,m)&&g();for(let e=l;e<h;e++){let t=s.positionAt(e,u,i),r=s.positionAt(e,c,i);f.replace(f.mapping.slice(m).map(t+n),f.mapping.slice(m).map(r+n),new a.p2(o.rows[e-l],0,0))}g(),f.setSelection(new k(f.doc.resolve(n+s.positionAt(l,u,i)),f.doc.resolve(n+s.positionAt(h-1,c-1,i)))),t(f)}var F=(0,u.$)({ArrowLeft:V("horiz",-1),ArrowRight:V("horiz",1),ArrowUp:V("vert",-1),ArrowDown:V("vert",1),"Shift-ArrowLeft":W("horiz",-1),"Shift-ArrowRight":W("horiz",1),"Shift-ArrowUp":W("vert",-1),"Shift-ArrowDown":W("vert",1),Backspace:j,"Mod-Backspace":j,Delete:j,"Mod-Delete":j});function U(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function V(e,t){return(n,r,o)=>{if(!o)return!1;let i=n.selection;if(i instanceof k)return U(n,r,s.Y1.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;let a=G(o,e,t);if(null==a)return!1;if("horiz"==e)return U(n,r,s.Y1.near(n.doc.resolve(i.head+t),t));{let o;let i=n.doc.resolve(a),l=b(i,e,t);return o=l?s.Y1.near(l,1):t<0?s.Y1.near(n.doc.resolve(i.before(-1)),-1):s.Y1.near(n.doc.resolve(i.after(-1)),1),U(n,r,o)}}}function W(e,t){return(n,r,o)=>{let i;if(!o)return!1;let s=n.selection;if(s instanceof k)i=s;else{let r=G(o,e,t);if(null==r)return!1;i=new k(n.doc.resolve(r))}let a=b(i.$headCell,e,t);return!!a&&U(n,r,new k(i.$anchorCell,a))}}function q(e,t){let n=f(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new k(n))),!0)}function J(e,t,n){if(!m(e.state))return!1;let r=function(e){if(!e.size)return null;let{content:t,openStart:n,openEnd:r}=e;for(;1==t.childCount&&(n>0&&r>0||"table"==t.child(0).type.spec.tableRole);)n--,r--,t=t.child(0).content;let o=t.child(0),i=o.type.spec.tableRole,s=o.type.schema,l=[];if("row"==i)for(let e=0;e<t.childCount;e++){let o=t.child(e).content,i=e?0:Math.max(0,n-1),u=e<t.childCount-1?0:Math.max(0,r-1);(i||u)&&(o=D(d(s).row,new a.p2(o,i,u)).content),l.push(o)}else{if("cell"!=i&&"header_cell"!=i)return null;l.push(n||r?D(d(s).row,new a.p2(t,n,r)).content:t)}return function(e,t){let n=[];for(let e=0;e<t.length;e++){let r=t[e];for(let t=r.childCount-1;t>=0;t--){let{rowspan:o,colspan:i}=r.child(t).attrs;for(let t=e;t<e+o;t++)n[t]=(n[t]||0)+i}}let r=0;for(let e=0;e<n.length;e++)r=Math.max(r,n[e]);for(let o=0;o<n.length;o++)if(o>=t.length&&t.push(a.HY.empty),n[o]<r){let i=d(e).cell.createAndFill(),s=[];for(let e=n[o];e<r;e++)s.push(i);t[o]=t[o].append(a.HY.from(s))}return{height:t.length,width:r,rows:t}}(s,l)}(n),o=e.state.selection;if(o instanceof k){r||(r={width:1,height:1,rows:[a.HY.from(D(d(e.state.schema).cell,n))]});let t=o.$anchorCell.node(-1),i=o.$anchorCell.start(-1),s=p.get(t).rectBetween(o.$anchorCell.pos-i,o.$headCell.pos-i);return r=function({width:e,height:t,rows:n},r,o){if(e!=r){let t=[],o=[];for(let e=0;e<n.length;e++){let i=n[e],s=[];for(let n=t[e]||0,o=0;n<r;o++){let a=i.child(o%i.childCount);n+a.attrs.colspan>r&&(a=a.type.createChecked(w(a.attrs,a.attrs.colspan,n+a.attrs.colspan-r),a.content)),s.push(a),n+=a.attrs.colspan;for(let n=1;n<a.attrs.rowspan;n++)t[e+n]=(t[e+n]||0)+a.attrs.colspan}o.push(a.HY.from(s))}n=o,e=r}if(t!=o){let e=[];for(let r=0,i=0;r<o;r++,i++){let s=[],l=n[i%t];for(let e=0;e<l.childCount;e++){let t=l.child(e);r+t.attrs.rowspan>o&&(t=t.type.create({...t.attrs,rowspan:Math.max(1,o-t.attrs.rowspan)},t.content)),s.push(t)}e.push(a.HY.from(s))}n=e,t=o}return{width:e,height:t,rows:n}}(r,s.right-s.left,s.bottom-s.top),B(e.state,e.dispatch,i,s,r),!0}if(!r)return!1;{let t=g(e.state),n=t.start(-1);return B(e.state,e.dispatch,n,p.get(t.node(-1)).findCell(t.pos-n),r),!0}}function Y(e,t){var n;let r;if(t.ctrlKey||t.metaKey)return;let o=K(e,t.target);if(t.shiftKey&&e.state.selection instanceof k)i(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&o&&null!=(r=f(e.state.selection.$anchor))&&(null==(n=Z(e,t))?void 0:n.pos)!=r.pos)i(r,t),t.preventDefault();else if(!o)return;function i(t,n){let r=Z(e,n),o=null==h.getState(e.state);if(!r||!v(t,r)){if(!o)return;r=t}let i=new k(t,r);if(o||!e.state.selection.eq(i)){let n=e.state.tr.setSelection(i);o&&n.setMeta(h,t.pos),e.dispatch(n)}}function s(){e.root.removeEventListener("mouseup",s),e.root.removeEventListener("dragstart",s),e.root.removeEventListener("mousemove",a),null!=h.getState(e.state)&&e.dispatch(e.state.tr.setMeta(h,-1))}function a(n){let r;let a=h.getState(e.state);if(null!=a)r=e.state.doc.resolve(a);else if(K(e,n.target)!=o&&!(r=Z(e,t)))return s();r&&i(r,n)}e.root.addEventListener("mouseup",s),e.root.addEventListener("dragstart",s),e.root.addEventListener("mousemove",a)}function G(e,t,n){if(!(e.state.selection instanceof s.Bs))return null;let{$head:r}=e.state.selection;for(let o=r.depth-1;o>=0;o--){let i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))break;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){let i=r.before(o),s="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(s)?i:null}}return null}function K(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t;return null}function Z(e,t){let n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?f(e.state.doc.resolve(n.pos)):null}var X=class{constructor(e,t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${t}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Q(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type==this.node.type&&(this.node=e,Q(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))}};function Q(e,t,n,r,o,i){var s;let a=0,l=!0,u=t.firstChild,c=e.firstChild;if(c){for(let e=0,n=0;e<c.childCount;e++){let{colspan:s,colwidth:p}=c.child(e).attrs;for(let e=0;e<s;e++,n++){let s=o==n?i:p&&p[e],c=s?s+"px":"";if(a+=s||r,s||(l=!1),u)u.style.width!=c&&(u.style.width=c),u=u.nextSibling;else{let e=document.createElement("col");e.style.width=c,t.appendChild(e)}}}for(;u;){let e=u.nextSibling;null==(s=u.parentNode)||s.removeChild(u),u=e}l?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}}var ee=new s.H$("tableColumnResizing"),et=class e{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(t){let n=t.getMeta(ee);if(n&&null!=n.setHandle)return new e(n.setHandle,!1);if(n&&void 0!==n.setDragging)return new e(this.activeHandle,n.setDragging);if(this.activeHandle>-1&&t.docChanged){let n=t.mapping.map(this.activeHandle,-1);return y(t.doc.resolve(n))||(n=-1),new e(n,this.dragging)}return this}};function en(e,t,n,r){let o=e.posAtCoords({left:t.clientX+("right"==n?-r:r),top:t.clientY});if(!o)return -1;let{pos:i}=o,s=f(e.state.doc.resolve(i));if(!s)return -1;if("right"==n)return s.pos;let a=p.get(s.node(-1)),l=s.start(-1),u=a.map.indexOf(s.pos-l);return u%a.width==0?-1:l+a.map[u-1]}function er(e,t,n){let r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function eo(e,t){e.dispatch(e.state.tr.setMeta(ee,{setHandle:t}))}function ei(e,t,n,r){let o=e.state.doc.resolve(t),i=o.node(-1),s=o.start(-1),a=p.get(i).colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1,l=e.domAtPos(o.start(-1)).node;for(;l&&"TABLE"!=l.nodeName;)l=l.parentNode;l&&Q(i,l.firstChild,l,r,a,n)}function es(e,t){return t?["width",`${Math.max(t,e)}px`]:["min-width",`${e}px`]}function ea(e,t,n,r,o,i){var s;let a=0,l=!0,u=t.firstChild,c=e.firstChild;if(null!==c)for(let e=0,n=0;e<c.childCount;e+=1){let{colspan:s,colwidth:p}=c.child(e).attrs;for(let e=0;e<s;e+=1,n+=1){let s=o===n?i:p&&p[e],c=s?`${s}px`:"";if(a+=s||r,s||(l=!1),u){if(u.style.width!==c){let[e,t]=es(r,s);u.style.setProperty(e,t)}u=u.nextSibling}else{let e=document.createElement("col"),[n,o]=es(r,s);e.style.setProperty(n,o),t.appendChild(e)}}}for(;u;){let e=u.nextSibling;null===(s=u.parentNode)||void 0===s||s.removeChild(u),u=e}l?(n.style.width=`${a}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${a}px`)}class el{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ea(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type===this.node.type&&(this.node=e,ea(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return"attributes"===e.type&&(e.target===this.table||this.colgroup.contains(e.target))}}function eu(e,t){return t?e.createChecked(null,t):e.createAndFill()}let ec=({editor:e})=>{let{selection:t}=e.state;if(!(t instanceof k))return!1;let n=0,r=(0,i.qv)(t.ranges[0].$from,e=>"table"===e.type.name);return null==r||r.node.descendants(e=>{if("table"===e.type.name)return!1;["tableCell","tableHeader"].includes(e.type.name)&&(n+=1)}),n===t.ranges.length&&(e.commands.deleteTable(),!0)},ep=i.NB.create({name:"table",addOptions:()=>({HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:el,lastColumnResizable:!0,allowTableNodeSelection:!1}),content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({node:e,HTMLAttributes:t}){let{colgroup:n,tableWidth:r,tableMinWidth:o}=function(e,t,n,r){let o=0,i=!0,s=[],a=e.firstChild;if(!a)return{};for(let e=0,n=0;e<a.childCount;e+=1){let{colspan:r,colwidth:l}=a.child(e).attrs;for(let e=0;e<r;e+=1,n+=1){let r=void 0===n?void 0:l&&l[e];o+=r||t,r||(i=!1);let[a,u]=es(t,r);s.push(["col",{style:`${a}: ${u}`}])}}return{colgroup:["colgroup",{},...s],tableWidth:i?`${o}px`:"",tableMinWidth:i?"":`${o}px`}}(e,this.options.cellMinWidth);return["table",(0,i.P1)(this.options.HTMLAttributes,t,{style:r?`width: ${r}`:`min-width: ${o}`}),n,["tbody",0]]},addCommands:()=>({insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:o,editor:i})=>{let a=function(e,t,n,r,o){let i=function(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;let t={};return Object.keys(e.nodes).forEach(n=>{let r=e.nodes[n];r.spec.tableRole&&(t[r.spec.tableRole]=r)}),e.cached.tableNodeTypes=t,t}(e),s=[],a=[];for(let e=0;e<n;e+=1){let e=eu(i.cell,o);if(e&&a.push(e),r){let e=eu(i.header_cell,o);e&&s.push(e)}}let l=[];for(let e=0;e<t;e+=1)l.push(i.row.createChecked(null,r&&0===e?s:a));return i.table.createChecked(null,l)}(i.schema,e,t,n);if(o){let e=r.selection.from+1;r.replaceSelectionWith(a).scrollIntoView().setSelection(s.Bs.near(r.doc.resolve(e)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>(function(e,t){if(!m(e))return!1;if(t){let n=C(e);t(A(e.tr,n,n.left))}return!0})(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>(function(e,t){if(!m(e))return!1;if(t){let n=C(e);t(A(e.tr,n,n.right))}return!0})(e,t),deleteColumn:()=>({state:e,dispatch:t})=>(function(e,t){if(!m(e))return!1;if(t){let n=C(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(let e=n.right-1;!function(e,{map:t,table:n,tableStart:r},o){let i=e.mapping.maps.length;for(let s=0;s<t.height;){let a=s*t.width+o,l=t.map[a],u=n.nodeAt(l),c=u.attrs;if(o>0&&t.map[a-1]==l||o<t.width-1&&t.map[a+1]==l)e.setNodeMarkup(e.mapping.slice(i).map(r+l),null,w(c,o-t.colCount(l)));else{let t=e.mapping.slice(i).map(r+l);e.delete(t,t+u.nodeSize)}s+=c.rowspan}}(r,n,e),e!=n.left;e--){let e=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!e)throw RangeError("No table found");n.table=e,n.map=p.get(e)}t(r)}return!0})(e,t),addRowBefore:()=>({state:e,dispatch:t})=>(function(e,t){if(!m(e))return!1;if(t){let n=C(e);t(O(e.tr,n,n.top))}return!0})(e,t),addRowAfter:()=>({state:e,dispatch:t})=>(function(e,t){if(!m(e))return!1;if(t){let n=C(e);t(O(e.tr,n,n.bottom))}return!0})(e,t),deleteRow:()=>({state:e,dispatch:t})=>(function(e,t){if(!m(e))return!1;if(t){let n=C(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(let e=n.bottom-1;!function(e,{map:t,table:n,tableStart:r},o){let i=0;for(let e=0;e<o;e++)i+=n.child(e).nodeSize;let s=i+n.child(o).nodeSize,a=e.mapping.maps.length;e.delete(i+r,s+r);let l=new Set;for(let i=0,s=o*t.width;i<t.width;i++,s++){let u=t.map[s];if(!l.has(u)){if(l.add(u),o>0&&u==t.map[s-t.width]){let t=n.nodeAt(u).attrs;e.setNodeMarkup(e.mapping.slice(a).map(u+r),null,{...t,rowspan:t.rowspan-1}),i+=t.colspan-1}else if(o<t.height&&u==t.map[s+t.width]){let s=n.nodeAt(u),l=s.attrs,c=s.type.create({...l,rowspan:s.attrs.rowspan-1},s.content),p=t.positionAt(o+1,i,n);e.insert(e.mapping.slice(a).map(r+p),c),i+=l.colspan-1}}}}(r,n,e),e!=n.top;e--){let e=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!e)throw RangeError("No table found");n.table=e,n.map=p.get(n.table)}t(r)}return!0})(e,t),deleteTable:()=>({state:e,dispatch:t})=>(function(e,t){let n=e.selection.$anchor;for(let r=n.depth;r>0;r--)if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1})(e,t),mergeCells:()=>({state:e,dispatch:t})=>M(e,t),splitCell:()=>({state:e,dispatch:t})=>I(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>z("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>z("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>P(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>!!M(e,t)||I(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:r})=>(function(n,r){if(!m(n))return!1;let o=g(n);if(o.nodeAfter.attrs[e]===t)return!1;if(r){let i=n.tr;n.selection instanceof k?n.selection.forEachCell((n,r)=>{n.attrs[e]!==t&&i.setNodeMarkup(r,null,{...n.attrs,[e]:t})}):i.setNodeMarkup(o.pos,null,{...o.nodeAfter.attrs,[e]:t}),r(i)}return!0})(n,r),goToNextCell:()=>({state:e,dispatch:t})=>L(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>L(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&E(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){let n=k.create(t.doc,e.anchorCell,e.headCell);t.setSelection(n)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:ec,"Mod-Backspace":ec,Delete:ec,"Mod-Delete":ec}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[function({handleWidth:e=5,cellMinWidth:t=25,defaultCellMinWidth:n=100,View:r=X,lastColumnResizable:o=!0}={}){let i=new s.Sy({key:ee,state:{init(e,t){var o,s;let a=null==(s=null==(o=i.spec)?void 0:o.props)?void 0:s.nodeViews,l=d(t.schema).table.name;return r&&a&&(a[l]=(e,t)=>new r(e,n,t)),new et(-1,!1)},apply:(e,t)=>t.apply(e)},props:{attributes:e=>{let t=ee.getState(e);return t&&t.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(t,n)=>{!function(e,t,n,r){if(!e.editable)return;let o=ee.getState(e.state);if(o&&!o.dragging){let i=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),s=-1;if(i){let{left:r,right:o}=i.getBoundingClientRect();t.clientX-r<=n?s=en(e,t,"left",n):o-t.clientX<=n&&(s=en(e,t,"right",n))}if(s!=o.activeHandle){if(!r&&-1!==s){let t=e.state.doc.resolve(s),n=t.node(-1),r=p.get(n),o=t.start(-1);if(r.colCount(t.pos-o)+t.nodeAfter.attrs.colspan-1==r.width-1)return}eo(e,s)}}}(t,n,e,o)},mouseleave:e=>{!function(e){if(!e.editable)return;let t=ee.getState(e.state);t&&t.activeHandle>-1&&!t.dragging&&eo(e,-1)}(e)},mousedown:(e,r)=>{!function(e,t,n,r){var o;if(!e.editable)return;let i=null!=(o=e.dom.ownerDocument.defaultView)?o:window,s=ee.getState(e.state);if(!s||-1==s.activeHandle||s.dragging)return;let a=e.state.doc.nodeAt(s.activeHandle),l=function(e,t,{colspan:n,colwidth:r}){let o=r&&r[r.length-1];if(o)return o;let i=e.domAtPos(t),s=i.node.childNodes[i.offset].offsetWidth,a=n;if(r)for(let e=0;e<n;e++)r[e]&&(s-=r[e],a--);return s/a}(e,s.activeHandle,a.attrs);function u(t){i.removeEventListener("mouseup",u),i.removeEventListener("mousemove",c);let r=ee.getState(e.state);(null==r?void 0:r.dragging)&&(function(e,t,n){let r=e.state.doc.resolve(t),o=r.node(-1),i=p.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,l=e.state.tr;for(let e=0;e<i.height;e++){let t=e*i.width+a;if(e&&i.map[t]==i.map[t-i.width])continue;let r=i.map[t],u=o.nodeAt(r).attrs,c=1==u.colspan?0:a-i.colCount(r);if(u.colwidth&&u.colwidth[c]==n)continue;let p=u.colwidth?u.colwidth.slice():Array(u.colspan).fill(0);p[c]=n,l.setNodeMarkup(s+r,null,{...u,colwidth:p})}l.docChanged&&e.dispatch(l)}(e,r.activeHandle,er(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(ee,{setDragging:null})))}function c(t){if(!t.which)return u(t);let o=ee.getState(e.state);if(o&&o.dragging){let i=er(o.dragging,t,n);ei(e,o.activeHandle,i,r)}}e.dispatch(e.state.tr.setMeta(ee,{setDragging:{startX:t.clientX,startWidth:l}})),ei(e,s.activeHandle,l,r),i.addEventListener("mouseup",u),i.addEventListener("mousemove",c),t.preventDefault()}(e,r,t,n)}},decorations:e=>{let t=ee.getState(e);if(t&&t.activeHandle>-1)return function(e,t){var n;let r=[],o=e.doc.resolve(t),i=o.node(-1);if(!i)return l.EH.empty;let s=p.get(i),a=o.start(-1),u=s.colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1;for(let t=0;t<s.height;t++){let o=u+t*s.width;if((u==s.width-1||s.map[o]!=s.map[o+1])&&(0==t||s.map[o]!=s.map[o-s.width])){let t=s.map[o],u=a+t+i.nodeAt(t).nodeSize-1,c=document.createElement("div");c.className="column-resize-handle",(null==(n=ee.getState(e))?void 0:n.dragging)&&r.push(l.p.node(a+t,a+t+i.nodeAt(t).nodeSize,{class:"column-resize-dragging"})),r.push(l.p.widget(u,c))}}return l.EH.create(e.doc,r)}(e,t.activeHandle)},nodeViews:{}}});return i}({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],function({allowTableNodeSelection:e=!1}={}){return new s.Sy({key:h,state:{init:()=>null,apply(e,t){let n=e.getMeta(h);if(null!=n)return -1==n?null:n;if(null==t||!e.docChanged)return t;let{deleted:r,pos:o}=e.mapping.mapResult(t);return r?null:o}},props:{decorations:S,handleDOMEvents:{mousedown:Y},createSelectionBetween:e=>null!=h.getState(e.state)?e.state.selection:null,handleTripleClick:q,handleKeyDown:F,handlePaste:J},appendTransaction:(t,n,r)=>(function(e,t,n){let r,o;let i=(t||e).selection,a=(t||e).doc;if(i instanceof s.qv&&(o=i.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)r=k.create(a,i.from);else if("row"==o){let e=a.resolve(i.from+1);r=k.rowSelection(e,e)}else if(!n){let e=p.get(i.node),t=i.from+1,n=t+e.map[e.width*e.height-1];r=k.create(a,t+1,n)}}else i instanceof s.Bs&&function({$from:e,$to:t}){if(e.pos==t.pos||e.pos<t.pos-6)return!1;let n=e.pos,r=t.pos,o=e.depth;for(;o>=0&&!(e.after(o+1)<e.end(o));o--,n++);for(let e=t.depth;e>=0&&!(t.before(e+1)>t.start(e));e--,r--);return n==r&&/row|table/.test(e.node(o).type.spec.tableRole)}(i)?r=s.Bs.create(a,i.from):i instanceof s.Bs&&function({$from:e,$to:t}){let n,r;for(let t=e.depth;t>0;t--){let r=e.node(t);if("cell"===r.type.spec.tableRole||"header_cell"===r.type.spec.tableRole){n=r;break}}for(let e=t.depth;e>0;e--){let n=t.node(e);if("cell"===n.type.spec.tableRole||"header_cell"===n.type.spec.tableRole){r=n;break}}return n!==r&&0===t.parentOffset}(i)&&(r=s.Bs.create(a,i.$from.start(),i.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t})(r,E(r,n),e)})}({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){let t={name:e.name,options:e.options,storage:e.storage};return{tableRole:(0,i.nU)((0,i.Nl)(e,"tableRole",t))}}})},96279:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=n(5865).hj.create({name:"textAlign",addOptions:()=>({types:[],alignments:["left","center","right","justify"],defaultAlignment:null}),addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{let t=e.style.textAlign;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign?{style:`text-align: ${e.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>!!this.options.alignments.includes(e)&&this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).every(e=>e),unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).every(e=>e),toggleTextAlign:e=>({editor:t,commands:n})=>!!this.options.alignments.includes(e)&&(t.isActive({textAlign:e})?n.unsetTextAlign():n.setTextAlign(e))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}})},27662:function(e,t,n){"use strict";n.d(t,{NM:function(){return tf},kg:function(){return tt},jE:function(){return tp}});var r,o,i,s,a,l,u,c,p=n(5865),d=n(2376);function h(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function f(e){var t=h(e).Element;return e instanceof t||e instanceof Element}function m(e){var t=h(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function g(e){if("undefined"==typeof ShadowRoot)return!1;var t=h(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var y=Math.max,v=Math.min,b=Math.round;function w(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function x(){return!/^((?!chrome|android).)*safari/i.test(w())}function k(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),o=1,i=1;t&&m(e)&&(o=e.offsetWidth>0&&b(r.width)/e.offsetWidth||1,i=e.offsetHeight>0&&b(r.height)/e.offsetHeight||1);var s=(f(e)?h(e):window).visualViewport,a=!x()&&n,l=(r.left+(a&&s?s.offsetLeft:0))/o,u=(r.top+(a&&s?s.offsetTop:0))/i,c=r.width/o,p=r.height/i;return{width:c,height:p,top:u,right:l+c,bottom:u+p,left:l,x:l,y:u}}function _(e){var t=h(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function S(e){return e?(e.nodeName||"").toLowerCase():null}function T(e){return((f(e)?e.ownerDocument:e.document)||window.document).documentElement}function E(e){return k(T(e)).left+_(e).scrollLeft}function C(e){return h(e).getComputedStyle(e)}function A(e){var t=C(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function O(e){var t=k(e),n=e.offsetWidth,r=e.offsetHeight;return 1>=Math.abs(t.width-n)&&(n=t.width),1>=Math.abs(t.height-r)&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function N(e){return"html"===S(e)?e:e.assignedSlot||e.parentNode||(g(e)?e.host:null)||T(e)}function M(e,t){void 0===t&&(t=[]);var n,r=function e(t){return["html","body","#document"].indexOf(S(t))>=0?t.ownerDocument.body:m(t)&&A(t)?t:e(N(t))}(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=h(r),s=o?[i].concat(i.visualViewport||[],A(r)?r:[]):r,a=t.concat(s);return o?a:a.concat(M(N(s)))}function I(e){return m(e)&&"fixed"!==C(e).position?e.offsetParent:null}function R(e){for(var t=h(e),n=I(e);n&&["table","td","th"].indexOf(S(n))>=0&&"static"===C(n).position;)n=I(n);return n&&("html"===S(n)||"body"===S(n)&&"static"===C(n).position)?t:n||function(e){var t=/firefox/i.test(w());if(/Trident/i.test(w())&&m(e)&&"fixed"===C(e).position)return null;var n=N(e);for(g(n)&&(n=n.host);m(n)&&0>["html","body"].indexOf(S(n));){var r=C(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var z="bottom",P="right",L="left",j="auto",D=["top",z,P,L],$="start",H="viewport",B="popper",F=D.reduce(function(e,t){return e.concat([t+"-"+$,t+"-end"])},[]),U=[].concat(D,[j]).reduce(function(e,t){return e.concat([t,t+"-"+$,t+"-end"])},[]),V=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"],W={placement:"bottom",modifiers:[],strategy:"absolute"};function q(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}var J={passive:!0};function Y(e){return e.split("-")[0]}function G(e){return e.split("-")[1]}function K(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Z(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?Y(o):null,s=o?G(o):null,a=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(i){case"top":t={x:a,y:n.y-r.height};break;case z:t={x:a,y:n.y+n.height};break;case P:t={x:n.x+n.width,y:l};break;case L:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var u=i?K(i):null;if(null!=u){var c="y"===u?"height":"width";switch(s){case $:t[u]=t[u]-(n[c]/2-r[c]/2);break;case"end":t[u]=t[u]+(n[c]/2-r[c]/2)}}return t}var X={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Q(e){var t,n,r,o,i,s,a,l=e.popper,u=e.popperRect,c=e.placement,p=e.variation,d=e.offsets,f=e.position,m=e.gpuAcceleration,g=e.adaptive,y=e.roundOffsets,v=e.isFixed,w=d.x,x=void 0===w?0:w,k=d.y,_=void 0===k?0:k,S="function"==typeof y?y({x:x,y:_}):{x:x,y:_};x=S.x,_=S.y;var E=d.hasOwnProperty("x"),A=d.hasOwnProperty("y"),O=L,N="top",M=window;if(g){var I=R(l),j="clientHeight",D="clientWidth";I===h(l)&&"static"!==C(I=T(l)).position&&"absolute"===f&&(j="scrollHeight",D="scrollWidth"),("top"===c||(c===L||c===P)&&"end"===p)&&(N=z,_-=(v&&I===M&&M.visualViewport?M.visualViewport.height:I[j])-u.height,_*=m?1:-1),(c===L||("top"===c||c===z)&&"end"===p)&&(O=P,x-=(v&&I===M&&M.visualViewport?M.visualViewport.width:I[D])-u.width,x*=m?1:-1)}var $=Object.assign({position:f},g&&X),H=!0===y?(t={x:x,y:_},n=h(l),r=t.x,o=t.y,{x:b(r*(i=n.devicePixelRatio||1))/i||0,y:b(o*i)/i||0}):{x:x,y:_};return(x=H.x,_=H.y,m)?Object.assign({},$,((a={})[N]=A?"0":"",a[O]=E?"0":"",a.transform=1>=(M.devicePixelRatio||1)?"translate("+x+"px, "+_+"px)":"translate3d("+x+"px, "+_+"px, 0)",a)):Object.assign({},$,((s={})[N]=A?_+"px":"",s[O]=E?x+"px":"",s.transform="",s))}var ee={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];m(o)&&S(o)&&(Object.assign(o.style,n),Object.keys(r).forEach(function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(e){var r=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce(function(e,t){return e[t]="",e},{});m(r)&&S(r)&&(Object.assign(r.style,i),Object.keys(o).forEach(function(e){r.removeAttribute(e)}))})}},requires:["computeStyles"]},et={left:"right",right:"left",bottom:"top",top:"bottom"};function en(e){return e.replace(/left|right|bottom|top/g,function(e){return et[e]})}var er={start:"end",end:"start"};function eo(e){return e.replace(/start|end/g,function(e){return er[e]})}function ei(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&g(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function es(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ea(e,t,n){var r,o,i,s,a,l,u,c,p,d;return t===H?es(function(e,t){var n=h(e),r=T(e),o=n.visualViewport,i=r.clientWidth,s=r.clientHeight,a=0,l=0;if(o){i=o.width,s=o.height;var u=x();(u||!u&&"fixed"===t)&&(a=o.offsetLeft,l=o.offsetTop)}return{width:i,height:s,x:a+E(e),y:l}}(e,n)):f(t)?((r=k(t,!1,"fixed"===n)).top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r):es((o=T(e),s=T(o),a=_(o),l=null==(i=o.ownerDocument)?void 0:i.body,u=y(s.scrollWidth,s.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),c=y(s.scrollHeight,s.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),p=-a.scrollLeft+E(o),d=-a.scrollTop,"rtl"===C(l||s).direction&&(p+=y(s.clientWidth,l?l.clientWidth:0)-u),{width:u,height:c,x:p,y:d}))}function el(){return{top:0,right:0,bottom:0,left:0}}function eu(e){return Object.assign({},el(),e)}function ec(e,t){return t.reduce(function(t,n){return t[n]=e,t},{})}function ep(e,t){void 0===t&&(t={});var n,r,o,i,s,a,l,u=t,c=u.placement,p=void 0===c?e.placement:c,d=u.strategy,h=void 0===d?e.strategy:d,g=u.boundary,b=u.rootBoundary,w=u.elementContext,x=void 0===w?B:w,_=u.altBoundary,E=u.padding,A=void 0===E?0:E,O=eu("number"!=typeof A?A:ec(A,D)),I=e.rects.popper,L=e.elements[void 0!==_&&_?x===B?"reference":B:x],j=(n=f(L)?L:L.contextElement||T(e.elements.popper),a=(s=[].concat("clippingParents"===(r=void 0===g?"clippingParents":g)?(o=M(N(n)),f(i=["absolute","fixed"].indexOf(C(n).position)>=0&&m(n)?R(n):n)?o.filter(function(e){return f(e)&&ei(e,i)&&"body"!==S(e)}):[]):[].concat(r),[void 0===b?H:b]))[0],(l=s.reduce(function(e,t){var r=ea(n,t,h);return e.top=y(r.top,e.top),e.right=v(r.right,e.right),e.bottom=v(r.bottom,e.bottom),e.left=y(r.left,e.left),e},ea(n,a,h))).width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l),$=k(e.elements.reference),F=Z({reference:$,element:I,strategy:"absolute",placement:p}),U=es(Object.assign({},I,F)),V=x===B?U:$,W={top:j.top-V.top+O.top,bottom:V.bottom-j.bottom+O.bottom,left:j.left-V.left+O.left,right:V.right-j.right+O.right},q=e.modifiersData.offset;if(x===B&&q){var J=q[p];Object.keys(W).forEach(function(e){var t=[P,z].indexOf(e)>=0?1:-1,n=["top",z].indexOf(e)>=0?"y":"x";W[e]+=J[n]*t})}return W}function ed(e,t,n){return y(e,v(t,n))}function eh(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function ef(e){return["top",P,z,L].some(function(t){return e[t]>=0})}var em=(i=void 0===(o=(r={defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=void 0===o||o,s=r.resize,a=void 0===s||s,l=h(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&u.forEach(function(e){e.addEventListener("scroll",n.update,J)}),a&&l.addEventListener("resize",n.update,J),function(){i&&u.forEach(function(e){e.removeEventListener("scroll",n.update,J)}),a&&l.removeEventListener("resize",n.update,J)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=Z({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=n.adaptive,i=n.roundOffsets,s=void 0===i||i,a={placement:Y(t.placement),variation:G(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:void 0===r||r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Q(Object.assign({},a,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:void 0===o||o,roundOffsets:s})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Q(Object.assign({},a,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:s})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},ee,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,s=U.reduce(function(e,n){var r,o,s,a,l,u;return e[n]=(r=t.rects,s=[L,"top"].indexOf(o=Y(n))>=0?-1:1,l=(a="function"==typeof i?i(Object.assign({},r,{placement:n})):i)[0],u=a[1],l=l||0,u=(u||0)*s,[L,P].indexOf(o)>=0?{x:u,y:l}:{x:l,y:u}),e},{}),a=s[t.placement],l=a.x,u=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=s}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,s=n.altAxis,a=void 0===s||s,l=n.fallbackPlacements,u=n.padding,c=n.boundary,p=n.rootBoundary,d=n.altBoundary,h=n.flipVariations,f=void 0===h||h,m=n.allowedAutoPlacements,g=t.options.placement,y=Y(g)===g,v=l||(y||!f?[en(g)]:function(e){if(Y(e)===j)return[];var t=en(e);return[eo(e),t,eo(t)]}(g)),b=[g].concat(v).reduce(function(e,n){var r,o,i,s,a,l,d,h,g,y,v,b;return e.concat(Y(n)===j?(o=(r={placement:n,boundary:c,rootBoundary:p,padding:u,flipVariations:f,allowedAutoPlacements:m}).placement,i=r.boundary,s=r.rootBoundary,a=r.padding,l=r.flipVariations,h=void 0===(d=r.allowedAutoPlacements)?U:d,0===(v=(y=(g=G(o))?l?F:F.filter(function(e){return G(e)===g}):D).filter(function(e){return h.indexOf(e)>=0})).length&&(v=y),Object.keys(b=v.reduce(function(e,n){return e[n]=ep(t,{placement:n,boundary:i,rootBoundary:s,padding:a})[Y(n)],e},{})).sort(function(e,t){return b[e]-b[t]})):n)},[]),w=t.rects.reference,x=t.rects.popper,k=new Map,_=!0,S=b[0],T=0;T<b.length;T++){var E=b[T],C=Y(E),A=G(E)===$,O=["top",z].indexOf(C)>=0,N=O?"width":"height",M=ep(t,{placement:E,boundary:c,rootBoundary:p,altBoundary:d,padding:u}),I=O?A?P:L:A?z:"top";w[N]>x[N]&&(I=en(I));var R=en(I),H=[];if(i&&H.push(M[C]<=0),a&&H.push(M[I]<=0,M[R]<=0),H.every(function(e){return e})){S=E,_=!1;break}k.set(E,H)}if(_)for(var B=f?3:1,V=function(e){var t=b.find(function(t){var n=k.get(t);if(n)return n.slice(0,e).every(function(e){return e})});if(t)return S=t,"break"},W=B;W>0&&"break"!==V(W);W--);t.placement!==S&&(t.modifiersData[r]._skip=!0,t.placement=S,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,i=n.altAxis,s=n.boundary,a=n.rootBoundary,l=n.altBoundary,u=n.padding,c=n.tether,p=void 0===c||c,d=n.tetherOffset,h=void 0===d?0:d,f=ep(t,{boundary:s,rootBoundary:a,padding:u,altBoundary:l}),m=Y(t.placement),g=G(t.placement),b=!g,w=K(m),x="x"===w?"y":"x",k=t.modifiersData.popperOffsets,_=t.rects.reference,S=t.rects.popper,T="function"==typeof h?h(Object.assign({},t.rects,{placement:t.placement})):h,E="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),C=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,A={x:0,y:0};if(k){if(void 0===o||o){var N,M="y"===w?"top":L,I="y"===w?z:P,j="y"===w?"height":"width",D=k[w],H=D+f[M],B=D-f[I],F=p?-S[j]/2:0,U=g===$?_[j]:S[j],V=g===$?-S[j]:-_[j],W=t.elements.arrow,q=p&&W?O(W):{width:0,height:0},J=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:el(),Z=J[M],X=J[I],Q=ed(0,_[j],q[j]),ee=b?_[j]/2-F-Q-Z-E.mainAxis:U-Q-Z-E.mainAxis,et=b?-_[j]/2+F+Q+X+E.mainAxis:V+Q+X+E.mainAxis,en=t.elements.arrow&&R(t.elements.arrow),er=en?"y"===w?en.clientTop||0:en.clientLeft||0:0,eo=null!=(N=null==C?void 0:C[w])?N:0,ei=ed(p?v(H,D+ee-eo-er):H,D,p?y(B,D+et-eo):B);k[w]=ei,A[w]=ei-D}if(void 0!==i&&i){var es,ea,eu="x"===w?"top":L,ec="x"===w?z:P,eh=k[x],ef="y"===x?"height":"width",em=eh+f[eu],eg=eh-f[ec],ey=-1!==["top",L].indexOf(m),ev=null!=(ea=null==C?void 0:C[x])?ea:0,eb=ey?em:eh-_[ef]-S[ef]-ev+E.altAxis,ew=ey?eh+_[ef]+S[ef]-ev-E.altAxis:eg,ex=p&&ey?(es=ed(eb,eh,ew))>ew?ew:es:ed(p?eb:em,eh,p?ew:eg);k[x]=ex,A[x]=ex-eh}t.modifiersData[r]=A}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n,r=e.state,o=e.name,i=e.options,s=r.elements.arrow,a=r.modifiersData.popperOffsets,l=Y(r.placement),u=K(l),c=[L,P].indexOf(l)>=0?"height":"width";if(s&&a){var p=eu("number"!=typeof(t="function"==typeof(t=i.padding)?t(Object.assign({},r.rects,{placement:r.placement})):t)?t:ec(t,D)),d=O(s),h="y"===u?"top":L,f="y"===u?z:P,m=r.rects.reference[c]+r.rects.reference[u]-a[u]-r.rects.popper[c],g=a[u]-r.rects.reference[u],y=R(s),v=y?"y"===u?y.clientHeight||0:y.clientWidth||0:0,b=p[h],w=v-d[c]-p[f],x=v/2-d[c]/2+(m/2-g/2),k=ed(b,x,w);r.modifiersData[o]=((n={})[u]=k,n.centerOffset=k-x,n)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&ei(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,s=ep(t,{elementContext:"reference"}),a=ep(t,{altBoundary:!0}),l=eh(s,r),u=eh(a,o,i),c=ef(l),p=ef(u);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":p})}}]}).defaultModifiers)?[]:o,a=void 0===(s=r.defaultOptions)?W:s,function(e,t,n){void 0===n&&(n=a);var r,o={placement:"bottom",orderedModifiers:[],options:Object.assign({},W,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},s=[],l=!1,u={state:o,setOptions:function(n){var r,l,p,d,h,m="function"==typeof n?n(o.options):n;c(),o.options=Object.assign({},a,o.options,m),o.scrollParents={reference:f(e)?M(e):e.contextElement?M(e.contextElement):[],popper:M(t)};var g=(l=Object.keys(r=[].concat(i,o.options.modifiers).reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{})).map(function(e){return r[e]}),p=new Map,d=new Set,h=[],l.forEach(function(e){p.set(e.name,e)}),l.forEach(function(e){d.has(e.name)||function e(t){d.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach(function(t){if(!d.has(t)){var n=p.get(t);n&&e(n)}}),h.push(t)}(e)}),V.reduce(function(e,t){return e.concat(h.filter(function(e){return e.phase===t}))},[]));return o.orderedModifiers=g.filter(function(e){return e.enabled}),o.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,r=e.effect;if("function"==typeof r){var i=r({state:o,name:t,instance:u,options:void 0===n?{}:n});s.push(i||function(){})}}),u.update()},forceUpdate:function(){if(!l){var e,t,n,r,i,s,a,c,p,d,f,g,y=o.elements,v=y.reference,w=y.popper;if(q(v,w)){o.rects={reference:(t=R(w),n="fixed"===o.options.strategy,r=m(t),c=m(t)&&(s=b((i=t.getBoundingClientRect()).width)/t.offsetWidth||1,a=b(i.height)/t.offsetHeight||1,1!==s||1!==a),p=T(t),d=k(v,c,n),f={scrollLeft:0,scrollTop:0},g={x:0,y:0},(r||!r&&!n)&&(("body"!==S(t)||A(p))&&(f=(e=t)!==h(e)&&m(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:_(e)),m(t)?(g=k(t,!0),g.x+=t.clientLeft,g.y+=t.clientTop):p&&(g.x=E(p))),{x:d.left+f.scrollLeft-g.x,y:d.top+f.scrollTop-g.y,width:d.width,height:d.height}),popper:O(w)},o.reset=!1,o.placement=o.options.placement,o.orderedModifiers.forEach(function(e){return o.modifiersData[e.name]=Object.assign({},e.data)});for(var x=0;x<o.orderedModifiers.length;x++){if(!0===o.reset){o.reset=!1,x=-1;continue}var C=o.orderedModifiers[x],N=C.fn,M=C.options,I=void 0===M?{}:M,z=C.name;"function"==typeof N&&(o=N({state:o,options:I,name:z,instance:u})||o)}}}},update:function(){return r||(r=new Promise(function(e){Promise.resolve().then(function(){r=void 0,e(new Promise(function(e){u.forceUpdate(),e(o)}))})})),r},destroy:function(){c(),l=!0}};if(!q(e,t))return u;function c(){s.forEach(function(e){return e()}),s=[]}return u.setOptions(n).then(function(e){!l&&n.onFirstUpdate&&n.onFirstUpdate(e)}),u}),eg="tippy-content",ey="tippy-arrow",ev="tippy-svg-arrow",eb={passive:!0,capture:!0},ew=function(){return document.body};function ex(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(n)?n[t]:n:r}return e}function ek(e,t){var n=({}).toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function e_(e,t){return"function"==typeof e?e.apply(void 0,t):e}function eS(e,t){var n;return 0===t?e:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)}}function eT(e){return[].concat(e)}function eE(e,t){-1===e.indexOf(t)&&e.push(t)}function eC(e){return[].slice.call(e)}function eA(e){return Object.keys(e).reduce(function(t,n){return void 0!==e[n]&&(t[n]=e[n]),t},{})}function eO(){return document.createElement("div")}function eN(e){return["Element","Fragment"].some(function(t){return ek(e,t)})}function eM(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function eI(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function eR(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(t){e[r](t,n)})}function ez(e,t){for(var n,r=t;r;){if(e.contains(r))return!0;r=null==r.getRootNode?void 0:null==(n=r.getRootNode())?void 0:n.host}return!1}var eP={isTouch:!1},eL=0;function ej(){!eP.isTouch&&(eP.isTouch=!0,window.performance&&document.addEventListener("mousemove",eD))}function eD(){var e=performance.now();e-eL<20&&(eP.isTouch=!1,document.removeEventListener("mousemove",eD)),eL=e}function e$(){var e=document.activeElement;if(e&&e._tippy&&e._tippy.reference===e){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}var eH=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto,eB=Object.assign({appendTo:ew,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),eF=Object.keys(eB);function eU(e){var t=(e.plugins||[]).reduce(function(t,n){var r,o=n.name,i=n.defaultValue;return o&&(t[o]=void 0!==e[o]?e[o]:null!=(r=eB[o])?r:i),t},{});return Object.assign({},e,t)}function eV(e,t){var n,r=Object.assign({},t,{content:e_(t.content,[e])},t.ignoreAttributes?{}:((n=t.plugins)?Object.keys(eU(Object.assign({},eB,{plugins:n}))):eF).reduce(function(t,n){var r=(e.getAttribute("data-tippy-"+n)||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t},{}));return r.aria=Object.assign({},eB.aria,r.aria),r.aria={expanded:"auto"===r.aria.expanded?t.interactive:r.aria.expanded,content:"auto"===r.aria.content?t.interactive?null:"describedby":r.aria.content},r}function eW(e,t){e.innerHTML=t}function eq(e){var t=eO();return!0===e?t.className=ey:(t.className=ev,eN(e)?t.appendChild(e):eW(t,e)),t}function eJ(e,t){eN(t.content)?(eW(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?eW(e,t.content):e.textContent=t.content)}function eY(e){var t=e.firstElementChild,n=eC(t.children);return{box:t,content:n.find(function(e){return e.classList.contains(eg)}),arrow:n.find(function(e){return e.classList.contains(ey)||e.classList.contains(ev)}),backdrop:n.find(function(e){return e.classList.contains("tippy-backdrop")})}}function eG(e){var t=eO(),n=eO();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=eO();function o(n,r){var o=eY(t),i=o.box,s=o.content,a=o.arrow;r.theme?i.setAttribute("data-theme",r.theme):i.removeAttribute("data-theme"),"string"==typeof r.animation?i.setAttribute("data-animation",r.animation):i.removeAttribute("data-animation"),r.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?i.setAttribute("role",r.role):i.removeAttribute("role"),(n.content!==r.content||n.allowHTML!==r.allowHTML)&&eJ(s,e.props),r.arrow?a?n.arrow!==r.arrow&&(i.removeChild(a),i.appendChild(eq(r.arrow))):i.appendChild(eq(r.arrow)):a&&i.removeChild(a)}return r.className=eg,r.setAttribute("data-state","hidden"),eJ(r,e.props),t.appendChild(n),n.appendChild(r),o(e.props,e.props),{popper:t,onUpdate:o}}eG.$$tippy=!0;var eK=1,eZ=[],eX=[];function eQ(e,t){void 0===t&&(t={});var n=eB.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",ej,eb),window.addEventListener("blur",e$);var r=Object.assign({},t,{plugins:n}),o=(eN(e)?[e]:ek(e,"NodeList")?eC(e):Array.isArray(e)?e:eC(document.querySelectorAll(e))).reduce(function(e,t){var n=t&&function(e,t){var n,r,o,i,s,a,l,u,c=eV(e,Object.assign({},eB,eU(eA(t)))),p=!1,d=!1,h=!1,f=!1,m=[],g=eS(W,c.interactiveDebounce),y=eK++,v=(n=c.plugins).filter(function(e,t){return n.indexOf(e)===t}),b={id:y,reference:e,popper:eO(),popperInstance:null,props:c,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:v,clearDelayTimeouts:function(){clearTimeout(r),clearTimeout(o),cancelAnimationFrame(i)},setProps:function(t){if(!b.state.isDestroyed){M("onBeforeUpdate",[b,t]),U();var n=b.props,r=eV(e,Object.assign({},n,eA(t),{ignoreAttributes:!0}));b.props=r,F(),n.interactiveDebounce!==r.interactiveDebounce&&(z(),g=eS(W,r.interactiveDebounce)),n.triggerTarget&&!r.triggerTarget?eT(n.triggerTarget).forEach(function(e){e.removeAttribute("aria-expanded")}):r.triggerTarget&&e.removeAttribute("aria-expanded"),R(),N(),k&&k(n,r),b.popperInstance&&(G(),Z().forEach(function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})),M("onAfterUpdate",[b,t])}},setContent:function(e){b.setProps({content:e})},show:function(){var t,n,r,o=b.state.isVisible,i=b.state.isDestroyed,s=!b.state.isEnabled,a=eP.isTouch&&!b.props.touch,c=ex(b.props.duration,0,eB.duration);if(!(o||i||s||a||(u||e).hasAttribute("disabled"))&&(M("onShow",[b],!1),!1!==b.props.onShow(b))){if(b.state.isVisible=!0,C()&&(x.style.visibility="visible"),N(),D(),b.state.isMounted||(x.style.transition="none"),C()){var p=eY(x);eM([p.box,p.content],0)}l=function(){var e;if(b.state.isVisible&&!f){if(f=!0,x.offsetHeight,x.style.transition=b.props.moveTransition,C()&&b.props.animation){var t=eY(x),n=t.box,r=t.content;eM([n,r],c),eI([n,r],"visible")}I(),R(),eE(eX,b),null==(e=b.popperInstance)||e.forceUpdate(),M("onMount",[b]),b.props.animation&&C()&&H(c,function(){b.state.isShown=!0,M("onShown",[b])})}},n=b.props.appendTo,r=u||e,(t=b.props.interactive&&n===ew||"parent"===n?r.parentNode:e_(n,[r])).contains(x)||t.appendChild(x),b.state.isMounted=!0,G()}},hide:function(){var e,t=!b.state.isVisible,n=b.state.isDestroyed,r=!b.state.isEnabled,o=ex(b.props.duration,1,eB.duration);if(!t&&!n&&!r&&(M("onHide",[b],!1),!1!==b.props.onHide(b))){if(b.state.isVisible=!1,b.state.isShown=!1,f=!1,p=!1,C()&&(x.style.visibility="hidden"),z(),$(),N(!0),C()){var i=eY(x),s=i.box,a=i.content;b.props.animation&&(eM([s,a],o),eI([s,a],"hidden"))}(I(),R(),b.props.animation)?C()&&(e=b.unmount,H(o,function(){!b.state.isVisible&&x.parentNode&&x.parentNode.contains(x)&&e()})):b.unmount()}},hideWithInteractivity:function(e){A().addEventListener("mousemove",g),eE(eZ,g),g(e)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){b.state.isVisible&&b.hide(),b.state.isMounted&&(K(),Z().forEach(function(e){e._tippy.unmount()}),x.parentNode&&x.parentNode.removeChild(x),eX=eX.filter(function(e){return e!==b}),b.state.isMounted=!1,M("onHidden",[b]))},destroy:function(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),U(),delete e._tippy,b.state.isDestroyed=!0,M("onDestroy",[b]))}};if(!c.render)return b;var w=c.render(b),x=w.popper,k=w.onUpdate;x.setAttribute("data-tippy-root",""),x.id="tippy-"+b.id,b.popper=x,e._tippy=b,x._tippy=b;var _=v.map(function(e){return e.fn(b)}),S=e.hasAttribute("aria-expanded");return F(),R(),N(),M("onCreate",[b]),c.showOnCreate&&X(),x.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),x.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&A().addEventListener("mousemove",g)}),b;function T(){var e=b.props.touch;return Array.isArray(e)?e:[e,0]}function E(){return"hold"===T()[0]}function C(){var e;return!!(null!=(e=b.props.render)&&e.$$tippy)}function A(){var t,n,r=(u||e).parentNode;return r&&null!=(n=eT(r)[0])&&null!=(t=n.ownerDocument)&&t.body?n.ownerDocument:document}function O(e){return b.state.isMounted&&!b.state.isVisible||eP.isTouch||s&&"focus"===s.type?0:ex(b.props.delay,e?0:1,eB.delay)}function N(e){void 0===e&&(e=!1),x.style.pointerEvents=b.props.interactive&&!e?"":"none",x.style.zIndex=""+b.props.zIndex}function M(e,t,n){if(void 0===n&&(n=!0),_.forEach(function(n){n[e]&&n[e].apply(n,t)}),n){var r;(r=b.props)[e].apply(r,t)}}function I(){var t=b.props.aria;if(t.content){var n="aria-"+t.content,r=x.id;eT(b.props.triggerTarget||e).forEach(function(e){var t=e.getAttribute(n);if(b.state.isVisible)e.setAttribute(n,t?t+" "+r:r);else{var o=t&&t.replace(r,"").trim();o?e.setAttribute(n,o):e.removeAttribute(n)}})}}function R(){!S&&b.props.aria.expanded&&eT(b.props.triggerTarget||e).forEach(function(t){b.props.interactive?t.setAttribute("aria-expanded",b.state.isVisible&&t===(u||e)?"true":"false"):t.removeAttribute("aria-expanded")})}function z(){A().removeEventListener("mousemove",g),eZ=eZ.filter(function(e){return e!==g})}function P(t){if(!eP.isTouch||!h&&"mousedown"!==t.type){var n=t.composedPath&&t.composedPath()[0]||t.target;if(!(b.props.interactive&&ez(x,n))){if(eT(b.props.triggerTarget||e).some(function(e){return ez(e,n)})){if(eP.isTouch||b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else M("onClickOutside",[b,t]);!0!==b.props.hideOnClick||(b.clearDelayTimeouts(),b.hide(),d=!0,setTimeout(function(){d=!1}),b.state.isMounted||$())}}}function L(){h=!0}function j(){h=!1}function D(){var e=A();e.addEventListener("mousedown",P,!0),e.addEventListener("touchend",P,eb),e.addEventListener("touchstart",j,eb),e.addEventListener("touchmove",L,eb)}function $(){var e=A();e.removeEventListener("mousedown",P,!0),e.removeEventListener("touchend",P,eb),e.removeEventListener("touchstart",j,eb),e.removeEventListener("touchmove",L,eb)}function H(e,t){var n=eY(x).box;function r(e){e.target===n&&(eR(n,"remove",r),t())}if(0===e)return t();eR(n,"remove",a),eR(n,"add",r),a=r}function B(t,n,r){void 0===r&&(r=!1),eT(b.props.triggerTarget||e).forEach(function(e){e.addEventListener(t,n,r),m.push({node:e,eventType:t,handler:n,options:r})})}function F(){E()&&(B("touchstart",V,{passive:!0}),B("touchend",q,{passive:!0})),b.props.trigger.split(/\s+/).filter(Boolean).forEach(function(e){if("manual"!==e)switch(B(e,V),e){case"mouseenter":B("mouseleave",q);break;case"focus":B(eH?"focusout":"blur",J);break;case"focusin":B("focusout",J)}})}function U(){m.forEach(function(e){var t=e.node,n=e.eventType,r=e.handler,o=e.options;t.removeEventListener(n,r,o)}),m=[]}function V(e){var t,n=!1;if(!(!b.state.isEnabled||Y(e))&&!d){var r=(null==(t=s)?void 0:t.type)==="focus";s=e,u=e.currentTarget,R(),!b.state.isVisible&&ek(e,"MouseEvent")&&eZ.forEach(function(t){return t(e)}),"click"===e.type&&(0>b.props.trigger.indexOf("mouseenter")||p)&&!1!==b.props.hideOnClick&&b.state.isVisible?n=!0:X(e),"click"===e.type&&(p=!n),n&&!r&&Q(e)}}function W(t){var n,r,o,i=t.target,s=(u||e).contains(i)||x.contains(i);("mousemove"!==t.type||!s)&&(n=Z().concat(x).map(function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:c}:null}).filter(Boolean),r=t.clientX,o=t.clientY,n.every(function(e){var t=e.popperRect,n=e.popperState,i=e.props.interactiveBorder,s=n.placement.split("-")[0],a=n.modifiersData.offset;if(!a)return!0;var l="bottom"===s?a.top.y:0,u="top"===s?a.bottom.y:0,c="right"===s?a.left.x:0,p="left"===s?a.right.x:0,d=t.top-o+l>i,h=o-t.bottom-u>i,f=t.left-r+c>i,m=r-t.right-p>i;return d||h||f||m})&&(z(),Q(t)))}function q(e){if(!(Y(e)||b.props.trigger.indexOf("click")>=0&&p)){if(b.props.interactive){b.hideWithInteractivity(e);return}Q(e)}}function J(t){0>b.props.trigger.indexOf("focusin")&&t.target!==(u||e)||b.props.interactive&&t.relatedTarget&&x.contains(t.relatedTarget)||Q(t)}function Y(e){return!!eP.isTouch&&E()!==e.type.indexOf("touch")>=0}function G(){K();var t=b.props,n=t.popperOptions,r=t.placement,o=t.offset,i=t.getReferenceClientRect,s=t.moveTransition,a=C()?eY(x).arrow:null,c=i?{getBoundingClientRect:i,contextElement:i.contextElement||u||e}:e,p=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(C()){var n=eY(x).box;["placement","reference-hidden","escaped"].forEach(function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)}),t.attributes.popper={}}}}];C()&&a&&p.push({name:"arrow",options:{element:a,padding:3}}),p.push.apply(p,(null==n?void 0:n.modifiers)||[]),b.popperInstance=em(c,x,Object.assign({},n,{placement:r,onFirstUpdate:l,modifiers:p}))}function K(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Z(){return eC(x.querySelectorAll("[data-tippy-root]"))}function X(e){b.clearDelayTimeouts(),e&&M("onTrigger",[b,e]),D();var t=O(!0),n=T(),o=n[0],i=n[1];eP.isTouch&&"hold"===o&&i&&(t=i),t?r=setTimeout(function(){b.show()},t):b.show()}function Q(e){if(b.clearDelayTimeouts(),M("onUntrigger",[b,e]),!b.state.isVisible){$();return}if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0)||!p){var t=O(!1);t?o=setTimeout(function(){b.state.isVisible&&b.hide()},t):i=requestAnimationFrame(function(){b.hide()})}}}(t,r);return n&&e.push(n),e},[]);return eN(e)?o[0]:o}eQ.defaultProps=eB,eQ.setDefaultProps=function(e){Object.keys(e).forEach(function(t){eB[t]=e[t]})},eQ.currentInput=eP,Object.assign({},ee,{effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}}),eQ.setDefaultProps({render:eG});class e0{constructor({editor:e,element:t,view:n,tippyOptions:r={},updateDelay:o=250,shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:e,state:t,from:n,to:r})=>{let{doc:o,selection:i}=t,{empty:s}=i,a=!o.textBetween(n,r).length&&(0,p.xh)(t.selection),l=this.element.contains(document.activeElement);return!!(e.hasFocus()||l)&&!s&&!a&&!!this.editor.isEditable},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;if(this.preventHide){this.preventHide=!1;return}(null==e?void 0:e.relatedTarget)&&(null===(t=this.element.parentNode)||void 0===t?void 0:t.contains(e.relatedTarget))||(null==e?void 0:e.relatedTarget)===this.editor.view.dom||this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.handleDebouncedUpdate=(e,t)=>{let n=!(null==t?void 0:t.selection.eq(e.state.selection)),r=!(null==t?void 0:t.doc.eq(e.state.doc));(n||r)&&(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(e,n,r,t)},this.updateDelay))},this.updateHandler=(e,t,n,r)=>{var o,i,s;let{state:a,composing:l}=e,{selection:u}=a;if(l||!t&&!n)return;this.createTooltip();let{ranges:c}=u,d=Math.min(...c.map(e=>e.$from.pos)),h=Math.max(...c.map(e=>e.$to.pos));if(!(null===(o=this.shouldShow)||void 0===o?void 0:o.call(this,{editor:this.editor,element:this.element,view:e,state:a,oldState:r,from:d,to:h}))){this.hide();return}null===(i=this.tippy)||void 0===i||i.setProps({getReferenceClientRect:(null===(s=this.tippyOptions)||void 0===s?void 0:s.getReferenceClientRect)||(()=>{if((0,p.EG)(a.selection)){let t=e.nodeDOM(d);if(t){let e=t.dataset.nodeViewWrapper?t:t.querySelector("[data-node-view-wrapper]");if(e&&(t=e.firstChild),t)return t.getBoundingClientRect()}}return(0,p.pr)(e,d,h)})}),this.show()},this.editor=e,this.element=t,this.view=n,this.updateDelay=o,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){let{element:e}=this.editor.options,t=!!e.parentElement;!this.tippy&&t&&(this.tippy=eQ(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){let{state:n}=e,r=n.selection.from!==n.selection.to;if(this.updateDelay>0&&r){this.handleDebouncedUpdate(e,t);return}let o=!(null==t?void 0:t.selection.eq(e.state.selection)),i=!(null==t?void 0:t.doc.eq(e.state.doc));this.updateHandler(e,o,i,t)}show(){var e;null===(e=this.tippy)||void 0===e||e.show()}hide(){var e;null===(e=this.tippy)||void 0===e||e.hide()}destroy(){var e,t;(null===(e=this.tippy)||void 0===e?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}let e1=e=>new d.Sy({key:"string"==typeof e.pluginKey?new d.H$(e.pluginKey):e.pluginKey,view:t=>new e0({view:t,...e})});p.hj.create({name:"bubbleMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[e1({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});var e2=n(67294),e3=n(73935),e4={exports:{}},e5={};e4.exports=function(){if(u)return e5;u=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=e2.useState,n=e2.useEffect,r=e2.useLayoutEffect,o=e2.useDebugValue;function i(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!e(t,r)}catch(e){return!0}}var s="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,s){var a=s(),l=t({inst:{value:a,getSnapshot:s}}),u=l[0].inst,c=l[1];return r(function(){u.value=a,u.getSnapshot=s,i(u)&&c({inst:u})},[e,a,s]),n(function(){return i(u)&&c({inst:u}),e(function(){i(u)&&c({inst:u})})},[e]),o(a),a};return e5.useSyncExternalStore=void 0!==e2.useSyncExternalStore?e2.useSyncExternalStore:s,e5}();var e9=e4.exports;let e6=(...e)=>t=>{e.forEach(e=>{"function"==typeof e?e(t):e&&(e.current=t)})},e8=({contentComponent:e})=>{let t=e9.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return e2.createElement(e2.Fragment,null,Object.values(t))};class e7 extends e2.Component{constructor(e){var t;super(e),this.editorContentRef=e2.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(null===(t=e.editor)||void 0===t?void 0:t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){let e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;let t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=function(){let e=new Set,t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t={...t,[n]:e3.createPortal(r.reactElement,r.element,n)},e.forEach(e=>e())},removeRenderer(n){let r={...t};delete r[n],t=r,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){let e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;let t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){let{editor:e,innerRef:t,...n}=this.props;return e2.createElement(e2.Fragment,null,e2.createElement("div",{ref:e6(t,this.editorContentRef),...n}),(null==e?void 0:e.contentComponent)&&e2.createElement(e8,{contentComponent:e.contentComponent}))}}let te=(0,e2.forwardRef)((e,t)=>{let n=e2.useMemo(()=>Math.floor(4294967295*Math.random()).toString(),[e.editor]);return e2.createElement(e7,{key:n,innerRef:t,...e})}),tt=e2.memo(te);var tn=(l=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(o of t.entries())if(!n.has(o[0]))return!1;for(o of t.entries())if(!e(o[1],n.get(o[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(o of t.entries())if(!n.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((r=t.length)!=n.length)return!1;for(o=r;0!=o--;)if(t[o]!==n[o])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;0!=o--;){var r,o,i,s=i[o];if(("_owner"!==s||!t.$$typeof)&&!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}).__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,tr={exports:{}},to={};tr.exports=function(){if(c)return to;c=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=e9.useSyncExternalStore,n=e2.useRef,r=e2.useEffect,o=e2.useMemo,i=e2.useDebugValue;return to.useSyncExternalStoreWithSelector=function(s,a,l,u,c){var p=n(null);if(null===p.current){var d={hasValue:!1,value:null};p.current=d}else d=p.current;var h=t(s,(p=o(function(){function t(t){if(!o){if(o=!0,n=t,t=u(t),void 0!==c&&d.hasValue){var i=d.value;if(c(i,t))return r=i}return r=t}if(i=r,e(n,t))return i;var s=u(t);return void 0!==c&&c(i,s)?i:(n=t,r=s)}var n,r,o=!1,i=void 0===l?null:l;return[function(){return t(a())},null===i?void 0:function(){return t(i())}]},[a,l,u,c]))[0],p[1]);return r(function(){d.hasValue=!0,d.value=h},[h]),i(h),h},to}();var ti=tr.exports;let ts="undefined"!=typeof window?e2.useLayoutEffect:e2.useEffect;class ta{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){let e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}}let tl="undefined"==typeof window,tu=tl||!!("undefined"!=typeof window&&window.next);class tc{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?tl||tu?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){let e={...this.options.current,onBeforeCreate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onBeforeCreate)||void 0===n?void 0:n.call(t,...e)},onBlur:(...e)=>{var t,n;return null===(n=(t=this.options.current).onBlur)||void 0===n?void 0:n.call(t,...e)},onCreate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onCreate)||void 0===n?void 0:n.call(t,...e)},onDestroy:(...e)=>{var t,n;return null===(n=(t=this.options.current).onDestroy)||void 0===n?void 0:n.call(t,...e)},onFocus:(...e)=>{var t,n;return null===(n=(t=this.options.current).onFocus)||void 0===n?void 0:n.call(t,...e)},onSelectionUpdate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onSelectionUpdate)||void 0===n?void 0:n.call(t,...e)},onTransaction:(...e)=>{var t,n;return null===(n=(t=this.options.current).onTransaction)||void 0===n?void 0:n.call(t,...e)},onUpdate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onUpdate)||void 0===n?void 0:n.call(t,...e)},onContentError:(...e)=>{var t,n;return null===(n=(t=this.options.current).onContentError)||void 0===n?void 0:n.call(t,...e)},onDrop:(...e)=>{var t,n;return null===(n=(t=this.options.current).onDrop)||void 0===n?void 0:n.call(t,...e)},onPaste:(...e)=>{var t,n;return null===(n=(t=this.options.current).onPaste)||void 0===n?void 0:n.call(t,...e)}};return new p.ML(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var r;return e===(null===(r=t.extensions)||void 0===r?void 0:r[n])}):e[n]===t[n]))}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===e.length?tc.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){let e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function tp(e={},t=[]){let n=(0,e2.useRef)(e);n.current=e;let[r]=(0,e2.useState)(()=>new tc(n)),o=e9.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return(0,e2.useDebugValue)(o),(0,e2.useEffect)(r.onRender(t)),!function(e){var t;let[n]=(0,e2.useState)(()=>new ta(e.editor)),r=ti.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,null!==(t=e.equalityFn)&&void 0!==t?t:tn);ts(()=>n.watch(e.editor),[e.editor,n]),(0,e2.useDebugValue)(r)}({editor:o,selector:({transactionNumber:t})=>!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===t?0:t+1}),o}let td=(0,e2.createContext)({editor:null});td.Consumer;let th=()=>(0,e2.useContext)(td),tf=e=>{let[t,n]=(0,e2.useState)(null),{editor:r}=th();return(0,e2.useEffect)(()=>{var n;if(!t||(null===(n=e.editor)||void 0===n?void 0:n.isDestroyed)||(null==r?void 0:r.isDestroyed))return;let{pluginKey:o="bubbleMenu",editor:i,tippyOptions:s={},updateDelay:a,shouldShow:l=null}=e,u=i||r;if(!u){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}let c=e1({updateDelay:a,editor:u,element:t,pluginKey:o,shouldShow:l,tippyOptions:s});return u.registerPlugin(c),()=>{u.unregisterPlugin(o)}},[e.editor,r,t]),e2.createElement("div",{ref:n,className:e.className,style:{visibility:"hidden"}},e.children)},tm=(0,e2.createContext)({onDragStart:void 0}),tg=()=>(0,e2.useContext)(tm);e2.forwardRef((e,t)=>{let{onDragStart:n}=tg(),r=e.as||"div";return e2.createElement(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})})},54929:function(e,t,n){"use strict";n.d(t,{Z:function(){return ey}});var r=n(5865);let o=/^\s*>\s$/,i=r.NB.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,r.S0)({find:o,type:this.type})]}}),s=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,a=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,l=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,u=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,c=r.vc.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,r.Cf)({find:s,type:this.type}),(0,r.Cf)({find:l,type:this.type})]},addPasteRules(){return[(0,r.K9)({find:a,type:this.type}),(0,r.K9)({find:u,type:this.type})]}}),p="textStyle",d=/^\s*([-+*])\s$/,h=r.NB.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(p)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=(0,r.S0)({find:d,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=(0,r.S0)({find:d,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(p),editor:this.editor})),[e]}}),f=/(^|[^`])`([^`]+)`(?!`)/,m=/(^|[^`])`([^`]+)`(?!`)/g,g=r.vc.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,r.Cf)({find:f,type:this.type})]},addPasteRules(){return[(0,r.K9)({find:m,type:this.type})]}});var y=n(2376);let v=/^```([a-z]+)?[\s\n]$/,b=/^~~~([a-z]+)?[\s\n]$/,w=r.NB.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:n}=this.options;return[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",(0,r.P1)(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!!e&&t.parent.type.name===this.name&&(!!n||!t.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:n}=t,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type)return!1;let i=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith("\n\n");return!!i&&!!s&&e.chain().command(({tr:e})=>(e.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:n,doc:r}=t,{$from:o,empty:i}=n;if(!i||o.parent.type!==this.type||o.parentOffset!==o.parent.nodeSize-2)return!1;let s=o.after();return void 0!==s&&(r.nodeAt(s)?e.commands.command(({tr:e})=>(e.setSelection(y.Y1.near(r.resolve(s))),!0)):e.commands.exitCode())}}},addInputRules(){return[(0,r.zK)({find:v,type:this.type,getAttributes:e=>({language:e[1]})}),(0,r.zK)({find:b,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new y.Sy({key:new y.H$("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=null==o?void 0:o.mode;if(!n||!i)return!1;let{tr:s,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return s.replaceSelectionWith(this.type.create({language:i},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(y.Bs.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),x=r.NB.create({name:"doc",topNode:!0,content:"block+"});var k=n(16560);class _{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t,n=this.editorView.state.doc.resolve(this.cursorPos),r=!n.parent.inlineContent,o,i=this.editorView.dom,s=i.getBoundingClientRect(),a=s.width/i.offsetWidth,l=s.height/i.offsetHeight;if(r){let e=n.nodeBefore,t=n.nodeAfter;if(e||t){let n=this.editorView.nodeDOM(this.cursorPos-(e?e.nodeSize:0));if(n){let r=n.getBoundingClientRect(),i=e?r.bottom:r.top;e&&t&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let s=this.width/2*l;o={left:r.left,right:r.right,top:i-s,bottom:i+s}}}}if(!o){let e=this.editorView.coordsAtPos(this.cursorPos),t=this.width/2*a;o={left:e.left-t,right:e.left+t,top:e.top,bottom:e.bottom}}let u=this.editorView.dom.offsetParent;if(!this.element&&(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r),u&&(u!=document.body||"static"!=getComputedStyle(u).position)){let n=u.getBoundingClientRect(),r=n.width/u.offsetWidth,o=n.height/u.offsetHeight;e=n.left-u.scrollLeft*r,t=n.top-u.scrollTop*o}else e=-pageXOffset,t=-pageYOffset;this.element.style.left=(o.left-e)/a+"px",this.element.style.top=(o.top-t)/l+"px",this.element.style.width=(o.right-o.left)/a+"px",this.element.style.height=(o.bottom-o.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,t,e):r;if(t&&!o){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=(0,k.nj)(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}let S=r.hj.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[function(e={}){return new y.Sy({view:t=>new _(t,e)})}(this.options)]}});var T=n(82696),E=n(12806),C=n(84348);class A extends y.Y1{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return A.valid(n)?new A(n):y.Y1.near(n)}content(){return E.p2.empty}eq(e){return e instanceof A&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for GapCursor.fromJSON");return new A(e.resolve(t.pos))}getBookmark(){return new O(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0==n){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){t:for(;;){if(!n&&A.valid(e))return e;let r=e.pos,o=null;for(let n=e.depth;;n--){let i=e.node(n);if(t>0?e.indexAfter(n)<i.childCount:e.index(n)>0){o=i.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let s=e.doc.resolve(r);if(A.valid(s))return s}for(;;){let i=t>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!y.qv.isSelectable(o)){e=e.doc.resolve(r+o.nodeSize*t),n=!1;continue t}break}o=i,r+=t;let s=e.doc.resolve(r);if(A.valid(s))return s}return null}}}A.prototype.visible=!1,A.findFrom=A.findGapCursorFrom,y.Y1.jsonID("gapcursor",A);class O{constructor(e){this.pos=e}map(e){return new O(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return A.valid(t)?new A(t):y.Y1.near(t)}}let N=(0,T.$)({ArrowLeft:M("horiz",-1),ArrowRight:M("horiz",1),ArrowUp:M("vert",-1),ArrowDown:M("vert",1)});function M(e,t){let n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){let i=e.selection,s=t>0?i.$to:i.$from,a=i.empty;if(i instanceof y.Bs){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}let l=A.findGapCursorFrom(s,t,a);return!!l&&(r&&r(e.tr.setSelection(new A(l))),!0)}}function I(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!A.valid(r))return!1;let o=e.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&y.qv.isSelectable(e.state.doc.nodeAt(o.inside)))&&(e.dispatch(e.state.tr.setSelection(new A(r))),!0)}function R(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof A))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let o=E.HY.empty;for(let e=r.length-1;e>=0;e--)o=E.HY.from(r[e].createAndFill(null,o));let i=e.state.tr.replace(n.pos,n.pos,new E.p2(o,0,0));return i.setSelection(y.Bs.near(i.doc.resolve(n.pos+1))),e.dispatch(i),!1}function z(e){if(!(e.selection instanceof A))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",C.EH.create(e.doc,[C.p.widget(e.selection.head,t,{key:"gapcursor"})])}let P=r.hj.create({name:"gapCursor",addProseMirrorPlugins:()=>[new y.Sy({props:{decorations:z,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&A.valid(n)?new A(n):null,handleClick:I,handleKeyDown:N,handleDOMEvents:{beforeinput:R}}})],extendNodeSchema(e){var t;let n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!==(t=(0,r.nU)((0,r.Nl)(e,"allowGapCursor",n)))&&void 0!==t?t:null}}}),L=r.NB.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",(0,r.P1)(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:e,storedMarks:o}=n;if(e.$from.parent.type.spec.isolating)return!1;let{keepMarks:i}=this.options,{splittableMarks:s}=r.extensionManager,a=o||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{if(t&&a&&i){let t=a.filter(e=>s.includes(e.type.name));e.ensureMarks(t)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),j=r.NB.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){let n=this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0];return[`h${n}`,(0,r.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>(0,r.zK)({find:RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var D=function(){};D.prototype.append=function(e){return e.length?(e=D.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},D.prototype.prepend=function(e){return e.length?D.from(e).append(this):this},D.prototype.appendInner=function(e){return new H(this,e)},D.prototype.slice=function(e,t){return(void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t)?D.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},D.prototype.get=function(e){if(!(e<0)&&!(e>=this.length))return this.getInner(e)},D.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},D.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},D.from=function(e){return e instanceof D?e:e&&e.length?new $(e):D.empty};var $=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(D);D.empty=new $([]);var H=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;if(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r)||n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;if(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o)||n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))return!1},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(D);class B{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){let n,r,o,i;if(0==this.eventCount)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}t&&(r=(n=this.remapping(s,this.items.length)).maps.length);let a=e.tr,l=[],u=[];return this.items.forEach((e,t)=>{if(!e.step){n||(r=(n=this.remapping(s,t+1)).maps.length),r--,u.push(e);return}if(n){u.push(new F(e.map));let t=e.step.map(n.slice(r)),o;t&&a.maybeStep(t).doc&&(o=a.mapping.maps[a.mapping.maps.length-1],l.push(new F(o,void 0,void 0,l.length+u.length))),r--,o&&n.appendMap(o,r)}else a.maybeStep(e.step);if(e.selection)return o=n?e.selection.map(n.slice(r)):e.selection,i=new B(this.items.slice(0,s).append(u.reverse().concat(l)),this.eventCount-1),!1},this.items.length,0),{remaining:i,transform:a,selection:o}}addTransform(e,t,n,r){var o,i;let s,a=[],l=this.eventCount,u=this.items,c=!r&&u.length?u.get(u.length-1):null;for(let n=0;n<e.steps.length;n++){let o=e.steps[n].invert(e.docs[n]),i=new F(e.mapping.maps[n],o,t),s;(s=c&&c.merge(i))&&(i=s,n?a.pop():u=u.slice(0,u.length-1)),a.push(i),t&&(l++,t=void 0),r||(c=i)}let p=l-n.depth;return p>V&&(o=u,i=p,o.forEach((e,t)=>{if(e.selection&&0==i--)return s=t,!1}),u=o.slice(s),l-=p),new B(u.append(a),l)}remapping(e,t){let n=new k.vs;return this.items.forEach((t,r)=>{let o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)},e,t),n}addMaps(e){return 0==this.eventCount?this:new B(this.items.append(e.map(e=>new F(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,s=this.eventCount;this.items.forEach(e=>{e.selection&&s--},r);let a=t;this.items.forEach(t=>{let r=o.getMirror(--a);if(null==r)return;i=Math.min(i,r);let l=o.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),u=t.selection&&t.selection.map(o.slice(a+1,r));u&&s++,n.push(new F(l,i,u))}else n.push(new F(l))},r);let l=[];for(let e=t;e<i;e++)l.push(new F(o.maps[e]));let u=new B(this.items.slice(0,r).append(l).append(n),s);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach(t=>{!t.step&&e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((i,s)=>{if(s>=e)r.push(i),i.selection&&o++;else if(i.step){let e=i.step.map(t.slice(n)),s=e&&e.getMap();if(n--,s&&t.appendMap(s,n),e){let a=i.selection&&i.selection.map(t.slice(n));a&&o++;let l=new F(s.invert(),e,a),u,c=r.length-1;(u=r.length&&r[c].merge(l))?r[c]=u:r.push(l)}}else i.map&&n--},this.items.length,0),new B(D.from(r.reverse()),o)}}B.empty=new B(D.empty,0);class F{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new F(t.getMap().invert(),t,this.selection)}}}class U{constructor(e,t,n,r,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}let V=20;function W(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,o)=>t.push(r,o));return t}function q(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}let J=!1,Y=null;function G(e){let t=e.plugins;if(Y!=t){J=!1,Y=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){J=!0;break}}return J}let K=new y.H$("history"),Z=new y.H$("closeHistory");function X(e,t){return(n,r)=>{let o=K.getState(n);if(!o||0==(e?o.undone:o.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=G(t),o=K.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),a=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),o,r),l=new U(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(s).setMeta(K,{redo:n,historyState:l})}(o,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}let Q=X(!1,!0),ee=X(!0,!0);X(!1,!1),X(!0,!1);let et=r.hj.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>Q(e,t),redo:()=>({state:e,dispatch:t})=>ee(e,t)}),addProseMirrorPlugins(){return[function(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new y.Sy({key:K,state:{init:()=>new U(B.empty,B.empty,null,0,-1),apply:(t,n,r)=>(function(e,t,n,r){let o=n.getMeta(K),i;if(o)return o.historyState;n.getMeta(Z)&&(e=new U(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(K))return s.getMeta(K).redo?new U(e.done.addTransform(n,void 0,r,G(t)),e.undone,W(n.mapping.maps),e.prevTime,e.prevComposition):new U(e.done,e.undone.addTransform(n,void 0,r,G(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(i=n.getMeta("rebased"))?new U(e.done.rebased(n,i),e.undone.rebased(n,i),q(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new U(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),q(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let o=n.getMeta("composition"),i=0==e.prevTime||!s&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),a=s?q(e.prevRanges,n.mapping):W(n.mapping.maps);return new U(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,G(t)),B.empty,a,n.time,null==o?e.prevComposition:o)}})(n,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?Q:"historyRedo"==n?ee:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),en=r.NB.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",(0,r.P1)(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!(0,r.FZ)(t,t.schema.nodes[this.name]))return!1;let{selection:n}=t,{$from:o,$to:i}=n,s=e();return 0===o.parentOffset?s.insertContentAt({from:Math.max(o.pos-1,0),to:i.pos},{type:this.name}):(0,r.EG)(n)?s.insertContentAt(i.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:e,dispatch:t})=>{var n;if(t){let{$to:t}=e.selection,r=t.end();if(t.nodeAfter)t.nodeAfter.isTextblock?e.setSelection(y.Bs.create(e.doc,t.pos+1)):t.nodeAfter.isBlock?e.setSelection(y.qv.create(e.doc,t.pos)):e.setSelection(y.Bs.create(e.doc,t.pos));else{let o=null===(n=t.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();o&&(e.insert(r,o),e.setSelection(y.Bs.create(e.doc,r+1)))}e.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(0,r.x2)({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),er=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,eo=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,ei=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,es=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,ea=r.vc.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,r.Cf)({find:er,type:this.type}),(0,r.Cf)({find:ei,type:this.type})]},addPasteRules(){return[(0,r.K9)({find:eo,type:this.type}),(0,r.K9)({find:es,type:this.type})]}}),el=r.NB.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",(0,r.P1)(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),eu="textStyle",ec=/^(\d+)\.\s$/,ep=r.NB.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){let{start:t,...n}=e;return 1===t?["ol",(0,r.P1)(this.options.HTMLAttributes,n),0]:["ol",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(eu)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=(0,r.S0)({find:ec,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=(0,r.S0)({find:ec,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(eu)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),ed=r.NB.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),eh=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,ef=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,em=r.vc.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",(0,r.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,r.Cf)({find:eh,type:this.type})]},addPasteRules(){return[(0,r.K9)({find:ef,type:this.type})]}}),eg=r.NB.create({name:"text",group:"inline"}),ey=r.hj.create({name:"starterKit",addExtensions(){let e=[];return!1!==this.options.bold&&e.push(c.configure(this.options.bold)),!1!==this.options.blockquote&&e.push(i.configure(this.options.blockquote)),!1!==this.options.bulletList&&e.push(h.configure(this.options.bulletList)),!1!==this.options.code&&e.push(g.configure(this.options.code)),!1!==this.options.codeBlock&&e.push(w.configure(this.options.codeBlock)),!1!==this.options.document&&e.push(x.configure(this.options.document)),!1!==this.options.dropcursor&&e.push(S.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&e.push(P.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&e.push(L.configure(this.options.hardBreak)),!1!==this.options.heading&&e.push(j.configure(this.options.heading)),!1!==this.options.history&&e.push(et.configure(this.options.history)),!1!==this.options.horizontalRule&&e.push(en.configure(this.options.horizontalRule)),!1!==this.options.italic&&e.push(ea.configure(this.options.italic)),!1!==this.options.listItem&&e.push(el.configure(this.options.listItem)),!1!==this.options.orderedList&&e.push(ep.configure(this.options.orderedList)),!1!==this.options.paragraph&&e.push(ed.configure(this.options.paragraph)),!1!==this.options.strike&&e.push(em.configure(this.options.strike)),!1!==this.options.text&&e.push(eg.configure(this.options.text)),e}})},22424:function(e,t,n){"use strict";n.d(t,{Z:function(){return en}});/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */let{entries:r,setPrototypeOf:o,isFrozen:i,getPrototypeOf:s,getOwnPropertyDescriptor:a}=Object,{freeze:l,seal:u,create:c}=Object,{apply:p,construct:d}="undefined"!=typeof Reflect&&Reflect;l||(l=function(e){return e}),u||(u=function(e){return e}),p||(p=function(e,t,n){return e.apply(t,n)}),d||(d=function(e,t){return new e(...t)});let h=C(Array.prototype.forEach),f=C(Array.prototype.lastIndexOf),m=C(Array.prototype.pop),g=C(Array.prototype.push),y=C(Array.prototype.splice),v=C(String.prototype.toLowerCase),b=C(String.prototype.toString),w=C(String.prototype.match),x=C(String.prototype.replace),k=C(String.prototype.indexOf),_=C(String.prototype.trim),S=C(Object.prototype.hasOwnProperty),T=C(RegExp.prototype.test),E=(Z=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return d(Z,t)});function C(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return p(e,t,r)}}function A(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;o&&o(e,null);let r=t.length;for(;r--;){let o=t[r];if("string"==typeof o){let e=n(o);e!==o&&(i(t)||(t[r]=e),o=e)}e[o]=!0}return e}function O(e){let t=c(null);for(let[n,o]of r(e))S(e,n)&&(Array.isArray(o)?t[n]=function(e){for(let t=0;t<e.length;t++)S(e,t)||(e[t]=null);return e}(o):o&&"object"==typeof o&&o.constructor===Object?t[n]=O(o):t[n]=o);return t}function N(e,t){for(;null!==e;){let n=a(e,t);if(n){if(n.get)return C(n.get);if("function"==typeof n.value)return C(n.value)}e=s(e)}return function(){return null}}let M=l(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),I=l(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),R=l(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),z=l(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),P=l(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),L=l(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),j=l(["#text"]),D=l(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),$=l(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),H=l(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),B=l(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=u(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U=u(/<%[\w\W]*|[\w\W]*%>/gm),V=u(/\$\{[\w\W]*/gm),W=u(/^data-[\-\w.\u00B7-\uFFFF]+$/),q=u(/^aria-[\-\w]+$/),J=u(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Y=u(/^(?:\w+script|data):/i),G=u(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),K=u(/^html$/i);var Z,X=Object.freeze({__proto__:null,ARIA_ATTR:q,ATTR_WHITESPACE:G,CUSTOM_ELEMENT:u(/^[a-z][.\w]*(-[.\w]+)+$/i),DATA_ATTR:W,DOCTYPE_NAME:K,ERB_EXPR:U,IS_ALLOWED_URI:J,IS_SCRIPT_OR_DATA:Y,MUSTACHE_EXPR:F,TMPLIT_EXPR:V});let Q={element:1,text:3,progressingInstruction:7,comment:8,document:9},ee=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null,r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));let o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}},et=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};var en=function e(){let t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,o=t=>e(t);if(o.version="3.2.6",o.removed=[],!n||!n.document||n.document.nodeType!==Q.document||!n.Element)return o.isSupported=!1,o;let{document:i}=n,s=i,a=s.currentScript,{DocumentFragment:u,HTMLTemplateElement:p,Node:d,Element:C,NodeFilter:F,NamedNodeMap:U=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:V,DOMParser:W,trustedTypes:q}=n,Y=C.prototype,G=N(Y,"cloneNode"),Z=N(Y,"remove"),en=N(Y,"nextSibling"),er=N(Y,"childNodes"),eo=N(Y,"parentNode");if("function"==typeof p){let e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let ei="",{implementation:es,createNodeIterator:ea,createDocumentFragment:el,getElementsByTagName:eu}=i,{importNode:ec}=s,ep=et();o.isSupported="function"==typeof r&&"function"==typeof eo&&es&&void 0!==es.createHTMLDocument;let{MUSTACHE_EXPR:ed,ERB_EXPR:eh,TMPLIT_EXPR:ef,DATA_ATTR:em,ARIA_ATTR:eg,IS_SCRIPT_OR_DATA:ey,ATTR_WHITESPACE:ev,CUSTOM_ELEMENT:eb}=X,{IS_ALLOWED_URI:ew}=X,ex=null,ek=A({},[...M,...I,...R,...P,...j]),e_=null,eS=A({},[...D,...$,...H,...B]),eT=Object.seal(c(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),eE=null,eC=null,eA=!0,eO=!0,eN=!1,eM=!0,eI=!1,eR=!0,ez=!1,eP=!1,eL=!1,ej=!1,eD=!1,e$=!1,eH=!0,eB=!1,eF=!0,eU=!1,eV={},eW=null,eq=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eJ=null,eY=A({},["audio","video","img","source","image","track"]),eG=null,eK=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),eZ="http://www.w3.org/1998/Math/MathML",eX="http://www.w3.org/2000/svg",eQ="http://www.w3.org/1999/xhtml",e0=eQ,e1=!1,e2=null,e3=A({},[eZ,eX,eQ],b),e4=A({},["mi","mo","mn","ms","mtext"]),e5=A({},["annotation-xml"]),e9=A({},["title","style","font","a","script"]),e6=null,e8=["application/xhtml+xml","text/html"],e7=null,te=null,tt=i.createElement("form"),tn=function(e){return e instanceof RegExp||e instanceof Function},tr=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!te||te!==e){if(e&&"object"==typeof e||(e={}),e=O(e),e7="application/xhtml+xml"===(e6=-1===e8.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?b:v,ex=S(e,"ALLOWED_TAGS")?A({},e.ALLOWED_TAGS,e7):ek,e_=S(e,"ALLOWED_ATTR")?A({},e.ALLOWED_ATTR,e7):eS,e2=S(e,"ALLOWED_NAMESPACES")?A({},e.ALLOWED_NAMESPACES,b):e3,eG=S(e,"ADD_URI_SAFE_ATTR")?A(O(eK),e.ADD_URI_SAFE_ATTR,e7):eK,eJ=S(e,"ADD_DATA_URI_TAGS")?A(O(eY),e.ADD_DATA_URI_TAGS,e7):eY,eW=S(e,"FORBID_CONTENTS")?A({},e.FORBID_CONTENTS,e7):eq,eE=S(e,"FORBID_TAGS")?A({},e.FORBID_TAGS,e7):O({}),eC=S(e,"FORBID_ATTR")?A({},e.FORBID_ATTR,e7):O({}),eV=!!S(e,"USE_PROFILES")&&e.USE_PROFILES,eA=!1!==e.ALLOW_ARIA_ATTR,eO=!1!==e.ALLOW_DATA_ATTR,eN=e.ALLOW_UNKNOWN_PROTOCOLS||!1,eM=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,eI=e.SAFE_FOR_TEMPLATES||!1,eR=!1!==e.SAFE_FOR_XML,ez=e.WHOLE_DOCUMENT||!1,ej=e.RETURN_DOM||!1,eD=e.RETURN_DOM_FRAGMENT||!1,e$=e.RETURN_TRUSTED_TYPE||!1,eL=e.FORCE_BODY||!1,eH=!1!==e.SANITIZE_DOM,eB=e.SANITIZE_NAMED_PROPS||!1,eF=!1!==e.KEEP_CONTENT,eU=e.IN_PLACE||!1,ew=e.ALLOWED_URI_REGEXP||J,e0=e.NAMESPACE||eQ,e4=e.MATHML_TEXT_INTEGRATION_POINTS||e4,e5=e.HTML_INTEGRATION_POINTS||e5,eT=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&tn(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(eT.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&tn(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(eT.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(eT.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eI&&(eO=!1),eD&&(ej=!0),eV&&(ex=A({},j),e_=[],!0===eV.html&&(A(ex,M),A(e_,D)),!0===eV.svg&&(A(ex,I),A(e_,$),A(e_,B)),!0===eV.svgFilters&&(A(ex,R),A(e_,$),A(e_,B)),!0===eV.mathMl&&(A(ex,P),A(e_,H),A(e_,B))),e.ADD_TAGS&&(ex===ek&&(ex=O(ex)),A(ex,e.ADD_TAGS,e7)),e.ADD_ATTR&&(e_===eS&&(e_=O(e_)),A(e_,e.ADD_ATTR,e7)),e.ADD_URI_SAFE_ATTR&&A(eG,e.ADD_URI_SAFE_ATTR,e7),e.FORBID_CONTENTS&&(eW===eq&&(eW=O(eW)),A(eW,e.FORBID_CONTENTS,e7)),eF&&(ex["#text"]=!0),ez&&A(ex,["html","head","body"]),ex.table&&(A(ex,["tbody"]),delete eE.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw E('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw E('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ei=(t=e.TRUSTED_TYPES_POLICY).createHTML("")}else void 0===t&&(t=ee(q,a)),null!==t&&"string"==typeof ei&&(ei=t.createHTML(""));l&&l(e),te=e}},to=A({},[...I,...R,...z]),ti=A({},[...P,...L]),ts=function(e){let t=eo(e);t&&t.tagName||(t={namespaceURI:e0,tagName:"template"});let n=v(e.tagName),r=v(t.tagName);return!!e2[e.namespaceURI]&&(e.namespaceURI===eX?t.namespaceURI===eQ?"svg"===n:t.namespaceURI===eZ?"svg"===n&&("annotation-xml"===r||e4[r]):!!to[n]:e.namespaceURI===eZ?t.namespaceURI===eQ?"math"===n:t.namespaceURI===eX?"math"===n&&e5[r]:!!ti[n]:e.namespaceURI===eQ?(t.namespaceURI!==eX||!!e5[r])&&(t.namespaceURI!==eZ||!!e4[r])&&!ti[n]&&(e9[n]||!to[n]):"application/xhtml+xml"===e6&&!!e2[e.namespaceURI])},ta=function(e){g(o.removed,{element:e});try{eo(e).removeChild(e)}catch(t){Z(e)}},tl=function(e,t){try{g(o.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){g(o.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e){if(ej||eD)try{ta(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},tu=function(e){let n=null,r=null;if(eL)e="<remove></remove>"+e;else{let t=w(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===e6&&e0===eQ&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");let o=t?t.createHTML(e):e;if(e0===eQ)try{n=new W().parseFromString(o,e6)}catch(e){}if(!n||!n.documentElement){n=es.createDocument(e0,"template",null);try{n.documentElement.innerHTML=e1?ei:o}catch(e){}}let s=n.body||n.documentElement;return(e&&r&&s.insertBefore(i.createTextNode(r),s.childNodes[0]||null),e0===eQ)?eu.call(n,ez?"html":"body")[0]:ez?n.documentElement:s},tc=function(e){return ea.call(e.ownerDocument||e,e,F.SHOW_ELEMENT|F.SHOW_COMMENT|F.SHOW_TEXT|F.SHOW_PROCESSING_INSTRUCTION|F.SHOW_CDATA_SECTION,null)},tp=function(e){return e instanceof V&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof U)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},td=function(e){return"function"==typeof d&&e instanceof d};function th(e,t,n){h(e,e=>{e.call(o,t,n,te)})}let tf=function(e){let t=null;if(th(ep.beforeSanitizeElements,e,null),tp(e))return ta(e),!0;let n=e7(e.nodeName);if(th(ep.uponSanitizeElement,e,{tagName:n,allowedTags:ex}),eR&&e.hasChildNodes()&&!td(e.firstElementChild)&&T(/<[/\w!]/g,e.innerHTML)&&T(/<[/\w!]/g,e.textContent)||e.nodeType===Q.progressingInstruction||eR&&e.nodeType===Q.comment&&T(/<[/\w]/g,e.data))return ta(e),!0;if(!ex[n]||eE[n]){if(!eE[n]&&tg(n)&&(eT.tagNameCheck instanceof RegExp&&T(eT.tagNameCheck,n)||eT.tagNameCheck instanceof Function&&eT.tagNameCheck(n)))return!1;if(eF&&!eW[n]){let t=eo(e)||e.parentNode,n=er(e)||e.childNodes;if(n&&t){let r=n.length;for(let o=r-1;o>=0;--o){let r=G(n[o],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,en(e))}}}return ta(e),!0}return e instanceof C&&!ts(e)||("noscript"===n||"noembed"===n||"noframes"===n)&&T(/<\/no(script|embed|frames)/i,e.innerHTML)?(ta(e),!0):(eI&&e.nodeType===Q.text&&(t=e.textContent,h([ed,eh,ef],e=>{t=x(t,e," ")}),e.textContent!==t&&(g(o.removed,{element:e.cloneNode()}),e.textContent=t)),th(ep.afterSanitizeElements,e,null),!1)},tm=function(e,t,n){if(eH&&("id"===t||"name"===t)&&(n in i||n in tt))return!1;if(eO&&!eC[t]&&T(em,t));else if(eA&&T(eg,t));else if(!e_[t]||eC[t]){if(!(tg(e)&&(eT.tagNameCheck instanceof RegExp&&T(eT.tagNameCheck,e)||eT.tagNameCheck instanceof Function&&eT.tagNameCheck(e))&&(eT.attributeNameCheck instanceof RegExp&&T(eT.attributeNameCheck,t)||eT.attributeNameCheck instanceof Function&&eT.attributeNameCheck(t))||"is"===t&&eT.allowCustomizedBuiltInElements&&(eT.tagNameCheck instanceof RegExp&&T(eT.tagNameCheck,n)||eT.tagNameCheck instanceof Function&&eT.tagNameCheck(n))))return!1}else if(eG[t]);else if(T(ew,x(n,ev,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===k(n,"data:")&&eJ[e]);else if(eN&&!T(ey,x(n,ev,"")));else if(n)return!1;return!0},tg=function(e){return"annotation-xml"!==e&&w(e,eb)},ty=function(e){th(ep.beforeSanitizeAttributes,e,null);let{attributes:n}=e;if(!n||tp(e))return;let r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:e_,forceKeepAttr:void 0},i=n.length;for(;i--;){let{name:s,namespaceURI:a,value:l}=n[i],u=e7(s),c="value"===s?l:_(l);if(r.attrName=u,r.attrValue=c,r.keepAttr=!0,r.forceKeepAttr=void 0,th(ep.uponSanitizeAttribute,e,r),c=r.attrValue,eB&&("id"===u||"name"===u)&&(tl(s,e),c="user-content-"+c),eR&&T(/((--!?|])>)|<\/(style|title)/i,c)){tl(s,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr||!eM&&T(/\/>/i,c)){tl(s,e);continue}eI&&h([ed,eh,ef],e=>{c=x(c,e," ")});let p=e7(e.nodeName);if(!tm(p,u,c)){tl(s,e);continue}if(t&&"object"==typeof q&&"function"==typeof q.getAttributeType){if(a);else switch(q.getAttributeType(p,u)){case"TrustedHTML":c=t.createHTML(c);break;case"TrustedScriptURL":c=t.createScriptURL(c)}}if(c!==l)try{a?e.setAttributeNS(a,s,c):e.setAttribute(s,c),tp(e)?ta(e):m(o.removed)}catch(t){tl(s,e)}}th(ep.afterSanitizeAttributes,e,null)},tv=function e(t){let n=null,r=tc(t);for(th(ep.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)th(ep.uponSanitizeShadowNode,n,null),tf(n),ty(n),n.content instanceof u&&e(n.content);th(ep.afterSanitizeShadowDOM,t,null)};return o.sanitize=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,i=null,a=null,l=null;if((e1=!e)&&(e="<!-->"),"string"!=typeof e&&!td(e)){if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw E("dirty is not a string, aborting")}else throw E("toString is not a function")}if(!o.isSupported)return e;if(eP||tr(n),o.removed=[],"string"==typeof e&&(eU=!1),eU){if(e.nodeName){let t=e7(e.nodeName);if(!ex[t]||eE[t])throw E("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof d)(i=(r=tu("<!---->")).ownerDocument.importNode(e,!0)).nodeType===Q.element&&"BODY"===i.nodeName?r=i:"HTML"===i.nodeName?r=i:r.appendChild(i);else{if(!ej&&!eI&&!ez&&-1===e.indexOf("<"))return t&&e$?t.createHTML(e):e;if(!(r=tu(e)))return ej?null:e$?ei:""}r&&eL&&ta(r.firstChild);let c=tc(eU?e:r);for(;a=c.nextNode();)tf(a),ty(a),a.content instanceof u&&tv(a.content);if(eU)return e;if(ej){if(eD)for(l=el.call(r.ownerDocument);r.firstChild;)l.appendChild(r.firstChild);else l=r;return(e_.shadowroot||e_.shadowrootmode)&&(l=ec.call(s,l,!0)),l}let p=ez?r.outerHTML:r.innerHTML;return ez&&ex["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&T(K,r.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+p),eI&&h([ed,eh,ef],e=>{p=x(p,e," ")}),t&&e$?t.createHTML(p):p},o.setConfig=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};tr(e),eP=!0},o.clearConfig=function(){te=null,eP=!1},o.isValidAttribute=function(e,t,n){return te||tr({}),tm(e7(e),e7(t),n)},o.addHook=function(e,t){"function"==typeof t&&g(ep[e],t)},o.removeHook=function(e,t){if(void 0!==t){let n=f(ep[e],t);return -1===n?void 0:y(ep[e],n,1)[0]}return m(ep[e])},o.removeHooks=function(e){ep[e]=[]},o.removeAllHooks=function(){ep=et()},o}()},25804:function(e,t,n){"use strict";n.d(t,{Ig:function(){return x},MI:function(){return w},N0:function(){return A},NE:function(){return a},QK:function(){return _},U9:function(){return M},X0:function(){return C},Y_:function(){return y},_M:function(){return f},al:function(){return u},cR:function(){return p},mD:function(){return E},nw:function(){return I},o:function(){return v},rr:function(){return c},uJ:function(){return z},uo:function(){return T},xb:function(){return k},ym:function(){return R}});var r,o=n(16560),i=n(12806),s=n(2376);let a=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function l(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("backward",e):!(n.parentOffset>0))?n:null}let u=(e,t,n)=>{let r=l(e,n);if(!r)return!1;let a=m(r);if(!a){let n=r.blockRange(),i=n&&(0,o.k9)(n);return null!=i&&(t&&t(e.tr.lift(n,i).scrollIntoView()),!0)}let u=a.nodeBefore;if(O(e,a,t,-1))return!0;if(0==r.parent.content.size&&(h(u,"end")||s.qv.isSelectable(u)))for(let n=r.depth;;n--){let l=(0,o.dR)(e.doc,r.before(n),r.after(n),i.p2.empty);if(l&&l.slice.size<l.to-l.from){if(t){let n=e.tr.step(l);n.setSelection(h(u,"end")?s.Y1.findFrom(n.doc.resolve(n.mapping.map(a.pos,-1)),-1):s.qv.create(n.doc,a.pos-u.nodeSize)),t(n.scrollIntoView())}return!0}if(1==n||r.node(n-1).childCount>1)break}return!!u.isAtom&&a.depth==r.depth-1&&(t&&t(e.tr.delete(a.pos-u.nodeSize,a.pos).scrollIntoView()),!0)},c=(e,t,n)=>{let r=l(e,n);if(!r)return!1;let o=m(r);return!!o&&d(e,o,t)},p=(e,t,n)=>{let r=g(e,n);if(!r)return!1;let o=b(r);return!!o&&d(e,o,t)};function d(e,t,n){let r=t.nodeBefore,a=t.pos-1;for(;!r.isTextblock;a--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let l=t.nodeAfter,u=t.pos+1;for(;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;let e=l.firstChild;if(!e)return!1;l=e}let c=(0,o.dR)(e.doc,a,u,i.p2.empty);if(!c||c.from!=a||c instanceof o.Pu&&c.slice.size>=u-a)return!1;if(n){let t=e.tr.step(c);t.setSelection(s.Bs.create(t.doc,a)),n(t.scrollIntoView())}return!0}function h(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)break}return!1}let f=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;i=m(r)}let a=i&&i.nodeBefore;return!!(a&&s.qv.isSelectable(a))&&(t&&t(e.tr.setSelection(s.qv.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)};function m(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function g(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("forward",e):!(n.parentOffset<n.parent.content.size))?n:null}let y=(e,t,n)=>{let r=g(e,n);if(!r)return!1;let a=b(r);if(!a)return!1;let l=a.nodeAfter;if(O(e,a,t,1))return!0;if(0==r.parent.content.size&&(h(l,"start")||s.qv.isSelectable(l))){let n=(0,o.dR)(e.doc,r.before(),r.after(),i.p2.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(h(l,"start")?s.Y1.findFrom(r.doc.resolve(r.mapping.map(a.pos)),1):s.qv.create(r.doc,r.mapping.map(a.pos))),t(r.scrollIntoView())}return!0}}return!!l.isAtom&&a.depth==r.depth-1&&(t&&t(e.tr.delete(a.pos,a.pos+l.nodeSize).scrollIntoView()),!0)},v=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;i=b(r)}let a=i&&i.nodeAfter;return!!(a&&s.qv.isSelectable(a))&&(t&&t(e.tr.setSelection(s.qv.create(e.doc,i.pos)).scrollIntoView()),!0)};function b(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}let w=(e,t)=>{let n=e.selection,r=n instanceof s.qv,i;if(r){if(n.node.isTextblock||!(0,o.Mn)(e.doc,n.from))return!1;i=n.from}else if(null==(i=(0,o.GJ)(e.doc,n.from,-1)))return!1;if(t){let n=e.tr.join(i);r&&n.setSelection(s.qv.create(n.doc,i-e.doc.resolve(i).nodeBefore.nodeSize)),t(n.scrollIntoView())}return!0},x=(e,t)=>{let n=e.selection,r;if(n instanceof s.qv){if(n.node.isTextblock||!(0,o.Mn)(e.doc,n.to))return!1;r=n.to}else if(null==(r=(0,o.GJ)(e.doc,n.to,1)))return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0},k=(e,t)=>{let{$from:n,$to:r}=e.selection,i=n.blockRange(r),s=i&&(0,o.k9)(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)},_=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!!(n.parent.type.spec.code&&n.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function S(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}let T=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),a=S(o.contentMatchAt(i));if(!a||!o.canReplaceWith(i,i,a))return!1;if(t){let r=n.after(),o=e.tr.replaceWith(r,r,a.createAndFill());o.setSelection(s.Y1.near(o.doc.resolve(r),1)),t(o.scrollIntoView())}return!0},E=(e,t)=>{let n=e.selection,{$from:r,$to:o}=n;if(n instanceof s.C1||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=S(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(n,i.createAndFill());a.setSelection(s.Bs.create(a.doc,n+1)),t(a.scrollIntoView())}return!0},C=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if((0,o.Ax)(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),i=r&&(0,o.k9)(r);return null!=i&&(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)},A=(e,t)=>{let{$from:n,to:r}=e.selection,o,i=n.sharedDepth(r);return 0!=i&&(o=n.before(i),t&&t(e.tr.setSelection(s.qv.create(e.doc,o))),!0)};function O(e,t,n,r){let a,l,u,c=t.nodeBefore,p=t.nodeAfter,d,f,m=c.type.spec.isolating||p.type.spec.isolating;if(!m&&(a=t.nodeBefore,l=t.nodeAfter,u=t.index(),a&&l&&a.type.compatibleContent(l.type)&&(!a.content.size&&t.parent.canReplace(u-1,u)?(n&&n(e.tr.delete(t.pos-a.nodeSize,t.pos).scrollIntoView()),!0):!!(t.parent.canReplace(u,u+1)&&(l.isTextblock||(0,o.Mn)(e.doc,t.pos)))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))))return!0;let g=!m&&t.parent.canReplace(t.index(),t.index()+1);if(g&&(d=(f=c.contentMatchAt(c.childCount)).findWrapping(p.type))&&f.matchType(d[0]||p.type).validEnd){if(n){let r=t.pos+p.nodeSize,s=i.HY.empty;for(let e=d.length-1;e>=0;e--)s=i.HY.from(d[e].create(null,s));s=i.HY.from(c.copy(s));let a=e.tr.step(new o.FC(t.pos-1,r,t.pos,r,new i.p2(s,1,0),d.length,!0)),l=a.doc.resolve(r+2*d.length);l.nodeAfter&&l.nodeAfter.type==c.type&&(0,o.Mn)(a.doc,l.pos)&&a.join(l.pos),n(a.scrollIntoView())}return!0}let y=p.type.spec.isolating||r>0&&m?null:s.Y1.findFrom(t,1),v=y&&y.$from.blockRange(y.$to),b=v&&(0,o.k9)(v);if(null!=b&&b>=t.depth)return n&&n(e.tr.lift(v,b).scrollIntoView()),!0;if(g&&h(p,"start",!0)&&h(c,"end")){let r=c,s=[];for(;s.push(r),!r.isTextblock;)r=r.lastChild;let a=p,l=1;for(;!a.isTextblock;a=a.firstChild)l++;if(r.canReplace(r.childCount,r.childCount,a.content)){if(n){let r=i.HY.empty;for(let e=s.length-1;e>=0;e--)r=i.HY.from(s[e].copy(r));n(e.tr.step(new o.FC(t.pos-s.length,t.pos+p.nodeSize,t.pos+l,t.pos+p.nodeSize-l,new i.p2(r,s.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function N(e){return function(t,n){let r=t.selection,o=e<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(t.tr.setSelection(s.Bs.create(t.doc,e<0?o.start(i):o.end(i)))),!0)}}let M=N(-1),I=N(1);function R(e,t=null){return function(n,r){let{$from:i,$to:s}=n.selection,a=i.blockRange(s),l=a&&(0,o.nd)(a,e,t);return!!l&&(r&&r(n.tr.wrap(a,l).scrollIntoView()),!0)}}function z(e,t=null){return function(n,r){let o=!1;for(let r=0;r<n.selection.ranges.length&&!o;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];n.doc.nodesBetween(i,s,(r,i)=>{if(o)return!1;if(!(!r.isTextblock||r.hasMarkup(e,t))){if(r.type==e)o=!0;else{let t=n.doc.resolve(i),r=t.index();o=t.parent.canReplaceWith(r,r+1,e)}}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];o.setBlockType(i,s,e,t)}r(o.scrollIntoView())}return!0}}function P(...e){return function(t,n,r){for(let o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}let L=P(a,u,f),j=P(a,y,v),D={Enter:P(_,E,C,(e,t)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof s.qv&&e.selection.node.isBlock)return!!(n.parentOffset&&(0,o.Ax)(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let a=[],l,u,c=!1,p=!1;for(let e=n.depth;;e--){if(n.node(e).isBlock){c=n.end(e)==n.pos+(n.depth-e),p=n.start(e)==n.pos-(n.depth-e),u=S(n.node(e-1).contentMatchAt(n.indexAfter(e-1)));let t=r&&r(i.parent,c,n);a.unshift(t||(c&&u?{type:u}:null)),l=e;break}if(1==e)return!1;a.unshift(null)}let d=e.tr;(e.selection instanceof s.Bs||e.selection instanceof s.C1)&&d.deleteSelection();let h=d.mapping.map(n.pos),f=(0,o.Ax)(d.doc,h,a.length,a);if(f||(a[0]=u?{type:u}:null,f=(0,o.Ax)(d.doc,h,a.length,a)),!f)return!1;if(d.split(h,a.length,a),!c&&p&&n.node(l).type!=u){let e=d.mapping.map(n.before(l)),t=d.doc.resolve(e);u&&n.node(l-1).canReplaceWith(t.index(),t.index()+1,u)&&d.setNodeMarkup(d.mapping.map(n.before(l)),u)}return t&&t(d.scrollIntoView()),!0}),"Mod-Enter":T,Backspace:L,"Mod-Backspace":L,"Shift-Backspace":L,Delete:j,"Mod-Delete":j,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new s.C1(e.doc))),!0)},$={"Ctrl-h":D.Backspace,"Alt-Backspace":D["Mod-Backspace"],"Ctrl-d":D.Delete,"Ctrl-Alt-Backspace":D["Mod-Delete"],"Alt-Delete":D["Mod-Delete"],"Alt-d":D["Mod-Delete"],"Ctrl-a":M,"Ctrl-e":I};for(let e in D)$[e]=D[e];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform()},82696:function(e,t,n){"use strict";n.d(t,{$:function(){return f},h:function(){return h}});for(var r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},i="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),s="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),a=0;a<10;a++)r[48+a]=r[96+a]=String(a);for(var a=1;a<=24;a++)r[a+111]="F"+a;for(var a=65;a<=90;a++)r[a]=String.fromCharCode(a+32),o[a]=String.fromCharCode(a);for(var l in r)o.hasOwnProperty(l)||(o[l]=r[l]);var u=n(2376);let c="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),p="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function d(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function h(e){return new u.Sy({props:{handleKeyDown:f(e)}})}function f(e){let t=function(e){let t=Object.create(null);for(let n in e)t[function(e){let t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(let e=0;e<i.length-1;e++){let s=i[e];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))c?o=!0:n=!0;else throw Error("Unrecognized modifier name: "+s)}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}(n)]=e[n];return t}(e);return function(e,n){var a;let l=("Esc"==(a=!(i&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||s&&n.shiftKey&&n.key&&1==n.key.length||"Unidentified"==n.key)&&n.key||(n.shiftKey?o:r)[n.keyCode]||n.key||"Unidentified")&&(a="Escape"),"Del"==a&&(a="Delete"),"Left"==a&&(a="ArrowLeft"),"Up"==a&&(a="ArrowUp"),"Right"==a&&(a="ArrowRight"),"Down"==a&&(a="ArrowDown"),a),u,c=t[d(l,n)];if(c&&c(e.state,e.dispatch,e))return!0;if(1==l.length&&" "!=l){if(n.shiftKey){let r=t[d(l,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(p&&n.ctrlKey&&n.altKey)&&(u=r[n.keyCode])&&u!=l){let r=t[d(u,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}},12806:function(e,t,n){"use strict";function r(e){this.content=e}n.d(t,{aw:function(){return H},PW:function(){return G},HY:function(){return o},vc:function(){return l},ZU:function(){return j},NB:function(){return _},Ts:function(){return x},e4:function(){return u},V_:function(){return D},p2:function(){return c}}),r.prototype={constructor:r,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return -1},get:function(e){var t=this.find(e);return -1==t?void 0:this.content[t+1]},update:function(e,t,n){var o=n&&n!=e?this.remove(n):this,i=o.find(e),s=o.content.slice();return -1==i?s.push(n||e,t):(s[i+1]=t,n&&(s[i]=n)),new r(s)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new r(n)},addToStart:function(e,t){return new r([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new r(n)},addBefore:function(e,t,n){var o=this.remove(t),i=o.content.slice(),s=o.find(e);return i.splice(-1==s?i.length:s,0,t,n),new r(i)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=r.from(e)).size?new r(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=r.from(e)).size?new r(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=r.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},r.from=function(e){if(e instanceof r)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new r(t)};class o{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,n,r=0,o){for(let i=0,s=0;s<t;i++){let a=this.content[i],l=s+a.nodeSize;if(l>e&&!1!==n(a,r+s,o||null,i)&&a.content.size){let o=s+1;a.nodesBetween(Math.max(0,e-o),Math.min(a.content.size,t-o),n,r+o)}s=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let o="",i=!0;return this.nodesBetween(e,t,(s,a)=>{let l=s.isText?s.text.slice(Math.max(e,a)-a,t-a):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(i?i=!1:o+=n),o+=l},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),i=1);i<e.content.length;i++)r.push(e.content[i]);return new o(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let o=0,i=0;i<t;o++){let s=this.content[o],a=i+s.nodeSize;a>e&&((i<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),r+=s.nodeSize),i=a}return new o(n,r)}cutByIndex(e,t){return e==t?o.empty:0==e&&t==this.content.length?this:new o(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),i=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new o(r,i)}addToStart(e){return new o([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new o(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return function e(t,n,r){for(let o=0;;o++){if(o==t.childCount||o==n.childCount)return t.childCount==n.childCount?null:r;let i=t.child(o),s=n.child(o);if(i==s){r+=i.nodeSize;continue}if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(let e=0;i.text[e]==s.text[e];e++)r++;return r}if(i.content.size||s.content.size){let t=e(i.content,s.content,r+1);if(null!=t)return t}r+=i.nodeSize}}(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return function e(t,n,r,o){for(let i=t.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};let a=t.child(--i),l=n.child(--s),u=a.nodeSize;if(a==l){r-=u,o-=u;continue}if(!a.sameMarkup(l))return{a:r,b:o};if(a.isText&&a.text!=l.text){let e=0,t=Math.min(a.text.length,l.text.length);for(;e<t&&a.text[a.text.length-e-1]==l.text[l.text.length-e-1];)e++,r--,o--;return{a:r,b:o}}if(a.content.size||l.content.size){let t=e(a.content,l.content,r-1,o-1);if(t)return t}r-=u,o-=u}}(this,e,t,n)}findIndex(e,t=-1){if(0==e)return s(0,e);if(e==this.size)return s(this.content.length,e);if(e>this.size||e<0)throw RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let o=r+this.child(n).nodeSize;if(o>=e){if(o==e||t>0)return s(n+1,o);return s(n,r)}r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return o.empty;if(!Array.isArray(t))throw RangeError("Invalid input for Fragment.fromJSON");return new o(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return o.empty;let t,n=0;for(let r=0;r<e.length;r++){let o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new o(t||e,n)}static from(e){if(!e)return o.empty;if(e instanceof o)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new o([e],e.nodeSize);throw RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}o.empty=new o([],0);let i={index:0,offset:0};function s(e,t){return i.index=e,i.offset=t,i}function a(e,t){if(e===t)return!0;if(!(e&&"object"==typeof e)||!(t&&"object"==typeof t))return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!a(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!a(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class l{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&a(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return l.none;if(e instanceof l)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}l.none=[];class u extends Error{}class c{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=function e(t,n,r,o){let{index:i,offset:s}=t.findIndex(n),a=t.maybeChild(i);if(s==n||a.isText)return o&&!o.canReplace(i,i,r)?null:t.cut(0,n).append(r).append(t.cut(n));let l=e(a.content,n-s-1,r);return l&&t.replaceChild(i,a.copy(l))}(this.content,e+this.openStart,t);return n&&new c(n,this.openStart,this.openEnd)}removeBetween(e,t){return new c(function e(t,n,r){let{index:o,offset:i}=t.findIndex(n),s=t.maybeChild(o),{index:a,offset:l}=t.findIndex(r);if(i==n||s.isText){if(l!=r&&!t.child(a).isText)throw RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(o!=a)throw RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(e(s.content,n-i-1,r-i-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return c.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw RangeError("Invalid input for Slice.fromJSON");return new c(o.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let n=e.lastChild;n&&!n.isLeaf&&(t||!n.type.spec.isolating);n=n.lastChild)r++;return new c(e,n,r)}}function p(e,t){if(!t.type.compatibleContent(e.type))throw new u("Cannot join "+t.type.name+" onto "+e.type.name)}function d(e,t,n){let r=e.node(n);return p(r,t.node(n)),r}function h(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function f(e,t,n,r){let o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(h(e.nodeAfter,r),i++));for(let e=i;e<s;e++)h(o.child(e),r);t&&t.depth==n&&t.textOffset&&h(t.nodeBefore,r)}function m(e,t){return e.type.checkContent(t),e.copy(t)}function g(e,t,n){let r=[];return f(null,e,n,r),e.depth>n&&h(m(d(e,t,n+1),g(e,t,n+1)),r),f(t,null,n,r),new o(r)}c.empty=new c(o.empty,0,0);class y{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)r+=n.child(t).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return l.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new x(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw RangeError("Position "+t+" out of range");let n=[],r=0,o=t;for(let t=e;;){let{index:e,offset:i}=t.content.findIndex(o),s=o-i;if(n.push(t,e,r+i),!s||(t=t.child(e)).isText)break;o=s-1,r+=i+1}return new y(t,n,o)}static resolveCached(e,t){let n=w.get(e);if(n)for(let e=0;e<n.elts.length;e++){let r=n.elts[e];if(r.pos==t)return r}else w.set(e,n=new v);let r=n.elts[n.i]=y.resolve(e,t);return n.i=(n.i+1)%b,r}}class v{constructor(){this.elts=[],this.i=0}}let b=12,w=new WeakMap;class x{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let k=Object.create(null);class _{constructor(e,t,n,r=l.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||o.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&a(this.attrs,t||e.defaultAttrs||k)&&l.sameSet(this.marks,n||l.none)}copy(e=null){return e==this.content?this:new _(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new _(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return c.empty;let r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i);return new c(r.node(i).content.cut(r.pos-s,o.pos-s),r.depth-i,o.depth-i)}replace(e,t,n){return function(e,t,n){if(n.openStart>e.depth)throw new u("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new u("Inconsistent open depths");return function e(t,n,r,i){let s=t.index(i),a=t.node(i);if(s==n.index(i)&&i<t.depth-r.openStart){let o=e(t,n,r,i+1);return a.copy(a.content.replaceChild(s,o))}if(!r.content.size)return m(a,g(t,n,i));if(r.openStart||r.openEnd||t.depth!=i||n.depth!=i){let{start:e,end:s}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let e=n-1;e>=0;e--)r=t.node(e).copy(o.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(r,t);return m(a,function e(t,n,r,i,s){let a=t.depth>s&&d(t,n,s+1),l=i.depth>s&&d(r,i,s+1),u=[];return f(null,t,s,u),a&&l&&n.index(s)==r.index(s)?(p(a,l),h(m(a,e(t,n,r,i,s+1)),u)):(a&&h(m(a,g(t,n,s+1)),u),f(n,r,s,u),l&&h(m(l,g(r,i,s+1)),u)),f(i,null,s,u),new o(u)}(t,e,s,n,i))}{let e=t.parent,o=e.content;return m(e,o.cut(0,t.parentOffset).append(r.content).append(o.cut(n.parentOffset)))}}(e,t,n,0)}(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(!(t=t.maybeChild(n)))return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return y.resolveCached(this,e)}resolveNoCache(e){return y.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),T(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=o.empty,r=0,i=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,r,i),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let e=r;e<i;e++)if(!this.type.allowsMarks(n.child(e).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=l.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!l.sameSet(e,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){let n;if(!t)throw RangeError("Invalid input for Node.fromJSON");if(t.marks){if(!Array.isArray(t.marks))throw RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=o.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,r,n);return i.type.checkAttrs(i.attrs),i}}_.prototype.text=void 0;class S extends _{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):T(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new S(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new S(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function T(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class E{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){var n;let r,o=new C(e,t);if(null==o.next)return E.empty;let i=function e(t){let n=[];do n.push(function(t){let n=[];do n.push(function(t){let n=function(t){if(t.eat("(")){let n=e(t);return t.eat(")")||t.err("Missing closing paren"),n}if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=(function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let o=[];for(let e in n){let r=n[e];r.isInGroup(t)&&o.push(r)}return 0==o.length&&e.err("No node type or group '"+t+"' found"),o})(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}}(t);for(;;)if(t.eat("+"))n={type:"plus",expr:n};else if(t.eat("*"))n={type:"star",expr:n};else if(t.eat("?"))n={type:"opt",expr:n};else if(t.eat("{"))n=function(e,t){let n=A(e),r=n;return e.eat(",")&&(r="}"!=e.next?A(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}(t,n);else break;return n}(t));while(t.next&&")"!=t.next&&"|"!=t.next);return 1==n.length?n[0]:{type:"seq",exprs:n}}(t));while(t.eat("|"));return 1==n.length?n[0]:{type:"choice",exprs:n}}(o);o.next&&o.err("Unexpected trailing text");let s=(n=function(e){let t=[[]];return o(function e(t,i){if("choice"==t.type)return t.exprs.reduce((t,n)=>t.concat(e(n,i)),[]);if("seq"==t.type)for(let r=0;;r++){let s=e(t.exprs[r],i);if(r==t.exprs.length-1)return s;o(s,i=n())}else if("star"==t.type){let s=n();return r(i,s),o(e(t.expr,s),s),[r(s)]}else if("plus"==t.type){let s=n();return o(e(t.expr,i),s),o(e(t.expr,s),s),[r(s)]}else if("opt"==t.type)return[r(i)].concat(e(t.expr,i));else if("range"==t.type){let s=i;for(let r=0;r<t.min;r++){let r=n();o(e(t.expr,s),r),s=r}if(-1==t.max)o(e(t.expr,s),s);else for(let i=t.min;i<t.max;i++){let i=n();r(s,i),o(e(t.expr,s),i),s=i}return[r(s)]}else if("name"==t.type)return[r(i,void 0,t.value)];else throw Error("Unknown expr type")}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach(e=>e.to=t)}}(i),r=Object.create(null),function e(t){let o=[];t.forEach(e=>{n[e].forEach(({term:e,to:t})=>{let r;if(e){for(let t=0;t<o.length;t++)o[t][0]==e&&(r=o[t][1]);N(n,t).forEach(t=>{r||o.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})}})});let i=r[t.join(",")]=new E(t.indexOf(n.length-1)>-1);for(let t=0;t<o.length;t++){let n=o[t][1].sort(O);i.next.push({type:o[t][0],next:r[n.join(",")]||e(n)})}return i}(N(n,0)));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],o=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:s}=e.next[t];i.push(n.name),o&&!(n.isText||n.hasRequiredAttrs())&&(o=!1),-1==r.indexOf(s)&&r.push(s)}o&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,o),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function i(s,a){let l=s.matchFragment(e,n);if(l&&(!t||l.validEnd))return o.from(a.map(e=>e.createAndFill()));for(let e=0;e<s.next.length;e++){let{type:t,next:n}=s.next[e];if(!(t.isText||t.hasRequiredAttrs())&&-1==r.indexOf(n)){r.push(n);let e=i(n,a.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<o.next.length;e++){let{type:i,next:s}=o.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||r.type&&!s.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return!function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let n=0;n<t.next.length;n++)r+=(n?", ":"")+t.next[n].type.name+"->"+e.indexOf(t.next[n].next);return r}).join("\n")}}E.empty=new E(!0);class C{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw SyntaxError(e+" (in content expression '"+this.string+"')")}}function A(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function O(e,t){return t-e}function N(e,t){let n=[];return function t(r){let o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(let e=0;e<o.length;e++){let{term:r,to:i}=o[e];r||-1!=n.indexOf(i)||t(i)}}(t),n.sort(O)}function M(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function I(e,t){let n=Object.create(null);for(let r in e){let o=t&&t[r];if(void 0===o){let t=e[r];if(t.hasDefault)o=t.default;else throw RangeError("No value supplied for attribute "+r)}n[r]=o}return n}function R(e,t,n,r){for(let r in t)if(!(r in e))throw RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let n in e){let r=e[n];r.validate&&r.validate(t[n])}}function z(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new L(e,r,t[r]);return n}class P{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=z(e,n.attrs),this.defaultAttrs=M(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==E.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:I(this.attrs,e)}create(e=null,t,n){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new _(this,this.computeAttrs(e),o.from(t),l.setFrom(n))}createChecked(e=null,t,n){return t=o.from(t),this.checkContent(t),new _(this,this.computeAttrs(e),t,l.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=o.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),i=r&&r.fillBefore(o.empty,!0);return i?new _(this,e,t.append(i),l.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let t=0;t<e.childCount;t++)if(!this.allowsMarks(e.child(t).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){R(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){let t;if(null==this.markSet)return e;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:l.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,r)=>n[e]=new P(e,t,r));let r=t.spec.topNode||"doc";if(!n[r])throw RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw RangeError("Every schema needs a 'text' type");for(let e in n.text.attrs)throw RangeError("The text node type should not have attributes");return n}}class L{constructor(e,t,n){let r;this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?(r=n.validate.split("|"),n=>{let o=null===n?"null":typeof n;if(0>r.indexOf(o))throw RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${o}`)}):n.validate}get isRequired(){return!this.hasDefault}}class j{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=z(e,r.attrs),this.excluded=null;let o=M(this.attrs);this.instance=o?new l(this,o):null}create(e=null){return!e&&this.instance?this.instance:new l(this,I(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,o)=>n[e]=new j(e,r++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){R(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class D{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let n in e)t[n]=e[n];t.nodes=r.from(e.nodes),t.marks=r.from(e.marks||{}),this.nodes=P.compile(this.spec.nodes,this),this.marks=j.compile(this.spec.marks,this);let n=Object.create(null);for(let e in this.nodes){if(e in this.marks)throw RangeError(e+" can not be both a node and a mark");let t=this.nodes[e],r=t.spec.content||"",o=t.spec.marks;if(t.contentMatch=n[r]||(n[r]=E.parse(r,this.nodes)),t.inlineContent=t.contentMatch.inlineContent,t.spec.linebreakReplacement){if(this.linebreakReplacement)throw RangeError("Multiple linebreak nodes defined");if(!t.isInline||!t.isLeaf)throw RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=t}t.markSet="_"==o?null:o?$(this,o.split(" ")):""!=o&&t.inlineContent?null:[]}for(let e in this.marks){let t=this.marks[e],n=t.spec.excludes;t.excluded=null==n?[t]:""==n?[]:$(this,n.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else if(e instanceof P){if(e.schema!=this)throw RangeError("Node type from different schema used ("+e.name+")")}else throw RangeError("Invalid node type: "+e);return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new S(n,n.defaultAttrs,e,l.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return _.fromJSON(this,e)}markFromJSON(e){return l.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw RangeError("Unknown node type: "+e);return t}}function $(e,t){let n=[];for(let r=0;r<t.length;r++){let o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(let t in e.marks){let r=e.marks[t];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=r)}if(!s)throw SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class H{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(null!=e.tag)this.tags.push(e);else if(null!=e.style){let t=/[^=]*/.exec(e.style)[0];0>n.indexOf(t)&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new q(this,t,!1);return n.addAll(e,l.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new q(this,t,!0);return n.addAll(e,l.none,t.from,t.to),c.maxOpen(n.finish())}matchTag(e,t,n){for(let o=n?this.tags.indexOf(n)+1:0;o<this.tags.length;o++){var r;let n=this.tags[o];if(r=n.tag,(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,r)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(0==i.indexOf(e)&&(!r.context||n.matchesContext(r.context))&&(!(i.length>e.length)||61==i.charCodeAt(e.length)&&i.slice(e.length+1)==t)){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let t in e.marks){let r=e.marks[t].spec.parseDOM;r&&r.forEach(e=>{n(e=J(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)})}for(let t in e.nodes){let r=e.nodes[t].spec.parseDOM;r&&r.forEach(e=>{n(e=J(e)),e.node||e.ignore||e.mark||(e.node=t)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new H(e,H.schemaRules(e)))}}let B={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},F={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},U={ol:!0,ul:!0};function V(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class W{constructor(e,t,n,r,o,i){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=l.none,this.match=o||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(o.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let t=this.type.contentMatch,n;return(n=t.findWrapping(e.type))?(this.match=t,n):null}}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e=this.content[this.content.length-1],t;e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-t[0].length)))}let t=o.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(o.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!B.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class q{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r=t.topNode,o,i=V(null,t.preserveWhitespace,0)|(n?4:0);o=r?new W(r.type,r.attrs,l.none,!0,t.topMatch||r.type.contentMatch,i):n?new W(null,null,l.none,!0,null,i):new W(e.schema.topNodeType,null,l.none,!0,null,i),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===o||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)n="full"!==o?n.replace(/\r?\n|\r/g," "):n.replace(/\r\n?/g,"\n");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],o=e.previousSibling;(!t||o&&"BR"==o.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,o=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i=e.nodeName.toLowerCase(),s;U.hasOwnProperty(i)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&U.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,n));n:if(a?a.ignore:F.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,r=this.needsBlock;if(B.hasOwnProperty(i))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break n}let s=a&&a.skip?t:this.readStyles(e,t);s&&this.addAll(e,s),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?s:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let e=0;e<this.parser.matchedStyles.length;e++){let r=this.parser.matchedStyles[e],o=n.getPropertyValue(r);if(o)for(let e;;){let n=this.parser.matchStyle(r,o,this,e);if(!n)break;if(n.ignore)return null;if(t=n.clearMark?t.filter(e=>!n.clearMark(e)):t.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1===n.consuming)e=n;else break}}return t}addElementByRule(e,t,n,r){let o,i;if(t.node){if((i=this.parser.schema.nodes[t.node]).isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(o=!0,n=e)}}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let s=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}o&&this.sync(s)&&this.open--}addAll(e,t,n,r){let o=n||0;for(let i=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i,t);this.findAtPoint(e,o)}findPlace(e,t,n){let r,o;for(let t=this.open,i=0;t>=0;t--){let s=this.nodes[t],a=s.findWrapping(e);if(a&&(!r||r.length>a.length+i)&&(r=a,o=s,!a.length))break;if(s.solid){if(n)break;i+=2}}if(!r)return null;this.sync(o);for(let e=0;e<r.length;e++)t=this.enterInner(r[e],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=l.none;for(let o of r.concat(e.marks))(t.type?t.type.allowsMarkType(o.type):Y(o.type,e.type))&&(n=o.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let o=this.findPlace(e.create(t),n,!1);return o&&(o=this.enterInner(e,t,n,!0,r)),o}enterInner(e,t,n,r=!1,o){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let s=V(e,o,i.options);4&i.options&&0==i.content.length&&(s|=4);let a=l.none;return n=n.filter(t=>(i.type?!i.type.allowsMarkType(t.type):!Y(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new W(e,t,a,r,null,s)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),i=(e,s)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;s>=o;s--)if(i(e-1,s))return!0;return!1}{let e=s>0||0==s&&r?this.nodes[s].type:n&&s>=o?n.node(s-o).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;s--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}}function J(e){let t={};for(let n in e)t[n]=e[n];return t}function Y(e,t){let n=t.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(e))continue;let i=[],s=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:o}=e.edge(n);if(r==t||0>i.indexOf(o)&&s(o))return!0}};if(s(o.contentMatch))return!0}}class G{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=Z(t).createDocumentFragment());let r=n,o=[];return e.forEach(e=>{if(o.length||e.marks.length){let n=0,i=0;for(;n<o.length&&i<e.marks.length;){let t=e.marks[i];if(!this.marks[t.type.name]){i++;continue}if(!t.eq(o[n][0])||!1===t.type.spec.spanning)break;n++,i++}for(;n<o.length;)r=o.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],s=this.serializeMark(n,e.isInline,t);s&&(o.push([n,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=Q(Z(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&Q(Z(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return Q(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new G(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=K(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return K(e.marks)}}function K(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Z(e){return e.document||window.document}let X=new WeakMap;function Q(e,t,n,r){let o,i,s;if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let a=t[0],l;if("string"!=typeof a)throw RangeError("Invalid array passed to renderSpec");if(r&&(void 0===(i=X.get(r))&&X.set(r,(s=null,function e(t){if(t&&"object"==typeof t){if(Array.isArray(t)){if("string"==typeof t[0])s||(s=[]),s.push(t);else for(let n=0;n<t.length;n++)e(t[n])}else for(let n in t)e(t[n])}}(r),i=s)),l=i)&&l.indexOf(t)>-1)throw RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let u=a.indexOf(" ");u>0&&(n=a.slice(0,u),a=a.slice(u+1));let c=n?e.createElementNS(n,a):e.createElement(a),p=t[1],d=1;if(p&&"object"==typeof p&&null==p.nodeType&&!Array.isArray(p)){for(let e in d=2,p)if(null!=p[e]){let t=e.indexOf(" ");t>0?c.setAttributeNS(e.slice(0,t),e.slice(t+1),p[e]):c.setAttribute(e,p[e])}}for(let i=d;i<t.length;i++){let s=t[i];if(0===s){if(i<t.length-1||i>d)throw RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}{let{dom:t,contentDOM:i}=Q(e,s,n,r);if(c.appendChild(t),i){if(o)throw RangeError("Multiple content holes");o=i}}}return{dom:c,contentDOM:o}}},53833:function(e,t,n){"use strict";n.d(t,{IB:function(){return s},KI:function(){return i},bw:function(){return a}});var r=n(16560),o=n(12806);function i(e,t=null){return function(n,i){let{$from:s,$to:a}=n.selection,l=s.blockRange(a);if(!l)return!1;let u=i?n.tr:null;return!!function(e,t,n,i=null){let s=!1,a=t,l=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=l.resolve(t.start-2);a=new o.Ts(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new o.Ts(t.$from,l.resolve(t.$to.end(t.depth)),t.depth)),s=!0}let u=(0,r.nd)(a,n,i,t);return!!u&&(e&&function(e,t,n,i,s){let a=o.HY.empty;for(let e=n.length-1;e>=0;e--)a=o.HY.from(n[e].type.create(n[e].attrs,a));e.step(new r.FC(t.start-(i?2:0),t.end,t.start,t.end,new o.p2(a,0,0),n.length,!0));let l=0;for(let e=0;e<n.length;e++)n[e].type==s&&(l=e+1);let u=n.length-l,c=t.start+n.length-(i?2:0),p=t.parent;for(let n=t.startIndex,o=t.endIndex,i=!0;n<o;n++,i=!1)!i&&(0,r.Ax)(e.doc,c,u)&&(e.split(c,u),c+=2*u),c+=p.child(n).nodeSize}(e,t,u,s,n),!0)}(u,l,e,t)&&(i&&i(u.scrollIntoView()),!0)}}function s(e){return function(t,n){let{$from:i,$to:s}=t.selection,a=i.blockRange(s,t=>t.childCount>0&&t.firstChild.type==e);return!!a&&(!n||(i.node(a.depth-1).type==e?function(e,t,n,i){let s=e.tr,a=i.end,l=i.$to.end(i.depth);a<l&&(s.step(new r.FC(a-1,l,a,l,new o.p2(o.HY.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new o.Ts(s.doc.resolve(i.$from.pos),s.doc.resolve(l),i.depth));let u=(0,r.k9)(i);if(null==u)return!1;s.lift(i,u);let c=s.doc.resolve(s.mapping.map(a,-1)-1);return(0,r.Mn)(s.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&s.join(c.pos),t(s.scrollIntoView()),!0}(t,n,e,a):function(e,t,n){let i=e.tr,s=n.parent;for(let e=n.end,t=n.endIndex-1,r=n.startIndex;t>r;t--)e-=s.child(t).nodeSize,i.delete(e-1,e+1);let a=i.doc.resolve(n.start),l=a.nodeAfter;if(i.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;let u=0==n.startIndex,c=n.endIndex==s.childCount,p=a.node(-1),d=a.index(-1);if(!p.canReplace(d+(u?0:1),d+1,l.content.append(c?o.HY.empty:o.HY.from(s))))return!1;let h=a.pos,f=h+l.nodeSize;return i.step(new r.FC(h-(u?1:0),f+(c?1:0),h+1,f-1,new o.p2((u?o.HY.empty:o.HY.from(s.copy(o.HY.empty))).append(c?o.HY.empty:o.HY.from(s.copy(o.HY.empty))),u?0:1,c?0:1),u?0:1)),t(i.scrollIntoView()),!0}(t,n,a)))}}function a(e){return function(t,n){let{$from:i,$to:s}=t.selection,a=i.blockRange(s,t=>t.childCount>0&&t.firstChild.type==e);if(!a)return!1;let l=a.startIndex;if(0==l)return!1;let u=a.parent,c=u.child(l-1);if(c.type!=e)return!1;if(n){let i=c.lastChild&&c.lastChild.type==u.type,s=o.HY.from(i?e.create():null),l=new o.p2(o.HY.from(e.create(null,o.HY.from(u.type.create(null,s)))),i?3:1,0),p=a.start,d=a.end;n(t.tr.step(new r.FC(p-(i?3:1),d,p,d,l,1,!0)).scrollIntoView())}return!0}}},2376:function(e,t,n){"use strict";n.d(t,{Bs:function(){return c},C1:function(){return f},H$:function(){return C},Sy:function(){return S},Y1:function(){return s},qv:function(){return d},xm:function(){return a},yy:function(){return _}});var r=n(12806),o=n(16560);let i=Object.create(null);class s{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new a(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=r.p2.empty){let n=t.content.lastChild,o=null;for(let e=0;e<t.openEnd;e++)o=n,n=n.lastChild;let i=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:u}=s[a],c=e.mapping.slice(i);e.replaceRange(c.map(l.pos),c.map(u.pos),a?r.p2.empty:t),0==a&&y(e,i,(n?n.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],a=e.mapping.slice(n),l=a.map(i.pos),u=a.map(s.pos);o?e.deleteRange(l,u):(e.replaceRangeWith(l,u,t),y(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new c(e):g(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let r=e.depth-1;r>=0;r--){let o=t<0?g(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):g(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new f(e.node(0))}static atStart(e){return g(e,e,0,0,1)||new f(e)}static atEnd(e){return g(e,e,e.content.size,e.childCount,-1)||new f(e)}static fromJSON(e,t){if(!t||!t.type)throw RangeError("Invalid input for Selection.fromJSON");let n=i[t.type];if(!n)throw RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in i)throw RangeError("Duplicate use of selection JSON ID "+e);return i[e]=t,t.prototype.jsonID=e,t}getBookmark(){return c.between(this.$anchor,this.$head).getBookmark()}}s.prototype.visible=!0;class a{constructor(e,t){this.$from=e,this.$to=t}}let l=!1;function u(e){l||e.parent.inlineContent||(l=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class c extends s{constructor(e,t=e){u(e),u(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return s.near(n);let r=e.resolve(t.map(this.anchor));return new c(r.parent.inlineContent?r:n,n)}replace(e,t=r.p2.empty){if(super.replace(e,t),t==r.p2.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof c&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new p(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new c(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if((!n||r)&&(n=r>=0?1:-1),!t.parent.inlineContent){let e=s.findFrom(t,n,!0)||s.findFrom(t,-n,!0);if(!e)return s.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r?e=t:(e=(s.findFrom(e,-n,!0)||s.findFrom(e,n,!0)).$anchor).pos<t.pos==r<0||(e=t)),new c(e,t)}}s.jsonID("text",c);class p{constructor(e,t){this.anchor=e,this.head=t}map(e){return new p(e.map(this.anchor),e.map(this.head))}resolve(e){return c.between(e.resolve(this.anchor),e.resolve(this.head))}}class d extends s{constructor(e){let t=e.nodeAfter;super(e,e.node(0).resolve(e.pos+t.nodeSize)),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),o=e.resolve(r);return n?s.near(o):new d(o)}content(){return new r.p2(r.HY.from(this.node),0,0)}eq(e){return e instanceof d&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new h(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new d(e.resolve(t.anchor))}static create(e,t){return new d(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}d.prototype.visible=!1,s.jsonID("node",d);class h{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new p(n,n):new h(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&d.isSelectable(n)?new d(t):s.near(t)}}class f extends s{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=r.p2.empty){if(t==r.p2.empty){e.delete(0,e.doc.content.size);let t=s.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new f(e)}map(e){return new f(e)}eq(e){return e instanceof f}getBookmark(){return m}}s.jsonID("all",f);let m={map(){return this},resolve:e=>new f(e)};function g(e,t,n,r,o,i=!1){if(t.inlineContent)return c.create(e,n);for(let s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){let r=t.child(s);if(r.isAtom){if(!i&&d.isSelectable(r))return d.create(e,n-(o<0?r.nodeSize:0))}else{let t=g(e,r,n+o,o<0?r.childCount:0,o,i);if(t)return t}n+=r.nodeSize*o}return null}function y(e,t,n){let r,i=e.steps.length-1;if(i<t)return;let a=e.steps[i];(a instanceof o.Pu||a instanceof o.FC)&&(e.mapping.maps[i].forEach((e,t,n,o)=>{null==r&&(r=o)}),e.setSelection(s.near(e.doc.resolve(r),n)))}class v extends o.wx{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return r.vc.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||r.vc.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let e=this.doc.resolve(t);o=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(s.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function b(e,t){return t&&e?e.bind(t):e}class w{constructor(e,t,n){this.name=e,this.init=b(t.init,n),this.apply=b(t.apply,n)}}let x=[new w("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new w("selection",{init:(e,t)=>e.selection||s.atStart(t.doc),apply:e=>e.selection}),new w("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new w("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class k{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=x.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new w(e.key,e.spec.state,e))})}}class _{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let s=this.config.plugins[i];if(s.spec.appendTransaction){let a=r?r[i].n:0,l=r?r[i].state:this,u=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,l,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let t=new _(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new v(this)}static create(e){let t=new k(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new _(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new k(this.schema,e.plugins),n=t.fields,r=new _(t);for(let t=0;t<n.length;t++){let o=n[t].name;r[o]=this.hasOwnProperty(o)?this[o]:n[t].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw RangeError("Required config field 'schema' missing");let o=new k(e.schema,e.plugins),i=new _(o);return o.fields.forEach(o=>{if("doc"==o.name)i.doc=r.NB.fromJSON(e.schema,t.doc);else if("selection"==o.name)i.selection=s.fromJSON(i.doc,t.selection);else if("storedMarks"==o.name)t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let r in n){let s=n[r],a=s.spec.state;if(s.key==o.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,r)){i[o.name]=a.fromJSON.call(s,e,t[r],i);return}}i[o.name]=o.init(e,i)}}),i}}class S{constructor(e){this.spec=e,this.props={},e.props&&function e(t,n,r){for(let o in t){let i=t[o];i instanceof Function?i=i.bind(n):"handleDOMEvents"==o&&(i=e(i,n,{})),r[o]=i}return r}(e.props,this,this.props),this.key=e.key?e.key.key:E("plugin")}getState(e){return e[this.key]}}let T=Object.create(null);function E(e){return e in T?e+"$"+ ++T[e]:(T[e]=0,e+"$")}class C{constructor(e="key"){this.key=E(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}},16560:function(e,t,n){"use strict";n.d(t,{Ax:function(){return S},FC:function(){return g},GJ:function(){return C},Mn:function(){return T},Pu:function(){return m},dR:function(){return O},k9:function(){return b},nd:function(){return w},nj:function(){return A},vs:function(){return s},wx:function(){return H}});var r=n(12806);class o{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class i{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&i.empty)return i.empty}recover(e){let t=0,n=65535&e;if(!this.inverted)for(let e=0;e<n;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*n]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let u=this.ranges[a+i],c=this.ranges[a+s],p=l+u;if(e<=p){let i=u?e==l?-1:e==p?1:t:t,s=l+r+(i<0?0:c);if(n)return s;let d=e==(t<0?l:p)?null:a/3+(e-l)*65536,h=e==l?2:e==p?1:4;return(t<0?e!=l:e!=p)&&(h|=8),new o(s,h,d)}r+=c-u}return n?e+r:new o(e+r,0,null)}touches(e,t){let n=0,r=65535&t,o=this.inverted?2:1,i=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let s=this.ranges[t]-(this.inverted?n:0);if(s>e)break;let a=this.ranges[t+o];if(e<=s+a&&t==3*r)return!0;n+=this.ranges[t+i]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),l=this.ranges[r+t],u=this.ranges[r+n];e(s,s+l,a,a+u),o+=u-l}}invert(){return new i(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?i.empty:new i(e<0?[0,-e,0]:[0,0,e])}}i.empty=new i([]);class s{constructor(e,t,n=0,r=e?e.length:0){this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new s(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new s;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let n=this.from;n<this.to;n++){let o=this._maps[n].mapResult(e,t);if(null!=o.recover){let t=this.getMirror(n);if(null!=t&&t>n&&t<this.to){n=t,e=this._maps[t].recover(o.recover);continue}}r|=o.delInfo,e=o.pos}return n?e:new o(e,r,null)}}let a=Object.create(null);class l{getMap(){return i.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let n=a[t.stepType];if(!n)throw RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in a)throw RangeError("Duplicate use of step JSON ID "+e);return a[e]=t,t.prototype.jsonID=e,t}}class u{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new u(e,null)}static fail(e){return new u(null,e)}static fromReplace(e,t,n,o){try{return u.ok(e.replace(t,n,o))}catch(e){if(e instanceof r.e4)return u.fail(e.message);throw e}}}function c(e,t,n){let o=[];for(let r=0;r<e.childCount;r++){let i=e.child(r);i.content.size&&(i=i.copy(c(i.content,t,i))),i.isInline&&(i=t(i,n,r)),o.push(i)}return r.HY.fromArray(o)}class p extends l{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),o=n.node(n.sharedDepth(this.to)),i=new r.p2(c(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,o),t.openStart,t.openEnd);return u.fromReplace(e,this.from,this.to,i)}invert(){return new d(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new p(t.pos,n.pos,this.mark)}merge(e){return e instanceof p&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new p(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new p(t.from,t.to,e.markFromJSON(t.mark))}}l.jsonID("addMark",p);class d extends l{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new r.p2(c(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return u.fromReplace(e,this.from,this.to,n)}invert(){return new p(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new d(t.pos,n.pos,this.mark)}merge(e){return e instanceof d&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new d(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new d(t.from,t.to,e.markFromJSON(t.mark))}}l.jsonID("removeMark",d);class h extends l{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return u.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return u.fromReplace(e,this.pos,this.pos+1,new r.p2(r.HY.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new h(this.pos,t.marks[n]);return new h(this.pos,this.mark)}}return new f(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new h(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new h(t.pos,e.markFromJSON(t.mark))}}l.jsonID("addNodeMark",h);class f extends l{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return u.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return u.fromReplace(e,this.pos,this.pos+1,new r.p2(r.HY.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new h(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new f(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new f(t.pos,e.markFromJSON(t.mark))}}l.jsonID("removeNodeMark",f);class m extends l{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&y(e,this.from,this.to)?u.fail("Structure replace would overwrite content"):u.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new i([this.from,this.to-this.from,this.slice.size])}invert(e){return new m(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new m(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof m)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?r.p2.empty:new r.p2(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new m(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?r.p2.empty:new r.p2(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new m(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new m(t.from,t.to,r.p2.fromJSON(e,t.slice),!!t.structure)}}l.jsonID("replace",m);class g extends l{constructor(e,t,n,r,o,i,s=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=s}apply(e){if(this.structure&&(y(e,this.from,this.gapFrom)||y(e,this.gapTo,this.to)))return u.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return u.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?u.fromReplace(e,this.from,this.to,n):u.fail("Content does not fit in gap")}getMap(){return new i([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new g(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||o>n.pos?null:new g(t.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new g(t.from,t.to,t.gapFrom,t.gapTo,r.p2.fromJSON(e,t.slice),t.insert,!!t.structure)}}function y(e,t,n){let r=e.resolve(t),o=n-t,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let e=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,o--}}return!1}function v(e,t,n,o=n.contentMatch,i=!0){let s=e.doc.nodeAt(t),a=[],l=t+1;for(let t=0;t<s.childCount;t++){let u=s.child(t),c=l+u.nodeSize,p=o.matchType(u.type);if(p){o=p;for(let t=0;t<u.marks.length;t++)n.allowsMarkType(u.marks[t].type)||e.step(new d(l,c,u.marks[t]));if(i&&u.isText&&"pre"!=n.whitespace){let e,t=/\r?\n|\r/g,o;for(;e=t.exec(u.text);)o||(o=new r.p2(r.HY.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),a.push(new m(l+e.index,l+e.index+e[0].length,o))}}else a.push(new m(l,c,r.p2.empty));l=c}if(!o.validEnd){let t=o.fillBefore(r.HY.empty,!0);e.replace(l,l,new r.p2(t,0,0))}for(let t=a.length-1;t>=0;t--)e.step(a[t])}function b(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!((0==o||r.canReplace(o,r.childCount))&&(i==r.childCount||r.canReplace(0,i))))break}return null}function w(e,t,n=null,r=e){let o=function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;let s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}(e,t),i=o&&function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;let a=(s.length?s[s.length-1]:t).contentMatch;for(let e=r;a&&e<o;e++)a=a.matchType(n.child(e).type);return a&&a.validEnd?s:null}(r,t);return i?o.map(x).concat({type:t,attrs:n}).concat(i.map(x)):null}function x(e){return{type:e,attrs:null}}function k(e,t,n,r){t.forEach((o,i)=>{if(o.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(o.text);){let o=e.mapping.slice(r).map(n+1+i+s.index);e.replaceWith(o,o+1,t.type.schema.linebreakReplacement.create())}}})}function _(e,t,n,r){t.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=e.mapping.slice(r).map(n+1+i);e.replaceWith(o,o+1,t.type.schema.text("\n"))}})}function S(e,t,n=1,r){let o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let e=o.depth-1,t=n-2;e>i;e--,t--){let n=o.node(e),i=o.index(e);if(n.type.spec.isolating)return!1;let s=n.content.cutByIndex(i,n.childCount),a=r&&r[t+1];a&&(s=s.replaceChild(0,a.type.create(a.attrs)));let l=r&&r[t]||n;if(!n.canReplace(i+1,n.childCount)||!l.type.validContent(s))return!1}let a=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(a,a,l?l.type:o.node(i+1).type)}function T(e,t){let n=e.resolve(t),r=n.index();return E(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function E(e,t){return!!(e&&t&&!e.isLeaf&&function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let o=0;o<t.childCount;o++){let i=t.child(o),s=i.type==r?e.type.schema.nodes.text:i.type;if(!(n=n.matchType(s))||!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}function C(e,t,n=-1){let r=e.resolve(t);for(let e=r.depth;;e--){let o,i,s=r.index(e);if(e==r.depth?(o=r.nodeBefore,i=r.nodeAfter):n>0?(o=r.node(e+1),s++,i=r.node(e).maybeChild(s)):(o=r.node(e).maybeChild(s-1),i=r.node(e+1)),o&&!o.isTextblock&&E(o,i)&&r.node(e).canReplace(s,s+1))return t;if(0==e)break;t=n<0?r.before(e):r.after(e)}}function A(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let o=n.content;for(let e=0;e<n.openStart;e++)o=o.firstChild.content;for(let e=1;e<=(0==n.openStart&&n.size?2:1);e++)for(let t=r.depth;t>=0;t--){let n=t==r.depth?0:r.pos<=(r.start(t+1)+r.end(t+1))/2?-1:1,i=r.index(t)+(n>0?1:0),s=r.node(t),a=!1;if(1==e)a=s.canReplace(i,i,o);else{let e=s.contentMatchAt(i).findWrapping(o.firstChild.type);a=e&&s.canReplaceWith(i,i,e[0])}if(a)return 0==n?r.pos:n<0?r.before(t+1):r.after(t+1)}return null}function O(e,t,n=t,o=r.p2.empty){if(t==n&&!o.size)return null;let i=e.resolve(t),s=e.resolve(n);return N(i,s,o)?new m(t,n,o):new M(i,s,o).fit()}function N(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}l.jsonID("replaceAround",g);class M{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=r.HY.empty;for(let t=0;t<=e.depth;t++){let n=e.node(t);this.frontier.push({type:n.type,match:n.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=r.HY.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,o=this.close(e<0?this.$to:n.doc.resolve(e));if(!o)return null;let i=this.placed,s=n.depth,a=o.depth;for(;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;let l=new r.p2(i,s,a);return e>-1?new g(n.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||n.pos!=this.$to.pos?new m(n.pos,o.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e=null,o=(n?(e=z(this.unplaced.content,n-1).firstChild).content:this.unplaced.content).firstChild;for(let i=this.depth;i>=0;i--){let{type:s,match:a}=this.frontier[i],l,u=null;if(1==t&&(o?a.matchType(o.type)||(u=a.fillBefore(r.HY.from(o),!1)):e&&s.compatibleContent(e.type)))return{sliceDepth:n,frontierDepth:i,parent:e,inject:u};if(2==t&&o&&(l=a.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:i,parent:e,wrap:l};if(e&&a.matchType(e.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,o=z(e,t);return!!o.childCount&&!o.firstChild.isLeaf&&(this.unplaced=new r.p2(e,t+1,Math.max(n,o.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,o=z(e,t);if(o.childCount<=1&&t>0){let i=e.size-t<=t+o.size;this.unplaced=new r.p2(I(e,t-1,1),t-1,i?t-1:n)}else this.unplaced=new r.p2(I(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:o,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let e=0;e<i.length;e++)this.openFrontierNode(i[e]);let s=this.unplaced,a=n?n.content:s.content,l=s.openStart-e,u=0,c=[],{match:p,type:d}=this.frontier[t];if(o){for(let e=0;e<o.childCount;e++)c.push(o.child(e));p=p.matchFragment(o)}let h=a.size+e-(s.content.size-s.openEnd);for(;u<a.childCount;){let e=a.child(u),t=p.matchType(e.type);if(!t)break;(++u>1||0==l||e.content.size)&&(p=t,c.push(function e(t,n,o){if(n<=0)return t;let i=t.content;return n>1&&(i=i.replaceChild(0,e(i.firstChild,n-1,1==i.childCount?o-1:0))),n>0&&(i=t.type.contentMatch.fillBefore(i).append(i),o<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(r.HY.empty,!0)))),t.copy(i)}(e.mark(d.allowedMarks(e.marks)),1==u?l:0,u==a.childCount?h:-1)))}let f=u==a.childCount;f||(h=-1),this.placed=R(this.placed,t,r.HY.from(c)),this.frontier[t].match=p,f&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=a;e<h;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=f?0==e?r.p2.empty:new r.p2(I(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new r.p2(I(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!P(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){r:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=P(e,t,r,n,o);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],o=P(e,n,r,t,!0);if(!o||o.childCount)continue r}return{depth:t,fit:i,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=R(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=R(this.placed,this.depth,r.HY.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(r.HY.empty,!0);e.childCount&&(this.placed=R(this.placed,this.frontier.length,e))}}function I(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(I(e.firstChild.content,t-1,n)))}function R(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(R(e.lastChild.content,t-1,n)))}function z(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function P(e,t,n,r,o){let i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function L(e,t){let n=[],r=Math.min(e.depth,t.depth);for(let o=r;o>=0;o--){let r=e.start(o);if(r<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(r==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==r-1)&&n.push(o)}return n}class j extends l{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return u.fail("No node at attribute step's position");let n=Object.create(null);for(let e in t.attrs)n[e]=t.attrs[e];n[this.attr]=this.value;let o=t.type.create(n,null,t.marks);return u.fromReplace(e,this.pos,this.pos+1,new r.p2(r.HY.from(o),0,t.isLeaf?0:1))}getMap(){return i.empty}invert(e){return new j(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new j(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new j(t.pos,t.attr,t.value)}}l.jsonID("attr",j);class D extends l{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let n in e.attrs)t[n]=e.attrs[n];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return u.ok(n)}getMap(){return i.empty}invert(e){return new D(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new D(t.attr,t.value)}}l.jsonID("docAttr",D);let $=class extends Error{};($=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n}).prototype=Object.create(Error.prototype),$.prototype.constructor=$,$.prototype.name="TransformError";class H{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new s}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new $(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=r.p2.empty){let o=O(this.doc,e,t,n);return o&&this.step(o),this}replaceWith(e,t,n){return this.replace(e,t,new r.p2(r.HY.from(n),0,0))}delete(e,t){return this.replace(e,t,r.p2.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return!function(e,t,n,o){if(!o.size)return e.deleteRange(t,n);let i=e.doc.resolve(t),s=e.doc.resolve(n);if(N(i,s,o))return e.step(new m(t,n,o));let a=L(i,e.doc.resolve(n));0==a[a.length-1]&&a.pop();let l=-(i.depth+1);a.unshift(l);for(let e=i.depth,t=i.pos-1;e>0;e--,t--){let n=i.node(e).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;a.indexOf(e)>-1?l=e:i.before(e)==t&&a.splice(1,0,-e)}let u=a.indexOf(l),c=[],p=o.openStart;for(let e=o.content,t=0;;t++){let n=e.firstChild;if(c.push(n),t==o.openStart)break;e=n.content}for(let e=p-1;e>=0;e--){var d;let t=c[e],n=(d=t.type).spec.defining||d.spec.definingForContent;if(n&&!t.sameMarkup(i.node(Math.abs(l)-1)))p=e;else if(n||!t.type.isTextblock)break}for(let t=o.openStart;t>=0;t--){let l=(t+p+1)%(o.openStart+1),d=c[l];if(d)for(let t=0;t<a.length;t++){let c=a[(t+u)%a.length],p=!0;c<0&&(p=!1,c=-c);let h=i.node(c-1),f=i.index(c-1);if(h.canReplaceWith(f,f,d.type,d.marks))return e.replace(i.before(c),p?s.after(c):n,new r.p2(function e(t,n,o,i,s){if(n<o){let r=t.firstChild;t=t.replaceChild(0,r.copy(e(r.content,n+1,o,i,r)))}if(n>i){let e=s.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(r.HY.empty,!0))}return t}(o.content,0,o.openStart,l),l,o.openEnd))}}let h=e.steps.length;for(let r=a.length-1;r>=0&&(e.replace(t,n,o),!(e.steps.length>h));r--){let e=a[r];e<0||(t=i.before(e),n=s.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return!function(e,t,n,o){if(!o.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let r=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let e=r.depth-1;e>=0;e--){let t=r.index(e);if(r.node(e).canReplaceWith(t,t,n))return r.before(e+1);if(t>0)return null}if(r.parentOffset==r.parent.content.size)for(let e=r.depth-1;e>=0;e--){let t=r.indexAfter(e);if(r.node(e).canReplaceWith(t,t,n))return r.after(e+1);if(t<r.node(e).childCount)break}return null}(e.doc,t,o.type);null!=r&&(t=n=r)}e.replaceRange(t,n,new r.p2(r.HY.from(o),0,0))}(this,e,t,n),this}deleteRange(e,t){return!function(e,t,n){let r=e.doc.resolve(t),o=e.doc.resolve(n),i=L(r,o);for(let t=0;t<i.length;t++){let n=i[t],s=t==i.length-1;if(s&&0==n||r.node(n).type.contentMatch.validEnd)return e.delete(r.start(n),o.end(n));if(n>0&&(s||r.node(n-1).canReplace(r.index(n-1),o.indexAfter(n-1))))return e.delete(r.before(n),o.after(n))}for(let i=1;i<=r.depth&&i<=o.depth;i++)if(t-r.start(i)==r.depth-i&&n>r.end(i)&&o.end(i)-n!=o.depth-i&&r.start(i-1)==o.start(i-1)&&r.node(i-1).canReplace(r.index(i-1),o.index(i-1)))return e.delete(r.before(i),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return!function(e,t,n){let{$from:o,$to:i,depth:s}=t,a=o.before(s+1),l=i.after(s+1),u=a,c=l,p=r.HY.empty,d=0;for(let e=s,t=!1;e>n;e--)t||o.index(e)>0?(t=!0,p=r.HY.from(o.node(e).copy(p)),d++):u--;let h=r.HY.empty,f=0;for(let e=s,t=!1;e>n;e--)t||i.after(e+1)<i.end(e)?(t=!0,h=r.HY.from(i.node(e).copy(h)),f++):c++;e.step(new g(u,c,a,l,new r.p2(p.append(h),d,f),p.size-d,!0))}(this,e,t),this}join(e,t=1){return!function(e,t,n){let o=null,{linebreakReplacement:i}=e.doc.type.schema,s=e.doc.resolve(t-n),a=s.node().type;if(i&&a.inlineContent){let e="pre"==a.whitespace,t=!!a.contentMatch.matchType(i);e&&!t?o=!1:!e&&t&&(o=!0)}let l=e.steps.length;if(!1===o){let r=e.doc.resolve(t+n);_(e,r.node(),r.before(),l)}a.inlineContent&&v(e,t+n-1,a,s.node().contentMatchAt(s.index()),null==o);let u=e.mapping.slice(l),c=u.map(t-n);if(e.step(new m(c,u.map(t+n,-1),r.p2.empty,!0)),!0===o){let t=e.doc.resolve(c);k(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return!function(e,t,n){let o=r.HY.empty;for(let e=n.length-1;e>=0;e--){if(o.size){let t=n[e].type.contentMatch.matchFragment(o);if(!t||!t.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}o=r.HY.from(n[e].type.create(n[e].attrs,o))}let i=t.start,s=t.end;e.step(new g(i,s,i,s,new r.p2(o,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,o=null){return!function(e,t,n,o,i){if(!o.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{var a,l;let u,c,p="function"==typeof i?i(t):i;if(t.isTextblock&&!t.hasMarkup(o,p)&&(a=e.doc,l=e.mapping.slice(s).map(n),c=(u=a.resolve(l)).index(),u.parent.canReplaceWith(c,c+1,o))){let i=null;if(o.schema.linebreakReplacement){let e="pre"==o.whitespace,t=!!o.contentMatch.matchType(o.schema.linebreakReplacement);e&&!t?i=!1:!e&&t&&(i=!0)}!1===i&&_(e,t,n,s),v(e,e.mapping.slice(s).map(n,1),o,void 0,null===i);let a=e.mapping.slice(s),l=a.map(n,1),u=a.map(n+t.nodeSize,1);return e.step(new g(l,u,l+1,u-1,new r.p2(r.HY.from(o.create(p,null,t.marks)),0,0),1,!0)),!0===i&&k(e,t,n,s),!1}})}(this,e,t,n,o),this}setNodeMarkup(e,t,n=null,o){return!function(e,t,n,o,i){let s=e.doc.nodeAt(t);if(!s)throw RangeError("No node at given position");n||(n=s.type);let a=n.create(o,null,i||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,a);if(!n.validContent(s.content))throw RangeError("Invalid content for node type "+n.name);e.step(new g(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new r.p2(r.HY.from(a),0,0),1,!0))}(this,e,t,n,o),this}setNodeAttribute(e,t,n){return this.step(new j(e,t,n)),this}setDocAttribute(e,t){return this.step(new D(e,t)),this}addNodeMark(e,t){return this.step(new h(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw RangeError("No node at position "+e);if(t instanceof r.vc)t.isInSet(n.marks)&&this.step(new f(e,t));else{let r=n.marks,o,i=[];for(;o=t.isInSet(r);)i.push(new f(e,o)),r=o.removeFromSet(r);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e,t=1,n){return!function(e,t,n=1,o){let i=e.doc.resolve(t),s=r.HY.empty,a=r.HY.empty;for(let e=i.depth,t=i.depth-n,l=n-1;e>t;e--,l--){s=r.HY.from(i.node(e).copy(s));let t=o&&o[l];a=r.HY.from(t?t.type.create(t.attrs,a):i.node(e).copy(a))}e.step(new m(t,t,new r.p2(s.append(a),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){var r;let o,i,s,a;return r=this,s=[],a=[],r.doc.nodesBetween(e,t,(r,l,u)=>{if(!r.isInline)return;let c=r.marks;if(!n.isInSet(c)&&u.type.allowsMarkType(n.type)){let u=Math.max(l,e),h=Math.min(l+r.nodeSize,t),f=n.addToSet(c);for(let e=0;e<c.length;e++)c[e].isInSet(f)||(o&&o.to==u&&o.mark.eq(c[e])?o.to=h:s.push(o=new d(u,h,c[e])));i&&i.to==u?i.to=h:a.push(i=new p(u,h,n))}}),s.forEach(e=>r.step(e)),a.forEach(e=>r.step(e)),this}removeMark(e,t,n){var o;let i,s;return o=this,i=[],s=0,o.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(n instanceof r.ZU){let e=o.marks,t;for(;t=n.isInSet(e);)(l||(l=[])).push(t),e=t.removeFromSet(e)}else n?n.isInSet(o.marks)&&(l=[n]):l=o.marks;if(l&&l.length){let n=Math.min(a+o.nodeSize,t);for(let t=0;t<l.length;t++){let r=l[t],o;for(let e=0;e<i.length;e++){let t=i[e];t.step==s-1&&r.eq(i[e].style)&&(o=t)}o?(o.to=n,o.step=s):i.push({style:r,from:Math.max(a,e),to:n,step:s})}}}),i.forEach(e=>o.step(new d(e.from,e.to,e.style))),this}clearIncompatible(e,t,n){return v(this,e,t,n),this}}}}]);