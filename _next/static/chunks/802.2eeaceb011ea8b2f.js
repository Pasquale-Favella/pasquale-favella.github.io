(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[802],{56472:function(e,t,s){"use strict";s.d(t,{z:function(){return o}});var a=s(85893);s(67294);var n=s(88426),r=s(45139),l=s(36965);let i=(0,r.j)("btn inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-all disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none",{variants:{variant:{default:"btn-primary",destructive:"btn-error",outline:"btn-outline",secondary:"btn-secondary",ghost:"btn-ghost",link:"btn-link"},size:{default:"btn-md has-[>svg]:px-3",sm:"btn-sm gap-1.5 has-[>svg]:px-2.5",lg:"btn-lg has-[>svg]:px-4",icon:"btn-square btn-md"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:s,size:r,asChild:o=!1,isLoading:d=!1,children:c,...m}=e,u=o?n.g7:"button";return(0,a.jsxs)(u,{"data-slot":"button",className:(0,l.cn)(i({variant:s,size:r,className:t})),disabled:d||m.disabled,...m,children:[d&&(0,a.jsx)("span",{className:"loading loading-spinner"}),c]})}},47512:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eB}});var a=s(85893),n=s(67294),r=s(86250),l=s(12515),i=s(15581),o=s(10856),d=s(65550),c=s(36965),m=s(20104),u=s(80322);let x=e=>{let{className:t,...s}=e;return(0,a.jsx)(u.h,{className:(0,c.cn)("relative flex-1 overflow-y-auto",t),initial:"smooth",resize:"smooth",role:"log",...s})},p=e=>{let{className:t,...s}=e;return(0,a.jsx)(u.h.Content,{className:(0,c.cn)("p-4",t),...s})},h=e=>{let{className:t,...s}=e,{isAtBottom:r,scrollToBottom:l}=(0,u.a)(),i=(0,n.useCallback)(()=>{l()},[l]);return!r&&(0,a.jsx)("button",{className:(0,c.cn)("absolute bottom-4 left-[50%] translate-x-[-50%] btn btn-circle",t),onClick:i,type:"button",...s,children:(0,a.jsx)(m.Bqo,{className:"size-4"})})},f=e=>{let{size:t=16}=e;return(0,a.jsxs)("svg",{height:t,strokeLinejoin:"round",viewBox:"0 0 16 16",width:t,style:{color:"currentcolor"},children:[(0,a.jsxs)("g",{clipPath:"url(#clip0_2393_1490)",children:[(0,a.jsx)("path",{d:"M8 0V4",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.5",d:"M8 16V12",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.9",d:"M3.29773 1.52783L5.64887 4.7639",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.1",d:"M12.7023 1.52783L10.3511 4.7639",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.4",d:"M12.7023 14.472L10.3511 11.236",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.6",d:"M3.29773 14.472L5.64887 11.236",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.2",d:"M15.6085 5.52783L11.8043 6.7639",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.7",d:"M0.391602 10.472L4.19583 9.23598",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.3",d:"M15.6085 10.4722L11.8043 9.2361",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.8",d:"M0.391602 5.52783L4.19583 6.7639",stroke:"currentColor",strokeWidth:"1.5"})]}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_2393_1490",children:(0,a.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]})},g=e=>{let{className:t,size:s=16,...n}=e;return(0,a.jsx)("div",{className:(0,c.cn)("inline-flex items-center justify-center animate-spin",t),...n,children:(0,a.jsx)(f,{size:s})})};var b=s(46475);function j(e){let{className:t,...s}=e;return(0,a.jsx)(b.fC,{"data-slot":"avatar",className:(0,c.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function y(e){let{className:t,...s}=e;return(0,a.jsx)(b.Ee,{"data-slot":"avatar-image",className:(0,c.cn)("aspect-square size-full",t),...s})}function w(e){let{className:t,...s}=e;return(0,a.jsx)(b.NY,{"data-slot":"avatar-fallback",className:(0,c.cn)("bg-base-300 flex size-full items-center justify-center rounded-full",t),...s})}let N=e=>{let{className:t,from:s,...n}=e;return(0,a.jsx)("div",{className:(0,c.cn)("group flex w-full items-end justify-end gap-2 py-4","user"===s?"is-user":"is-assistant flex-row-reverse justify-end","[&>div]:max-w-[80%]",t),...n})},v=e=>{let{children:t,className:s,...n}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col gap-2 rounded-lg text-sm text-foreground px-4 py-3 overflow-hidden","group-[.is-user]:bg-base-300 group-[.is-user]:text-base-content","group-[.is-assistant]:bg-base-300 group-[.is-assistant]:text-base-content",s),...n,children:(0,a.jsx)("div",{className:"is-user:dark",children:t})})},k=e=>{let{src:t,name:s,className:n,...r}=e;return(0,a.jsxs)(j,{className:(0,c.cn)("size-8 ring-1 ring-primary",n),...r,children:[(0,a.jsx)(y,{alt:"",className:"mt-0 mb-0",src:t}),(0,a.jsx)(w,{children:(null==s?void 0:s.slice(0,2))||"ME"})]})};var S=s(6757);let z=n.forwardRef((e,t)=>{let{className:s,value:n,...r}=e;return(0,a.jsx)(S.fC,{ref:t,className:(0,c.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",s),...r,children:(0,a.jsx)(S.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});function C(e){let{fileUrl:t,fileName:s}=e;return(0,a.jsxs)("div",{className:"relative p-3 rounded-lg border bg-base-100 shadow-sm max-w-fit",children:[(0,a.jsx)("div",{className:"absolute top-2 right-2 p-1.5 rounded-full bg-base-100/30",children:(0,a.jsx)(r.LMr,{className:"size-3.5 bg-primary"})}),(0,a.jsx)("audio",{src:t,className:"hidden",children:"Your browser does not support the audio element."}),(0,a.jsx)("span",{className:"text-sm text-base-200 font-medium pr-8 block truncate max-w-[200px]",children:s})]})}z.displayName=S.fC.displayName;var T=s(10048),M=s(34138),D=s.n(M),E=s(13052),F=s.n(E);let R=(0,n.memo)(function(e){let{responseText:t="",className:s}=e,r=(0,n.useMemo)(()=>(0,T.Z)().use(D()).use(F(),{buttonClass:"btn btn-ghost btn-circle btn-sm",iconClass:"fa fa-solid fa-clone text-neutral-content"}).render(t),[t]);return(0,a.jsx)("div",{className:(0,c.cn)("size-full [&>*:first-child]:mt-0 [&>*:last-child]:mb-0 prose",s),dangerouslySetInnerHTML:{__html:r}})},(e,t)=>e.responseText===t.responseText);var L=s(56472),I=s(77342),O=s(87479);function _(e){let{...t}=e;return(0,a.jsx)(O.fC,{"data-slot":"collapsible",...t})}function P(e){let{...t}=e;return(0,a.jsx)(O.wy,{"data-slot":"collapsible-trigger",...t})}function U(e){let{...t}=e;return(0,a.jsx)(O.Fw,{"data-slot":"collapsible-content",...t})}var A=s(96606);let B=(0,n.createContext)(null),W=()=>{let e=(0,n.useContext)(B);if(!e)throw Error("Reasoning components must be used within Reasoning");return e},V=(0,n.memo)(e=>{let{className:t,isStreaming:s=!1,open:r,defaultOpen:l=!1,onOpenChange:i,duration:o,children:d,...m}=e,[u=!1,x]=(0,I.T)({prop:r,defaultProp:l,onChange:i}),[p=0,h]=(0,I.T)({prop:o,defaultProp:0}),[f,g]=(0,n.useState)(!1),[b,j]=(0,n.useState)(null);return(0,n.useEffect)(()=>{s?null===b&&j(Date.now()):null!==b&&(h(Math.round((Date.now()-b)/1e3)),j(null))},[s,b,h]),(0,n.useEffect)(()=>{if(s&&!u)x(!0);else if(!s&&u&&!l&&!f){let e=setTimeout(()=>{x(!1),g(!0)},1e3);return()=>clearTimeout(e)}},[s,u,l,x,f]),(0,a.jsx)(B.Provider,{value:{isStreaming:s,isOpen:u,setIsOpen:x,duration:p},children:(0,a.jsx)(_,{className:(0,c.cn)("not-prose mb-4",t),onOpenChange:e=>{x(e)},open:u,...m,children:d})})}),q=(0,n.memo)(e=>{let{className:t,title:s="Reasoning",children:n,...r}=e,{isStreaming:l,isOpen:i,duration:o}=W();return(0,a.jsx)(P,{className:(0,c.cn)("flex items-center gap-2 text-muted-foreground text-sm",t),...r,children:null!=n?n:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.DQb,{className:"size-4"}),l||0===o?(0,a.jsx)("p",{children:"Thinking..."}):(0,a.jsxs)("p",{children:["Thought for ",o," seconds"]}),(0,a.jsx)(A.OrA,{className:(0,c.cn)("size-4 text-base-content transition-transform",i?"rotate-180":"rotate-0")})]})})}),Y=(0,n.memo)(e=>{let{className:t,children:s,...n}=e;return(0,a.jsx)(U,{className:(0,c.cn)("mt-4 text-sm","text-base-content outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:slide-out-to-top-2 data-[state=open]:slide-in-from-top-2",t),...n,children:(0,a.jsx)(R,{className:"grid gap-2",responseText:s})})});V.displayName="Reasoning",q.displayName="ReasoningTrigger",Y.displayName="ReasoningContent";var X=s(50788),$=s(32811);function H(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,c.cn)("textarea textarea-bordered w-full min-h-16 field-sizing-content resize-vertical",t),...s})}let J=e=>{let{className:t,...s}=e;return(0,a.jsx)("form",{className:(0,c.cn)("w-full divide-y rounded-xl border bg-base-100 shadow-sm",t),...s})},Q=e=>{let{onChange:t,className:s,placeholder:n="What would you like to know?",minHeight:r=48,maxHeight:l=164,...i}=e;return(0,a.jsx)(H,{className:(0,c.cn)("w-full resize-none rounded-none border-none p-3 shadow-none outline-none ring-0","bg-transparent field-sizing-content max-h-[6lh]","focus-visible:ring-0 focus-visible:outline-none",s),name:"message",onChange:e=>{null==t||t(e)},onKeyDown:e=>{if("Enter"===e.key){if(e.shiftKey)return;e.preventDefault();let t=e.currentTarget.form;t&&t.requestSubmit()}},placeholder:n,...i})},Z=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex items-center justify-between p-1",t),...s})},K=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex items-center gap-1","[&_div:first-child]:rounded-bl-xl",t),...s})},G=e=>{let{className:t,variant:s="ghost",size:n="icon",status:r,children:i,...o}=e,d=(0,a.jsx)(m.NQj,{className:"size-5"});return"submitted"===r?d=(0,a.jsx)(l.dAq,{className:"size-5 animate-spin"}):"streaming"===r?d=(0,a.jsx)(l.jxP,{className:"size-5"}):"error"===r&&(d=(0,a.jsx)(X.FU5,{className:"size-5"})),(0,a.jsx)(L.z,{className:(0,c.cn)("gap-1.5 rounded-lg",t),size:n,type:"submit",variant:s,...o,children:null!=i?i:d})},ee=e=>(0,a.jsx)($.Ph,{...e}),et=e=>{let{className:t,...s}=e;return(0,a.jsx)($.i4,{className:(0,c.cn)("border-none bg-transparent font-medium text-muted-foreground shadow-none transition-colors",'hover:bg-base-300 hover:text-base-content [&[aria-expanded="true"]]:bg-base-300 [&[aria-expanded="true"]]:text-base-content',t),...s})},es=e=>{let{className:t,...s}=e;return(0,a.jsx)($.Bw,{className:(0,c.cn)(t),...s})},ea=e=>{let{className:t,...s}=e;return(0,a.jsx)($.Ql,{className:(0,c.cn)(t),...s})},en=e=>{let{className:t,...s}=e;return(0,a.jsx)($.ki,{className:(0,c.cn)(t),...s})};var er=s(25333);let el=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",device:"webgpu",dtype:"q4f16"},{id:"HuggingFaceTB/SmolLM2-360M-Instruct",name:"SmolLM2 360M",device:"webgpu",dtype:"q4"},{id:"onnx-community/Llama-3.2-1B-Instruct-q4f16",name:"Llama 3.2 1B",device:"webgpu"},{id:"HuggingFaceTB/SmolVLM-256M-Instruct",name:"SmolVLM 256M (Vision)",device:"webgpu",dtype:"fp32",isVisionModel:!0}];var ei=s(60414),eo=s(73652);class ed{async sendMessages(e){var t,s;let{chatId:a,messages:n,abortSignal:r,trigger:l,messageId:i,...o}=e,d=null===(s=n.at(-1))||void 0===s?void 0:null===(t=s.parts.find(e=>"text"===e.type))||void 0===t?void 0:t.text,c=await this.documentProcessor.searchSimilarDocuments(null!=d?d:""),m=c.length>0,u=c.map(e=>"Context: ".concat(e.content)).join("\n\n"),x=(0,eo.bS)(n),p=this.model,h="You are a helpful assistant. Check your knowledge base before answering any questions.\n    ".concat(m?"Only respond to questions based on the following knowledge base: ".concat(u):"",'\n    if no relevant information is found, respond, "Sorry, I don\'t know."');return"available"===await p.availability()?(0,eo.kP)({model:(0,eo.eI)({model:p,middleware:(0,eo.iU)({tagName:"think"})}),messages:x,system:h,abortSignal:r}).toUIMessageStream({messageMetadata:e=>{let{part:t}=e;if("finish"===t.type)return{relevantDocs:c}}}):(0,eo.Mm)({execute:async e=>{let{writer:t}=e;try{let e;await p.createSessionWithProgress(s=>{let a=Math.round(100*s.progress);if(s.progress>=1){e&&t.write({type:"data-modelDownloadProgress",id:e,data:{status:"complete",progress:100,message:"Model finished downloading! Getting ready for inference..."}});return}if(!e){e="download-".concat(Date.now()),t.write({type:"data-modelDownloadProgress",id:e,data:{status:"downloading",progress:a,message:"Downloading browser AI model..."},transient:!0});return}t.write({type:"data-modelDownloadProgress",id:e,data:{status:"downloading",progress:a,message:"Downloading browser AI model... ".concat(a,"%")}})});let s=(0,eo.kP)({model:(0,eo.eI)({model:p,middleware:(0,eo.iU)({tagName:"think"})}),messages:x,system:h,abortSignal:r,onChunk(s){"text-delta"===s.chunk.type&&e&&(t.write({type:"data-modelDownloadProgress",id:e,data:{status:"complete",progress:100,message:""}}),e=void 0)}});t.merge(s.toUIMessageStream({sendStart:!1,messageMetadata:e=>{let{part:t}=e;if("finish"===t.type)return{relevantDocs:c}}}))}catch(e){throw t.write({type:"data-notification",data:{message:"Error: ".concat(e instanceof Error?e.message:"Unknown error"),level:"error"},transient:!0}),e}}})}async reconnectToStream(e){return null}constructor(e,t){this.model=e,this.documentProcessor=t}}var ec=s(86501),em=s(74790),eu=s(95481),ex=s(56921);class ep{async initVectorDatabase(){await this.db.exec("CREATE EXTENSION IF NOT EXISTS vector;"),await this.db.exec("\n            CREATE TABLE IF NOT EXISTS documents (\n                id SERIAL PRIMARY KEY,\n                content TEXT NOT NULL,\n                metadata JSONB DEFAULT '{}',\n                embedding vector(384),\n                created_at TIMESTAMP DEFAULT NOW()\n            );\n        "),await this.db.exec("\n            CREATE INDEX IF NOT EXISTS documents_embedding_idx \n            ON documents USING hnsw (embedding vector_cosine_ops);\n        ")}async embedText(e){let{embedding:t}=await (0,eo.$Z)({model:this.embeddingModel,value:e});return t}async embedMultipleText(e){let{embeddings:t}=await (0,eo.h5)({model:this.embeddingModel,values:e});return t}async processTextFile(e){let t=await e.text();return this.splitText(t,{source:"file_upload",filename:e.name,fileType:"txt",originalSize:t.length,timestamp:new Date().toISOString()})}async processPdfFile(e){let t=window.pdfjsLib;t.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@".concat(t.version,"/build/pdf.worker.min.mjs");let s=await e.arrayBuffer(),a=await t.getDocument({data:s}).promise,n="",r=[];for(let e=1;e<=a.numPages;e++){let t=await a.getPage(e),s=(await t.getTextContent()).items.map(e=>e.str).join(" ").trim();s&&(r.push({pageNumber:e,text:s}),n+=s+"\n\n")}let l=await this.splitText(n,{source:"pdf_upload",filename:e.name,fileType:"pdf",originalSize:n.length,timestamp:new Date().toISOString(),totalPages:a.numPages});return this.mapChunksToPages(l,r)}mapChunksToPages(e,t){return e.map(e=>{let s={pageNumber:1,similarity:0};for(let a of t){let t=this.calculateTextSimilarity(e.content.substring(0,200),a.text.substring(0,200));t>s.similarity&&(s={pageNumber:a.pageNumber,similarity:t})}return{...e,metadata:{...e.metadata,page:s.similarity>.1?s.pageNumber:void 0}}})}calculateTextSimilarity(e,t){let s=Array.from(new Set(e.toLowerCase().split(/\s+/))),a=Array.from(new Set(t.toLowerCase().split(/\s+/))),n=s.filter(e=>a.includes(e)),r=Array.from(new Set([...s,...a]));return n.length/r.length}async splitText(e,t){if(!e.trim())throw Error("Cannot process empty text");let s=await this.textSplitter.createDocuments([e]);return s.map((a,n)=>({content:a.pageContent,metadata:{...t,chunkIndex:n,totalChunks:s.length,chunkSize:a.pageContent.length,source:t.source||"unknown",filename:t.filename||"unknown",fileType:t.fileType||"text",originalSize:t.originalSize||e.length,timestamp:t.timestamp||new Date().toISOString()}}))}getFileType(e){let t=e.name.toLowerCase().split(".").pop(),s=e.type.toLowerCase();return"application/pdf"===s||"pdf"===t?"pdf":"text/plain"===s||"txt"===t||"md"===t||"markdown"===t?"txt":"unsupported"}async storeProcessedDocuments(e,t){if(e.length!==t.length)throw Error("Documents and embeddings arrays must have the same length");for(let s=0;s<e.length;s++){let a=e[s],n=t[s];await this.db.query("\n                INSERT INTO documents (content, metadata, embedding) \n                VALUES ($1, $2, $3)\n                ",[a.content,JSON.stringify(a.metadata),"[".concat(n.join(","),"]")])}}async processAndStoreFiles(e,t){let s=Array.from(e);for(let e=0;e<s.length;e++){let a=s[e],n=this.getFileType(a);if("unsupported"===n){console.warn("Skipping unsupported file: ".concat(a.name));continue}null==t||t({stage:"reading",current:e+1,total:s.length,message:"Reading ".concat(a.name,"..."),filename:a.name});let r=[];"pdf"===n?r=await this.processPdfFile(a):"txt"===n&&(r=await this.processTextFile(a)),null==t||t({stage:"splitting",current:e+1,total:s.length,message:"Split into ".concat(r.length," chunks"),filename:a.name}),null==t||t({stage:"embedding",current:0,total:r.length,message:"Generating embeddings...",filename:a.name});let l=[];for(let e=0;e<r.length;e+=10){let s=r.slice(e,e+10).map(e=>e.content),n=await this.embedMultipleText(s);l.push(...n),null==t||t({stage:"embedding",current:Math.min(e+10,r.length),total:r.length,message:"Embedding batch ".concat(Math.ceil((e+1)/10),"/").concat(Math.ceil(r.length/10)),filename:a.name})}null==t||t({stage:"storing",current:0,total:r.length,message:"Storing chunks...",filename:a.name}),await this.storeProcessedDocuments(r,l),null==t||t({stage:"complete",current:e+1,total:s.length,message:"✅ Processed ".concat(r.length," chunks"),filename:a.name})}}async searchSimilarDocuments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.7;try{let a=await this.embedText(e);return(await this.db.query("\n                SELECT \n                    id,\n                    content,\n                    metadata,\n                    created_at,\n                    1 - (embedding <=> $1) as similarity\n                FROM documents\n                WHERE 1 - (embedding <=> $1) > $2\n                ORDER BY embedding <=> $1\n                LIMIT $3\n            ",["[".concat(a.join(","),"]"),s,t])).rows.map(e=>({id:e.id,content:e.content,metadata:"string"==typeof e.metadata?JSON.parse(e.metadata):e.metadata,similarity:e.similarity,created_at:e.created_at}))}catch(e){throw console.error("Error searching documents:",e),Error("Failed to search documents")}}async clearDocuments(){try{await this.db.exec("DELETE FROM documents")}catch(e){throw console.error("Error clearing documents:",e),Error("Failed to clear documents")}}constructor(e){this.textSplitter=new ex.s9({chunkSize:1e3,chunkOverlap:200,separators:["\n\n","\n"," ",""],keepSeparator:!1,lengthFunction:e=>e.length}),this.embeddingModel=ei.transformersJS.textEmbedding("Supabase/gte-small",{device:"webgpu",dtype:"q8",normalize:!0,pooling:"mean",maxTokens:512}),this.db=e,this.initVectorDatabase()}}var eh=s(89056),ef=s(30303);let eg=eh.fC,eb=eh.xz,ej=eh.h_,ey=eh.x8,ew=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(eh.aV,{ref:t,className:(0,c.cn)("fixed grid place-items-center overflow-auto backdrop-blur-sm inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...n})});ew.displayName=eh.aV.displayName;let eN=n.forwardRef((e,t)=>{let{className:s,children:n,...r}=e;return(0,a.jsx)(ej,{children:(0,a.jsx)(ew,{children:(0,a.jsxs)(eh.VY,{ref:t,className:(0,c.cn)("z-50 relative w-full max-w-lg mx-auto border bg-base-100 p-6 shadow-lg duration-200 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 sm:rounded-lg",s),...r,children:[n,(0,a.jsxs)(eh.x8,{className:(0,c.cn)("absolute right-4 top-4 rounded-sm opacity-70 ring-offset-base-100 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-base-300 data-[state=open]:text-base-content","bg-base-300 rounded-full"),children:[(0,a.jsx)(ef.j7p,{className:"h-6 w-6"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})})})});eN.displayName=eh.VY.displayName;let ev=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};ev.displayName="DialogHeader";let ek=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};ek.displayName="DialogFooter";let eS=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(eh.Dx,{ref:t,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",s),...n})});eS.displayName=eh.Dx.displayName;let ez=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(eh.dk,{ref:t,className:(0,c.cn)("text-sm text-base-content",s),...n})});ez.displayName=eh.dk.displayName;var eC=s(32512),eT=s(20473);let eM=(0,n.forwardRef)((e,t)=>{let{maxFiles:s=5,maxSize:r=104857600,acceptedFileTypes:l={"application/pdf":[".pdf"]},onFilesUploaded:i=()=>{},onFileRemove:o=()=>{},values:d=[],className:m="",disabled:u=!1}=e,[x,p]=(0,n.useState)(()=>d.filter(e=>!!e)),[h,f]=(0,n.useState)([]),g=u||x.length>=s;(0,n.useImperativeHandle)(t,()=>({resetFiles:()=>{p([]),f([])}}));let b=(0,n.useCallback)((e,t)=>{let a=x.length;if(a>=s)return;let n=e.slice(0,Math.max(0,s-a));if(n.length>0&&(p([...x,...n]),i(n)),t.length>0){let e=t.map(e=>({name:e.file.name,errors:e.errors.map(e=>e.message)}));f(t=>[...t,...e])}},[x,s,i]),j=e=>{p(c.cQ.removeFirstMatchImmutable(x,t=>t.name===e.name&&t.size===e.size)),o(e)},y=e=>{f(h.filter(t=>t.name!==e))},{getRootProps:w,getInputProps:N,isDragActive:v}=(0,eC.uI)({onDrop:b,maxFiles:s,maxSize:r,multiple:!0,accept:l,validator:e=>x.some(t=>t.name===e.name&&t.size===e.size)?{code:"duplicate-file",message:"File already uploaded"}:null,disabled:g});return(0,a.jsxs)("div",{className:"".concat(m),children:[(0,a.jsxs)("div",{...w(),className:"\n                    p-6 border-2 border-dashed rounded-lg transition-all\n                    flex flex-col items-center justify-center text-center\n                    ".concat(g?"bg-base-200 border-base-300 text-base-content cursor-not-allowed":"","\n                    ").concat(v?"border-primary bg-primary-focus bg-opacity-10":"border-base-300","\n                    cursor-pointer min-h-[200px]\n                "),children:[(0,a.jsx)("input",{...N(),disabled:g}),(0,a.jsx)(eT.xwm,{className:"text-4xl mb-3 ".concat(g?"text-base-content":"text-primary")}),v&&!g?(0,a.jsx)("p",{className:"text-lg font-medium text-primary",children:"Drop the files here…"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-lg font-medium ".concat(g?"text-base-content":"text-primary"),children:"Drag `n` drop files here, or click to select files"}),(0,a.jsxs)("p",{className:"text-sm text-base-content",children:["Maximum ",s," files, up to ",(r/1024/1024).toFixed(0),"MB each"]})]})]}),x.length>0&&(0,a.jsx)("div",{className:"flex flex-col gap-2 mt-3",children:x.map(e=>(0,a.jsxs)("div",{className:"alert rounded-lg shadow-md",children:[(0,a.jsx)(eT.vX6,{size:20,className:"text-primary"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 max-w-80",children:[(0,a.jsx)("span",{className:"text-sm truncate",children:e.name}),(0,a.jsxs)("span",{className:"text-xs",children:["(",(e.size/1024).toFixed(1)," KB)"]})]}),(0,a.jsx)("button",{onClick:()=>j(e),className:"btn btn-ghost btn-circle btn-sm ml-auto",type:"button",children:(0,a.jsx)(eT.z3f,{size:20})})]},e.name))}),h.length>0&&(0,a.jsx)("div",{className:"flex flex-col gap-2 mt-3",children:h.map(e=>(0,a.jsxs)("div",{className:"alert alert-error rounded-lg shadow-md",children:[(0,a.jsx)(eT.o86,{size:20}),(0,a.jsxs)("div",{className:"flex items-center gap-2 max-w-80",children:[(0,a.jsx)("span",{className:"text-sm truncate",children:e.name}),(0,a.jsx)("span",{className:"text-xs truncate",children:e.errors.join(", ")})]}),(0,a.jsx)("button",{onClick:()=>y(e.name),className:"btn btn-ghost btn-circle btn-sm ml-auto",type:"button",children:(0,a.jsx)(eT.z3f,{size:20})})]},e.name))})]})});eM.displayName="FileUploader";var eD=s(53870);let eE=e=>{let{className:t,...s}=e;return(0,a.jsx)(_,{className:(0,c.cn)("not-prose mb-4 text-primary text-xs",t),...s})},eF=e=>{let{className:t,count:s,children:n,...r}=e;return(0,a.jsx)(P,{className:(0,c.cn)("flex items-center gap-2",t),...r,children:null!=n?n:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Used ",s," sources"]}),(0,a.jsx)(A.OrA,{className:"h-4 w-4"})]})})},eR=e=>{let{className:t,...s}=e;return(0,a.jsx)(U,{className:(0,c.cn)("mt-3 flex w-fit flex-col gap-2","data-[state=closed]:fade-out-0 data-[state=closed]:slide-out-to-top-2 data-[state=open]:slide-in-from-top-2 outline-none data-[state=closed]:animate-out data-[state=open]:animate-in",t),...s})},eL=e=>{let{title:t,children:s,...n}=e;return(0,a.jsx)("span",{className:"flex items-center gap-2",...n,children:null!=s?s:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eD.xu5,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:" font-medium",children:t})]})})};var eI=s(16012);function eO(e){let{delayDuration:t=0,...s}=e;return(0,a.jsx)(eI.zt,{"data-slot":"tooltip-provider",delayDuration:t,...s})}function e_(e){let{...t}=e;return(0,a.jsx)(eO,{children:(0,a.jsx)(eI.fC,{"data-slot":"tooltip",...t})})}function eP(e){let{...t}=e;return(0,a.jsx)(eI.xz,{"data-slot":"tooltip-trigger",...t})}function eU(e){let{className:t,sideOffset:s=0,children:n,...r}=e;return(0,a.jsx)(eI.h_,{children:(0,a.jsxs)(eI.VY,{"data-slot":"tooltip-content",sideOffset:s,className:(0,c.cn)("bg-primary text-base-100 animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...r,children:[n,(0,a.jsx)(eI.Eh,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function eA(e){let{metadata:t}=e;if(!t)return null;let s=null==t?void 0:t.relevantDocs;return s&&0!==s.length?(0,a.jsx)(eO,{children:(0,a.jsxs)(eE,{children:[(0,a.jsx)(eF,{count:s.length}),(0,a.jsx)(eR,{children:s.map(e=>{var t,s,n;let r=(null===(t=e.metadata)||void 0===t?void 0:t.filename)||"Document ".concat(e.id),l=(null===(s=e.metadata)||void 0===s?void 0:s.chunkIndex)!==void 0&&(null===(n=e.metadata)||void 0===n?void 0:n.totalChunks)!==void 0?" (chunk ".concat(e.metadata.chunkIndex+1,"/").concat(e.metadata.totalChunks,")"):"";return(0,a.jsxs)(e_,{children:[(0,a.jsx)(eP,{asChild:!0,children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(eL,{title:"".concat(r).concat(l),className:"flex gap-1 text-xs text-base-content hover:text-primary transition-colors cursor-pointer"})})}),(0,a.jsx)(eU,{className:"max-w-md p-3",children:(0,a.jsx)("p",{className:"text-sm",children:e.content})})]},e.id)})})]})}):null}var eB=function(){let[e,t]=(0,n.useState)(""),[c,m]=(0,n.useState)(void 0),u=(0,n.useRef)(null),[f,b]=(0,n.useState)({ragFiles:[],isUploading:!1,isDialogOpen:!1}),{availableModels:j,modelConfig:y,setModelConfig:w,supportsTransformerJs:S,error:T,status:M,sendMessage:D,uploadRagDocuments:E,messages:F,regenerate:I,stop:O}=function(){let[e]=(0,n.useState)(el),[t,a]=(0,n.useState)(e[0]),r=(0,n.useMemo)(()=>(0,ei.doesBrowserSupportTransformersJS)(),[]),l=(0,eu.f)(),i=(0,n.useMemo)(()=>new ep(l),[l]),o=(0,n.useMemo)(()=>{let{id:e,name:a,...n}=t;return new ed((0,ei.transformersJS)(t.id,{...n,worker:new Worker(s.tu(new URL(s.p+s.u(9485),s.b)),{type:void 0})}),i)},[t,i]),{error:d,status:c,sendMessage:m,messages:u,regenerate:x,stop:p}=(0,em.RJ)({transport:o,onError(e){ec.default.error(e.message)},experimental_throttle:50,id:"chat-client-".concat(t.id)});return{availableModels:e,modelConfig:t,setModelConfig:a,supportsTransformerJs:r,error:d,status:c,messages:u,regenerate:x,stop:p,sendMessage:m,uploadRagDocuments:(0,n.useCallback)(async e=>{if(!i)throw Error("Document processor not initialized");await i.processAndStoreFiles(e)},[i])}}(),_=e=>{if(c){let t=new DataTransfer;Array.from(c).forEach((s,a)=>{a!==e&&t.items.add(s)}),m(t.files),u.current&&(u.current.files=t.files)}},P=e=>{let t=e.parts.filter(e=>"text"===e.type).map(e=>e.text).join("\n");navigator.clipboard.writeText(t)},U=async()=>{try{b(e=>({...e,isUploading:!0})),await E(f.ragFiles),b({ragFiles:[],isUploading:!1,isDialogOpen:!1}),ec.default.success("Files uploaded successfully!")}catch(e){console.error(e),ec.default.error("Error uploading files.")}finally{b(e=>({...e,isUploading:!1}))}};return S?(0,a.jsxs)("div",{className:"flex flex-col h-[calc(90dvh)] max-w-4xl mx-auto",children:[0===F.length&&(0,a.jsxs)("div",{className:"flex h-full flex-col items-center justify-center text-center",children:[(0,a.jsx)("p",{className:"text-xs",children:"AI Rag"}),(0,a.jsx)("h1",{className:"text-lg font-medium",children:"Using Transformers.js client-side"}),(0,a.jsx)("p",{className:"text-sm max-w-xs",children:"Switch model at the bottom of this page"})]}),(0,a.jsxs)(x,{className:"flex-1 no-scrollbar [&>*:first-child]:no-scrollbar",children:[(0,a.jsxs)(p,{children:[F.map((e,t)=>(0,a.jsxs)(N,{from:"system"===e.role?"assistant":e.role,children:[(0,a.jsxs)(v,{className:"no-scrollbar",children:[e.parts.filter(e=>"data-modelDownloadProgress"===e.type).map((e,t)=>e.data.message&&"ready"!==M?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(g,{className:"size-4 "}),e.data.message]})}),"downloading"===e.data.status&&void 0!==e.data.progress&&(0,a.jsx)(z,{value:e.data.progress})]},t):null),e.parts.filter(e=>"file"===e.type).map((e,t)=>{var s,n;return(null===(s=e.mediaType)||void 0===s?void 0:s.startsWith("image/"))?(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("img",{src:e.url,width:300,height:300,alt:e.filename||"Uploaded image",className:"object-contain max-w-sm rounded-lg border"})},t):(null===(n=e.mediaType)||void 0===n?void 0:n.startsWith("audio/"))?(0,a.jsx)(C,{fileName:e.filename,fileUrl:e.url},t):null}),e.parts.filter(e=>"reasoning"===e.type).map((s,n)=>(0,a.jsxs)(V,{className:"w-full",isStreaming:"streaming"===M&&t===F.length-1,children:[(0,a.jsx)(q,{}),(0,a.jsx)(Y,{children:s.text})]},"".concat(e.id,"-").concat(n))),e.parts.filter(e=>"text"===e.type).map((e,t)=>(0,a.jsx)(R,{responseText:e.text},t)),(null==e?void 0:e.metadata)&&(0,a.jsx)(eA,{metadata:e.metadata}),("assistant"===e.role||"system"===e.role)&&t===F.length-1&&"ready"===M&&(0,a.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,a.jsx)(L.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>P(e),children:(0,a.jsx)(r.ibK,{})}),(0,a.jsx)(L.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(),children:(0,a.jsx)(l.Qxo,{})})]})]}),(0,a.jsx)(k,{name:e.role,src:(e.role,"")})]},e.id)),"submitted"===M&&(0,a.jsxs)(N,{from:"assistant",children:[(0,a.jsx)(v,{children:(0,a.jsxs)("div",{className:"flex gap-1 items-center text-base-content",children:[(0,a.jsx)(g,{className:"size-4"}),"Thinking..."]})}),(0,a.jsx)(k,{name:"assistant",src:""})]}),T&&(0,a.jsx)(er.Z,{message:"An error occurred.",retryConfig:{onRetry:()=>I(),retryDisabled:"streaming"===M||"submitted"===M}})]}),(0,a.jsx)(h,{})]}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)(J,{onSubmit:s=>{s.preventDefault(),(e.trim()||c)&&"ready"===M&&(D({text:e,files:c}),t(""),m(void 0),u.current&&(u.current.value=""))},className:"bg-base-100 rounded-lg",children:[(0,a.jsx)(Q,{value:e,onChange:e=>t(e.target.value),placeholder:"What would you like to know?",minHeight:48,maxHeight:164}),(0,a.jsxs)(Z,{children:[(0,a.jsxs)(K,{children:[(0,a.jsxs)("div",{className:"dropdown dropdown-top",children:[(0,a.jsx)("div",{tabIndex:0,role:"button",className:"btn btn-ghost",children:(0,a.jsx)(i.Lfi,{size:16})}),(0,a.jsxs)("ul",{tabIndex:0,className:"dropdown-content menu bg-base-100 rounded-box z-[999] w-52 p-2 shadow border",children:[(0,a.jsx)("li",{onClick:e=>{var t;e.preventDefault(),null===(t=u.current)||void 0===t||t.click()},children:(0,a.jsxs)("a",{children:[(0,a.jsx)(d.NH0,{})," Attach file to chat"]})}),(0,a.jsx)("li",{onClick:e=>{e.preventDefault()},children:(0,a.jsxs)(eg,{open:f.isDialogOpen,onOpenChange:e=>{b(t=>({...t,isDialogOpen:e,ragFiles:e?t.ragFiles:[]}))},children:[(0,a.jsx)(eb,{asChild:!0,children:(0,a.jsxs)("a",{children:[" ",(0,a.jsx)(o.BqS,{})," Add file knowledge"]})}),(0,a.jsxs)(eN,{children:[(0,a.jsxs)(ev,{className:"mb-4",children:[(0,a.jsxs)(eS,{className:"flex justify-start items-center gap-2",children:[(0,a.jsx)(o.BqS,{size:25})," Add to knowledge base"]}),(0,a.jsxs)(ez,{children:["Upload PDF or TXT files (max ",20,"MB each) to add to the knowledge base."]})]}),(0,a.jsx)(eM,{maxSize:20971520,acceptedFileTypes:{"application/pdf":[".pdf"],"text/plain":[".txt"]},onFilesUploaded:e=>{b(t=>({...t,ragFiles:[...t.ragFiles,...e]}))},onFileRemove:e=>{b(t=>({...t,ragFiles:t.ragFiles.filter(t=>t!==e)}))},values:f.ragFiles}),(0,a.jsxs)(ek,{className:"mt-4",children:[(0,a.jsx)(L.z,{type:"button",disabled:0===f.ragFiles.length||f.isUploading,isLoading:f.isUploading,onClick:U,children:"Upload Files"}),(0,a.jsx)(ey,{asChild:!0,children:(0,a.jsx)(L.z,{type:"button",variant:"ghost",className:"",children:"Close"})})]})]})]})})]})]}),(0,a.jsx)("input",{type:"file",ref:u,onChange:e=>{e.target.files&&m(e.target.files)},multiple:!0,accept:"image/*,text/*,audio/*",className:"hidden"}),(0,a.jsxs)(ee,{onValueChange:e=>{let t=j.find(t=>t.id===e);t&&w(t)},value:y.id,children:[(0,a.jsx)(et,{children:(0,a.jsx)(en,{})}),(0,a.jsx)(es,{children:j.map(e=>(0,a.jsx)(ea,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsx)(G,{disabled:"ready"===M&&!e.trim()&&(!c||0===c.length),status:M,onClick:"submitted"===M||"streaming"===M?O:void 0,type:"submitted"===M||"streaming"===M?"button":"submit"})]}),c&&c.length>0&&(0,a.jsx)("div",{className:"w-full flex px-2 p-2 gap-2",children:Array.from(c).map((e,t)=>(0,a.jsxs)("div",{className:"relative bg-base-200/30 flex w-fit flex-col gap-2 p-1 border-t border-x rounded-md",children:[e.type.startsWith("image/")?(0,a.jsx)("div",{className:"flex text-sm",children:(0,a.jsx)("img",{width:100,height:100,src:URL.createObjectURL(e),alt:e.name,className:"h-auto rounded-md w-auto max-w-[100px] max-h-[100px]"})}):e.type.startsWith("audio/")?(0,a.jsxs)("div",{className:"flex text-sm flex-col",children:[(0,a.jsx)("audio",{src:URL.createObjectURL(e),className:"hidden",children:"Your browser does not support the audio element."}),(0,a.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[100px]",children:e.name})]}):(0,a.jsx)("div",{className:"flex text-sm",children:(0,a.jsx)("span",{className:"text-xs truncate max-w-[100px]",children:e.name})}),(0,a.jsx)("button",{onClick:()=>_(t),className:"absolute -top-1.5 -right-1.5 text-white cursor-pointer bg-red-500 hover:bg-red-600 w-4 h-4 rounded-full flex items-center justify-center",type:"button",children:(0,a.jsx)(r.bjh,{className:"w-3 h-3"})})]},t))})]})})]}):(0,a.jsx)(er.Z,{message:"Your browser does not support Transformers.js. Please try a different browser."})}},25333:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(85893),n=s(96606),r=s(56472),l=e=>{var t;let{message:s,retryConfig:l}=e;return(0,a.jsxs)("div",{className:"flex w-full flex-1 items-center justify-start rounded-lg border border-error p-4 sm:px-6 mt-2",children:[(0,a.jsx)(n.Cw1,{size:50,className:"text-error"}),(0,a.jsxs)("div",{className:"px-4 flex-1 flex justify-between items-center",children:[(0,a.jsx)("p",{children:s}),l&&(0,a.jsx)(r.z,{type:"button",variant:"outline",size:"sm",onClick:l.onRetry,disabled:l.retryDisabled,className:"mt-2 btn-error",children:null!==(t=l.retryMessage)&&void 0!==t?t:"Retry"})]})]})}},32811:function(e,t,s){"use strict";s.d(t,{Bw:function(){return m},Ph:function(){return o},Ql:function(){return u},i4:function(){return c},ki:function(){return d}});var a=s(85893),n=s(67294),r=s(92882),l=s(36965),i=s(96606);let o=r.fC;r.ZA;let d=r.B4,c=n.forwardRef((e,t)=>{let{className:s,children:n,...o}=e;return(0,a.jsxs)(r.xz,{ref:t,className:(0,l.cn)("flex h-10 w-full items-center justify-between rounded-md border input-bordered bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-base-content focus:border-primary focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",s),...o,children:[n,(0,a.jsx)(r.JO,{asChild:!0,children:(0,a.jsx)(i.OrA,{className:"h-4 w-4 opacity-50"})})]})});c.displayName=r.xz.displayName;let m=n.forwardRef((e,t)=>{let{className:s,children:n,position:i="popper",...o}=e;return(0,a.jsx)(r.h_,{children:(0,a.jsx)(r.VY,{ref:t,className:(0,l.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-base-100 shadow-md",s),position:i,...o,children:(0,a.jsx)(r.l_,{className:"p-1",children:n})})})});m.displayName=r.VY.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.__,{ref:t,className:(0,l.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...n})}).displayName=r.__.displayName;let u=n.forwardRef((e,t)=>{let{className:s,children:n,...o}=e;return(0,a.jsxs)(r.ck,{ref:t,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-base-300 ",s),...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.wU,{children:(0,a.jsx)(i.hXj,{className:"h-4 w-4"})})}),(0,a.jsx)(r.eT,{children:n})]})});u.displayName=r.ck.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.Z0,{ref:t,className:(0,l.cn)("-mx-1 my-1 h-px bg-base-300",s),...n})}).displayName=r.Z0.displayName},27129:function(e){function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=27129,e.exports=t}}]);