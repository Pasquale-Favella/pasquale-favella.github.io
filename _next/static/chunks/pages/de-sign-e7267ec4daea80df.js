(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1068],{2297:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/de-sign",function(){return s(40171)}])},64333:function(e,t,s){"use strict";s.d(t,{z:function(){return o}});var a=s(85893);s(67294);var n=s(88426),l=s(45139),r=s(57978);let i=(0,l.j)("btn inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium transition-all disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none",{variants:{variant:{default:"btn-primary",destructive:"btn-error",outline:"btn-outline",secondary:"btn-secondary",ghost:"btn-ghost",link:"btn-link"},size:{default:"btn-md has-[>svg]:px-3",sm:"btn-sm gap-1.5 has-[>svg]:px-2.5",lg:"btn-lg has-[>svg]:px-4",icon:"btn-square btn-md"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:s,size:l,asChild:o=!1,isLoading:c=!1,children:d,...m}=e,h=o?n.g7:"button";return(0,a.jsxs)(h,{"data-slot":"button",className:(0,r.cn)(i({variant:s,size:l,className:t})),disabled:c||m.disabled,...m,children:[c&&(0,a.jsx)("span",{className:"loading loading-spinner"}),d]})}},77117:function(e,t,s){"use strict";var a=s(85893),n=s(67294);t.Z=(0,n.memo)(()=>(0,a.jsx)("div",{className:"flex justify-center px-4 py-16",children:(0,a.jsx)("span",{className:"loading loading-ring loading-lg"})}))},13154:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(85893),n=s(61121),l=s(64333),r=e=>{var t;let{message:s,retryConfig:r}=e;return(0,a.jsxs)("div",{className:"flex w-full flex-1 items-center justify-start rounded-lg border border-error p-4 sm:px-6 mt-2",children:[(0,a.jsx)(n.Cw1,{size:50,className:"text-error"}),(0,a.jsxs)("div",{className:"px-4 flex-1 flex justify-between items-center",children:[(0,a.jsx)("p",{children:s}),r&&(0,a.jsx)(l.z,{type:"button",variant:"outline",size:"sm",onClick:r.onRetry,disabled:r.retryDisabled,className:"mt-2 btn-error",children:null!==(t=r.retryMessage)&&void 0!==t?t:"Retry"})]})]})}},52068:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(85893),n=s(67294),l=s(90512),r=e=>{let{Icon:t,hide:s=!1,className:r,...i}=e,o=(0,n.useId)();return(0,a.jsxs)("div",{hidden:s,className:(0,l.Z)("relative",i.containerClassName),children:[(0,a.jsx)("input",{className:(0,l.Z)("w-full input input-bordered pl-12 transition-colors duration-200 ease-linear focus:border-primary focus:outline-none",r),id:o,...i}),(0,a.jsx)("label",{htmlFor:o,children:(0,a.jsx)(t,{size:20,className:(0,l.Z)("absolute top-1/2 left-4 -translate-y-1/2",i.iconClassName)})})]})}},5567:function(e,t,s){"use strict";s.d(t,{Bw:function(){return m},Ph:function(){return o},Ql:function(){return h},i4:function(){return d},ki:function(){return c}});var a=s(85893),n=s(67294),l=s(92882),r=s(57978),i=s(61121);let o=l.fC;l.ZA;let c=l.B4,d=n.forwardRef((e,t)=>{let{className:s,children:n,...o}=e;return(0,a.jsxs)(l.xz,{ref:t,className:(0,r.cn)("flex h-10 w-full items-center justify-between rounded-md border input-bordered bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-base-content focus:border-primary focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",s),...o,children:[n,(0,a.jsx)(l.JO,{asChild:!0,children:(0,a.jsx)(i.OrA,{className:"h-4 w-4 opacity-50"})})]})});d.displayName=l.xz.displayName;let m=n.forwardRef((e,t)=>{let{className:s,children:n,position:i="popper",...o}=e;return(0,a.jsx)(l.h_,{children:(0,a.jsx)(l.VY,{ref:t,className:(0,r.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-base-100 shadow-md",s),position:i,...o,children:(0,a.jsx)(l.l_,{className:"p-1",children:n})})})});m.displayName=l.VY.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(l.__,{ref:t,className:(0,r.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...n})}).displayName=l.__.displayName;let h=n.forwardRef((e,t)=>{let{className:s,children:n,...o}=e;return(0,a.jsxs)(l.ck,{ref:t,className:(0,r.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-base-300 ",s),...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.wU,{children:(0,a.jsx)(i.hXj,{className:"h-4 w-4"})})}),(0,a.jsx)(l.eT,{children:n})]})});h.displayName=l.ck.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(l.Z0,{ref:t,className:(0,r.cn)("-mx-1 my-1 h-px bg-base-300",s),...n})}).displayName=l.Z0.displayName},40281:function(e,t,s){"use strict";s.d(t,{Ei:function(){return p},Tu:function(){return u},aM:function(){return c},bC:function(){return x},ue:function(){return h},yo:function(){return o}});var a=s(85893),n=s(67294),l=s(89056),r=s(89833),i=s(57978);let o=l.fC,c=l.xz;l.x8;let d=l.h_,m=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(l.aV,{ref:t,"data-slot":"sheet-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-base-content/50",s),...n})});m.displayName=l.aV.displayName;let h=n.forwardRef((e,t)=>{let{side:s="right",className:n,children:o,...c}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(l.VY,{ref:t,"data-slot":"sheet-content",className:(0,i.cn)("bg-base-100 data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===s&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===s&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===s&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===s&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",n),...c,children:[o,(0,a.jsxs)(l.x8,{className:"btn btn-ghost btn-sm absolute top-4 right-4 opacity-70 transition-opacity hover:opacity-100",children:[(0,a.jsx)(r.ven,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=l.VY.displayName;let u=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,"data-slot":"sheet-header",className:(0,i.cn)("flex flex-col gap-1.5 p-4",s),...n})});u.displayName="SheetHeader",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,"data-slot":"sheet-footer",className:(0,i.cn)("mt-auto flex flex-col gap-2 p-4",s),...n})}).displayName="SheetFooter";let x=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(l.Dx,{ref:t,"data-slot":"sheet-title",className:(0,i.cn)("text-base-content font-semibold",s),...n})});x.displayName=l.Dx.displayName;let p=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(l.dk,{ref:t,"data-slot":"sheet-description",className:(0,i.cn)("text-base-content/70 text-sm",s),...n})});p.displayName=l.dk.displayName},40171:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ex}});var a=s(85893),n=s(67294),l=s(19042),r=s(56561),i=s(89833),o=s(15103),c=s(95495),d=s(64667),m=s(25905),h=s(40012),u=s(57978);let x=(0,o.cn)(async()=>{let e=await d.lv.create({extensions:{live:m.a,vector:h.x},dataDir:"idb://de-sign-db"});return await e.exec("\n    -- Sketches table\n    CREATE TABLE IF NOT EXISTS sketches (\n        id TEXT PRIMARY KEY,\n        prompt TEXT NOT NULL,\n        html TEXT NOT NULL,\n        x REAL NOT NULL,\n        y REAL NOT NULL,\n        width REAL NOT NULL,\n        height REAL NOT NULL,\n        view TEXT NOT NULL CHECK (view IN ('result', 'code')),\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n    );\n    -- Sketch history table\n    CREATE TABLE IF NOT EXISTS ai_generated_sketch_history (\n        id SERIAL PRIMARY KEY,\n        sketch_id TEXT NOT NULL,\n        prompt TEXT NOT NULL,\n        html TEXT NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (sketch_id) REFERENCES sketches(id) ON DELETE CASCADE\n    );\n    -- Create indexes\n    CREATE INDEX IF NOT EXISTS idx_ai_generated_sketch_history_sketch_id \n        ON ai_generated_sketch_history(sketch_id);\n    CREATE INDEX IF NOT EXISTS idx_ai_generated_sketch_history_created_at \n        ON ai_generated_sketch_history(created_at DESC);\n    CREATE INDEX IF NOT EXISTS idx_sketches_updated_at \n        ON sketches(updated_at DESC);\n    "),e}),p=(0,c.n7)(x),b=["openai","anthropic","google"],f={openai:["gpt-3.5-turbo","gpt-4","gpt-4o","gpt-4-turbo","gpt-4o-mini"],anthropic:["claude-3-5-haiku-latest","claude-3-5-sonnet-latest","claude-4-opus-20250514","claude-4-sonnet-20250514"],google:["models/gemini-2.5-pro","models/gemini-2.5-flash","models/gemini-2.0-flash","models/gemini-1.5-flash-001","models/gemini-1.5-pro-001"]},g={openai:"https://platform.openai.com/account/api-keys",anthropic:"https://console.anthropic.com/settings/keys",google:"https://aistudio.google.com/app/apikey"},v=(0,c.O4)("sketch-ai-provider","google"),j=(0,c.O4)("sketch-ai-model",f.google[0]),y=(0,c.O4)("sketch-ai-api-key",""),N="SELECT * FROM sketches ORDER BY updated_at DESC",w=(e,t)=>{switch(t.type){case"ADD":return[...e,t.payload];case"UPDATE":return e.map(e=>e.id===t.payload.id?{...e,...t.payload.updates}:e);case"DELETE":return e.filter(e=>e.id!==t.payload);case"SYNC":return t.payload;default:return e}},k=(0,o.cn)(null),E=(0,o.cn)(async e=>{let t=e(k);if(t)return t;let s=e(p);if("hasData"===s.state){let e=s.data;return(await e.query(N)).rows}return[]},(e,t,s)=>{e(E).then(e=>{t(k,w(e,s))})}),C=(0,o.cn)(null,async(e,t,s)=>{let a=e(p);if("hasData"!==a.state){console.error("Database not ready");return}let n=a.data;t(E,s);let l=await u.Sb.tryOf((async()=>{switch(s.type){case"ADD":{let e=s.payload;await n.query("INSERT INTO sketches (id, prompt, html, x, y, width, height, view)\n             VALUES ($1, $2, $3, $4, $5, $6, $7, $8)",[e.id,e.prompt,e.html,e.x,e.y,e.width,e.height,e.view]),await T(n,e.id,e.prompt,e.html);break}case"UPDATE":{var e;let{id:t,updates:a}=s.payload,l=null===(e=(await n.query("SELECT * FROM sketches WHERE id = $1",[t])).rows)||void 0===e?void 0:e.at(0);if(!l)throw Error("Sketch not found");let r={...l,...a};await n.query("UPDATE sketches \n             SET prompt = $2, html = $3, x = $4, y = $5, \n                 width = $6, height = $7, view = $8, updated_at = CURRENT_TIMESTAMP\n             WHERE id = $1",[t,r.prompt,r.html,r.x,r.y,r.width,r.height,r.view]),l.html!==r.html&&l.prompt!==r.prompt&&await T(n,t,r.prompt,r.html);break}case"DELETE":await n.query("DELETE FROM sketches WHERE id = $1",[s.payload])}})());if(!l.err)return;console.error("Database operation failed:",l.err);let r=await u.Sb.tryOf(n.query(N));if(r.err){console.error("Rollback failed:",r.err);return}t(E,{type:"SYNC",payload:r.result.rows})});async function T(e,t,s,a){await e.query("INSERT INTO ai_generated_sketch_history (sketch_id, prompt, html)\n               VALUES ($1, $2, $3)",[t,s,a])}var S=s(5567),R=s(52068),D=s(95352),L=s(24622),_=s(62925),A=s(27965),O=s(73652),z=s(48583);let M=()=>{let[e,t]=(0,z.KO)(v),[s,a]=(0,z.KO)(j),[l,r]=(0,z.KO)(y),i=(0,z.Dv)(E),o=(0,z.b9)(C),[c,d]=(0,n.useState)(null),[m,h]=(0,n.useState)({x:0,y:0,scale:1}),u=(0,n.useMemo)(()=>{if(!l)return null;switch(e){case"openai":return(0,_.J)({apiKey:l});case"anthropic":return(0,D.D)({apiKey:l});case"google":return(0,L.L)({apiKey:l});default:return null}},[e,l]),x=(0,n.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!u)throw Error("AI provider not configured");let a={role:"user",content:[{type:"text",text:'You are an expert web designer. Create a single, self-contained HTML component for the following request: "'.concat(e,'".').concat(t?" The user has provided an image for reference.":"")}]};t&&Array.isArray(a.content)&&a.content.push({type:"image",image:t.data});let{text:n}=await (0,O._4)({model:u(s),messages:[a],system:"\n                1. Use Tailwind CSS classes for styling. Assume Tailwind is loaded from a CDN.\n                2. Do NOT include `<html>`, `<head>`, or `<body>` tags.\n                3. The root element should be a `<div>` that is designed to fill its container (e.g., using `w-full`, `h-full`).\n                4. Ensure the design is modern, visually appealing, and responsive.\n                5. ONLY output the HTML code. No explanations, no markdown formatting, just the raw HTML.\n                "});return b(n)},[u,s]),p=(0,n.useCallback)(async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!u)throw Error("AI provider not configured");let n={role:"user",content:[{type:"text",text:"\n            You are an expert web designer. A user wants to modify an existing HTML component.\n            \n            User's request: \"".concat(e,'"').concat(a?" The user has provided an image for reference.":"","\n            \n            Original HTML:\n            ```html\n            ").concat(t,"\n            ```")}]};a&&Array.isArray(n.content)&&n.content.push({type:"image",image:a.data});let{text:l}=await (0,O._4)({model:u(s),messages:[n],system:"\n                1. Provide the new, complete HTML content that incorporates the user's change.\n                2. Continue using Tailwind CSS classes for styling.\n                3. Do NOT include `<html>`, `<head>`, or `<body>` tags.\n                4. The root element should remain a container-filling `<div>`.\n                5. ONLY output the new HTML code. No explanations, no markdown formatting, just the raw HTML.\n                "});return b(l)},[u,s]),b=e=>e.trim().replace(/^```html|```$/g,"").trim(),g=(0,n.useCallback)(e=>{t(e),a(f[e][0])},[t,a]),N=async e=>{await o({type:"ADD",payload:e})},w=async(e,t)=>{await o({type:"UPDATE",payload:{id:e,updates:t}})},k=async e=>{await o({type:"DELETE",payload:e}),c===e&&d(null)},T=(0,n.useCallback)(e=>{let t=i.find(t=>t.id===e);t&&N({...t,id:"sketch_".concat(Date.now()),x:t.x+20,y:t.y+20})},[i,N]),S=(0,n.useCallback)(e=>i.find(t=>t.id===e),[i]),R=(0,n.useCallback)((e,t)=>{if(0===i.length){h({x:0,y:0,scale:1});return}let s=1/0,a=1/0,n=-1/0,l=-1/0;i.forEach(e=>{s=Math.min(s,e.x),a=Math.min(a,e.y),n=Math.max(n,e.x+e.width),l=Math.max(l,e.y+e.height)});let r=n-s,o=l-a;if(r<=0||o<=0)return;let c=Math.min((e-200)/r,(t-200)/o,1.5);h({x:e/2-(s+r/2)*c,y:t/2-(a+o/2)*c,scale:c})},[i]),A=(0,n.useCallback)(e=>{h(t=>({...t,scale:e}))},[]);return{sketches:i,selectedSketchId:c,canvasTransform:m,addSketch:N,updateSketch:w,deleteSketch:k,duplicateSketch:T,getSketchById:S,setSelectedSketchId:d,setCanvasTransform:h,setZoom:A,fitToScreen:R,generateHtml:x,editHtml:p,provider:e,model:s,apiKey:l,handleProviderChange:g,setModel:a,setApiKey:r}},I=e=>{let t=(0,A.yR)("\n        SELECT *\n        FROM sketches\n        WHERE id = $1\n    ",[e]);return(0,n.useMemo)(()=>{var e;return null==t?void 0:null===(e=t.rows)||void 0===e?void 0:e.at(0)},[null==t?void 0:t.rows])},P=e=>{let t=(0,A.yR)("\n            SELECT prompt, html, created_at AS timestamp\n            FROM ai_generated_sketch_history\n            WHERE sketch_id = $1\n            ORDER BY timestamp ASC;\n        ",[e]);return(0,n.useMemo)(()=>{var e;return(null!==(e=null==t?void 0:t.rows)&&void 0!==e?e:[]).map(e=>({...e,timestamp:new Date(e.timestamp).toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}))},[null==t?void 0:t.rows])};var U=()=>{let{provider:e,model:t,apiKey:s,handleProviderChange:n,setModel:l,setApiKey:r}=M();return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Provider"}),(0,a.jsxs)(S.Ph,{onValueChange:n,value:e,children:[(0,a.jsx)(S.i4,{children:(0,a.jsx)(S.ki,{placeholder:"Select a provider"})}),(0,a.jsx)(S.Bw,{children:b.map(e=>(0,a.jsx)(S.Ql,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Model"}),(0,a.jsxs)(S.Ph,{onValueChange:l,value:t,children:[(0,a.jsx)(S.i4,{children:(0,a.jsx)(S.ki,{placeholder:"Select a model"})}),(0,a.jsx)(S.Bw,{children:f[e].map(e=>(0,a.jsx)(S.Ql,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"API Key"}),(0,a.jsx)(R.Z,{Icon:i.MhP,type:"password",value:s,onChange:e=>r(e.target.value),placeholder:"Enter your API key"}),(0,a.jsxs)("a",{href:g[e],target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline mt-1 block",children:["Get your API key from ",e]})]})]})},F=e=>{let{onClose:t,onSubmit:s,isLoading:o,type:c,initialPrompt:d}=e,{apiKey:m}=M(),[h,u]=(0,n.useState)(""),[x,p]=(0,n.useState)(null),[b,f]=(0,n.useState)(!1),g=(0,n.useRef)(null);(0,n.useEffect)(()=>()=>{x&&URL.revokeObjectURL(x.previewUrl)},[x]);let v=e=>{e&&e.type.startsWith("image/")&&p({file:e,previewUrl:URL.createObjectURL(e)})},j=async e=>{if(e.preventDefault(),!h.trim()&&!x)return;let t=null;x&&(t=await new Promise((e,t)=>{let s=new FileReader;s.onloadend=()=>{"string"==typeof s.result?e({data:s.result.split(",")[1],mimeType:x.file.type}):t(Error("Failed to read file as base64 string."))},s.onerror=e=>t(e),s.readAsDataURL(x.file)})),s(h,t)};return(0,a.jsxs)("div",{className:"modal modal-open z-10",children:[(0,a.jsxs)("div",{className:"modal-box max-w-2xl relative bg-base-200 border border-base-300",onClick:e=>e.stopPropagation(),onDragOver:e=>{e.preventDefault()},onDragEnter:e=>{e.preventDefault(),f(!0)},onDragLeave:e=>{e.preventDefault(),e.currentTarget.contains(e.relatedTarget)||f(!1)},onDrop:e=>{var t;e.preventDefault(),f(!1),v(null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0])},onPaste:e=>{var t;let s=null===(t=Array.from(e.clipboardData.items).find(e=>e.type.startsWith("image/")))||void 0===t?void 0:t.getAsFile();s&&(e.preventDefault(),v(s))},children:[b&&(0,a.jsx)("div",{className:"absolute inset-0 bg-primary/20 backdrop-blur-sm border-2 border-dashed border-primary rounded-box flex items-center justify-center pointer-events-none z-10",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(l.w_C,{className:"w-12 h-12 text-primary"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-primary",children:"Drop image to attach"})]})}),(0,a.jsxs)("form",{onSubmit:j,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"font-bold text-xl flex items-center gap-2",children:[(0,a.jsx)(l.dvR,{className:"w-6 h-6 text-primary"}),"create"===c?"Create a new sketch":"Edit sketch"]}),(0,a.jsx)("button",{type:"button",onClick:t,className:"btn btn-ghost btn-sm btn-circle",disabled:o||!m,children:(0,a.jsx)(l.apv,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"form-control",children:(0,a.jsx)("textarea",{autoFocus:!0,value:h,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&j(e)},placeholder:"create"===c?"e.g., a login form with a neon blue theme. You can also paste or drop an image.":"e.g., change the primary button to green. Paste or drop an image to provide context.",className:"textarea textarea-bordered h-32 resize-none bg-base-300 focus:textarea-primary",disabled:o})}),x&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("div",{className:"relative w-24 h-24 rounded-box overflow-hidden border-2 border-base-300",children:[(0,a.jsx)("img",{src:x.previewUrl,alt:"Preview",className:"w-full h-full object-cover"}),(0,a.jsx)("button",{type:"button",onClick:()=>{p(null)},className:"absolute top-1 right-1 btn btn-circle btn-xs btn-error","aria-label":"Remove image",children:(0,a.jsx)(l.apv,{className:"w-3 h-3"})})]})}),!m&&(0,a.jsx)("div",{className:"mt-4 alert alert-info",children:(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"Configure AI"}),(0,a.jsxs)("p",{className:"opacity-80 font-mono whitespace-pre-wrap flex",children:["Setup AI provider using settings ",(0,a.jsx)(i.TXX,{className:"size-4"})]})]})}),"edit"===c&&d&&(0,a.jsx)("div",{className:"mt-4 alert alert-info",children:(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"Previous Prompt:"}),(0,a.jsx)("p",{className:"opacity-80 font-mono whitespace-pre-wrap",children:null==d?void 0:d.trim()})]})}),(0,a.jsxs)("div",{className:"modal-action flex justify-between items-center",children:[(0,a.jsx)("div",{className:"tooltip","data-tip":"AI Settings",children:(0,a.jsxs)(r.J2,{children:[(0,a.jsx)(r.xo,{className:"btn btn-ghost btn-sm btn-circle",disabled:o,children:(0,a.jsx)(i.TXX,{className:"size-5"})}),(0,a.jsx)(r.yk,{className:"z-50",children:(0,a.jsx)(U,{})})]})}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("input",{type:"file",ref:g,onChange:e=>{var t;v(null===(t=e.target.files)||void 0===t?void 0:t[0]),e.target&&(e.target.value="")},className:"hidden",accept:"image/*"}),(0,a.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},disabled:o,className:"btn btn-ghost btn-sm btn-circle",title:"Attach image",children:(0,a.jsx)(l.w_C,{className:"size-5"})}),(0,a.jsx)("button",{type:"button",onClick:t,disabled:o,className:"btn btn-ghost btn-sm",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:o||!h.trim()&&!x,className:"btn btn-primary btn-sm gap-2",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"loading loading-spinner loading-sm"}),"Generating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.dvR,{className:"w-4 h-4"}),"create"===c?"Generate":"Update"]})})]})]})]})]}),(0,a.jsx)("div",{className:"modal-backdrop",onClick:t})]})},X=s(77656),Y=s(63764),$=s(2777),H=s(35282),q=s(77117),Z=(0,n.memo)(e=>{let{sketch:t,isSelected:s,onSelect:l,onUpdate:r,onDelete:i,onDuplicate:o,onEdit:c,onFullscreen:d,canvasScale:m}=e,{isDarkMode:h}=(0,X.F)(),[u,x]=(0,n.useState)(!1),[p,b]=(0,n.useState)(!1),[f,g]=(0,n.useState)({x:t.x,y:t.y}),[v,j]=(0,n.useState)({width:t.width,height:t.height}),y=(0,n.useRef)({x:0,y:0}),N=(0,n.useRef)({x:0,y:0}),w=(0,n.useRef)({width:0,height:0}),k=(0,n.useRef)(null);(0,n.useEffect)(()=>{u||p||(g({x:t.x,y:t.y}),j({width:t.width,height:t.height}))},[t.x,t.y,t.width,t.height,u,p]);let E=(0,n.useCallback)(e=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(()=>{if(u){let t=(e.clientX-y.current.x)/m,s=(e.clientY-y.current.y)/m;g({x:N.current.x+t,y:N.current.y+s})}if(p){let t=(e.clientX-y.current.x)/m,s=(e.clientY-y.current.y)/m;j({width:Math.max(200,w.current.width+t),height:Math.max(150,w.current.height+s)})}})},[u,p,m]),C=(0,n.useCallback)(async()=>{k.current&&cancelAnimationFrame(k.current),u&&await r(t.id,{x:f.x,y:f.y}),p&&await r(t.id,{width:v.width,height:v.height}),x(!1),b(!1)},[u,p,t.id,f,v,r]);(0,n.useEffect)(()=>{if(u||p)return document.addEventListener("mousemove",E),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",C)}},[u,p,E,C]);let T='\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <script src="https://cdn.tailwindcss.com"></script>\n      </head>\n      <body class="h-full w-full m-0 p-0 overflow-hidden">\n        '.concat(t.html,"\n      </body>\n    </html>\n  ");return(0,a.jsxs)("div",{style:{position:"absolute",left:f.x,top:f.y,width:v.width,height:v.height,cursor:u?"grabbing":"grab",userSelect:"none"},className:"card bg-base-200 shadow-xl flex flex-col transition-shadow duration-200 ".concat(s?"ring-2 ring-primary":""),onMouseDown:l,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"card-title bg-base-300/50 rounded-t-2xl flex items-center justify-between px-3 py-2 cursor-grab select-none",onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),l(),x(!0),y.current={x:e.clientX,y:e.clientY},N.current={x:t.x,y:t.y}},children:[(0,a.jsx)("div",{className:"flex items-center gap-2 text-xs opacity-70 overflow-hidden whitespace-nowrap",children:(0,a.jsx)("span",{className:"truncate",children:t.prompt.split("\n").pop()})}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"tooltip","data-tip":"result"===t.view?"Show Code":"Show Result",children:(0,a.jsx)("button",{onClick:()=>{r(t.id,{view:"result"===t.view?"code":"result"})},className:"btn btn-ghost btn-xs btn-square",title:"result"===t.view?"Show Code":"Show Result",children:"result"===t.view?(0,a.jsx)($.xqv,{size:14}):(0,a.jsx)($.rDJ,{size:14})})}),(0,a.jsx)("div",{className:"tooltip","data-tip":"Edit",children:(0,a.jsx)("button",{onClick:c,className:"btn btn-ghost btn-xs btn-square",title:"Edit",children:(0,a.jsx)($.vPQ,{size:14})})}),(0,a.jsx)("div",{className:"tooltip","data-tip":"Fullscreen",children:(0,a.jsx)("button",{onClick:d,className:"btn btn-ghost btn-xs btn-square",title:"Fullscreen",children:(0,a.jsx)($.D7o,{size:14})})}),(0,a.jsx)("div",{className:"tooltip","data-tip":"Duplicate",children:(0,a.jsx)("button",{onClick:()=>o(t.id),className:"btn btn-ghost btn-xs btn-square",title:"Duplicate",children:(0,a.jsx)($.C3L,{size:14})})}),(0,a.jsx)("div",{className:"tooltip","data-tip":"Delete",children:(0,a.jsx)("button",{onClick:()=>i(t.id),className:"btn btn-ghost btn-xs btn-square",title:"Delete",children:(0,a.jsx)($.Ybf,{size:14})})})]})]}),(0,a.jsx)("div",{className:"flex-grow w-full h-full bg-base-100 relative overflow-hidden rounded-b-2xl pointer-events-auto",children:"result"===t.view?(0,a.jsx)("iframe",{srcDoc:T,title:"Sketch Result",sandbox:"allow-scripts allow-same-origin",className:"w-full h-full border-0",style:{pointerEvents:u||p?"none":"auto"}}):(0,a.jsx)(Y.ML,{theme:h?"vs-dark":"light",language:"html",defaultValue:t.html,loading:(0,a.jsx)(q.Z,{}),options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1}})}),(0,a.jsx)("div",{className:"tooltip z-10 absolute bottom-0.5 right-0.5 ","data-tip":"Resize",children:(0,a.jsx)("button",{type:"button",onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),l(),b(!0),y.current={x:e.clientX,y:e.clientY},w.current={width:t.width,height:t.height}},className:"cursor-se-resize btn btn-ghost btn-sm btn-circle",children:(0,a.jsx)(H.xJz,{className:"size-5"})})})]})}),B=s(40281),W=s(80322),V=s(86501),K=e=>{let{sketchId:t,currentSketchHtml:s}=e,[r,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),[m,h]=(0,n.useState)(null),[x,p]=(0,n.useState)(!1),b=(0,n.useRef)(null),f=(0,n.useRef)(null),{editHtml:g,updateSketch:v,apiKey:j}=M(),y=(0,n.useMemo)(()=>!j,[j]);(0,n.useEffect)(()=>()=>{m&&URL.revokeObjectURL(m.previewUrl)},[m]),(0,n.useEffect)(()=>{f.current&&(f.current.style.height="auto",f.current.style.height="".concat(Math.min(f.current.scrollHeight,120),"px"))},[r]);let N=e=>{e&&e.type.startsWith("image/")&&(m&&URL.revokeObjectURL(m.previewUrl),h({file:e,previewUrl:URL.createObjectURL(e)}))},w=()=>{m&&URL.revokeObjectURL(m.previewUrl),h(null)},k=async e=>{if(e.preventDefault(),!r.trim()&&!m||y||c)return;let a=null;m&&(a=await new Promise((e,t)=>{let s=new FileReader;s.onloadend=()=>{"string"==typeof s.result?e({data:s.result.split(",")[1],mimeType:m.file.type}):t(Error("Failed to read file as base64 string."))},s.onerror=e=>t(e),s.readAsDataURL(m.file)})),d(!0);let{err:n,result:l}=await u.Sb.tryOf(g(r,s,a));if(d(!1),n){console.error("Failed to edit sketch:",n),V.default.error("Error editing sketch. Please check the console.");return}v(t,{html:l,prompt:r}),o(""),w()};return(0,a.jsx)("div",{className:"p-4 border-t border-base-300 bg-base-200 flex-shrink-0",children:(0,a.jsx)("form",{onSubmit:k,className:"w-full",children:(0,a.jsxs)("div",{className:"relative w-full",onDragOver:e=>{e.preventDefault()},onDragEnter:e=>{e.preventDefault(),p(!0)},onDragLeave:e=>{e.preventDefault(),e.currentTarget.contains(e.relatedTarget)||p(!1)},onDrop:e=>{var t;e.preventDefault(),p(!1),N(null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0])},children:[x&&(0,a.jsx)("div",{className:"absolute inset-0 bg-primary/20 backdrop-blur-sm border-2 border-dashed border-primary rounded-lg flex items-center justify-center pointer-events-none z-10",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(l.w_C,{className:"w-8 h-8 text-primary"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-primary",children:"Drop image to attach"})]})}),y&&(0,a.jsx)("div",{className:"mb-4 alert alert-info",children:(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"Configure AI"}),(0,a.jsxs)("p",{className:"opacity-80 font-mono whitespace-pre-wrap flex",children:["Setup AI provider using settings ",(0,a.jsx)(i.TXX,{className:"size-4"})]})]})}),m&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden border-2 border-base-300 inline-block",children:[(0,a.jsx)("img",{src:m.previewUrl,alt:"Preview",className:"w-full h-full object-cover"}),(0,a.jsx)("button",{type:"button",onClick:w,className:"absolute top-0.5 right-0.5 btn btn-circle btn-xs btn-error","aria-label":"Remove image",disabled:c,children:(0,a.jsx)(l.apv,{className:"w-3 h-3"})})]})}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("textarea",{ref:f,value:r,onChange:e=>o(e.target.value),onPaste:e=>{var t;let s=null===(t=Array.from(e.clipboardData.items).find(e=>e.type.startsWith("image/")))||void 0===t?void 0:t.getAsFile();s&&(e.preventDefault(),N(s))},placeholder:"Describe changes... (paste or drag image)",className:"textarea textarea-bordered w-full resize-none bg-base-300 focus:textarea-primary text-sm pr-20 pl-3 no-scrollbar",disabled:c||y,rows:2}),(0,a.jsxs)("div",{className:"absolute right-2 bottom-2 flex items-center gap-1",children:[(0,a.jsx)("input",{type:"file",ref:b,onChange:e=>{var t;N(null===(t=e.target.files)||void 0===t?void 0:t[0]),e.target&&(e.target.value="")},className:"hidden",accept:"image/*"}),(0,a.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},disabled:c||y,className:"btn btn-ghost btn-xs btn-circle hover:bg-base-200",title:"Attach image",children:(0,a.jsx)(l.w_C,{className:"size-4"})}),(0,a.jsx)("button",{type:"submit",disabled:c||y||!r.trim()&&!m,className:"btn btn-primary btn-xs btn-circle",title:"Send message",children:c?(0,a.jsx)("span",{className:"loading loading-spinner loading-xs"}):(0,a.jsx)($.LbG,{className:"size-3"})})]})]})]})})})},G=s(46293),J=s(14053),Q=s(19113);function ee(e){let{...t}=e;return(0,a.jsx)(Q.fC,{"data-slot":"hover-card",...t})}function et(e){let{...t}=e;return(0,a.jsx)(Q.xz,{"data-slot":"hover-card-trigger",...t})}function es(e){let{className:t,align:s="center",sideOffset:n=4,...l}=e;return(0,a.jsx)(Q.h_,{"data-slot":"hover-card-portal",children:(0,a.jsx)(Q.VY,{"data-slot":"hover-card-content",align:s,sideOffset:n,className:(0,u.cn)("card bg-base-100 shadow-xl border border-base-300 w-64 p-4 z-50","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2","data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","origin-(--radix-hover-card-content-transform-origin) outline-hidden",t),...l})})}var ea=e=>{let{isCollapsed:t,onToggle:s}=e,{provider:n,model:l,apiKey:r,handleProviderChange:o,setModel:c,setApiKey:d}=M();return(0,a.jsxs)("div",{className:"border-b border-base-300 flex-shrink-0",children:[(0,a.jsxs)("button",{type:"button",onClick:s,className:"w-full p-4 flex items-center justify-between hover:bg-base-300/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)($.nbt,{className:"w-4 h-4 text-primary"}),(0,a.jsx)("span",{className:"font-semibold text-sm",children:"AI Settings"}),!r&&(0,a.jsx)("span",{className:"badge badge-warning badge-sm",children:"Not configured"})]}),t?(0,a.jsx)($.bTu,{className:"w-4 h-4"}):(0,a.jsx)($.rH8,{className:"w-4 h-4"})]}),!t&&(0,a.jsxs)("div",{className:"px-4 pb-4 space-y-3 animate-in slide-in-from-top-2 duration-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1.5 opacity-70",children:"Provider"}),(0,a.jsxs)(S.Ph,{onValueChange:o,value:n,children:[(0,a.jsx)(S.i4,{className:"h-9 text-sm",children:(0,a.jsx)(S.ki,{placeholder:"Select a provider"})}),(0,a.jsx)(S.Bw,{className:"z-[9999]",children:b.map(e=>(0,a.jsx)(S.Ql,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1.5 opacity-70",children:"Model"}),(0,a.jsxs)(S.Ph,{onValueChange:c,value:l,children:[(0,a.jsx)(S.i4,{className:"h-9 text-sm",children:(0,a.jsx)(S.ki,{placeholder:"Select a model"})}),(0,a.jsx)(S.Bw,{className:"z-[9999]",children:f[n].map(e=>(0,a.jsx)(S.Ql,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1.5 opacity-70",children:"API Key"}),(0,a.jsx)(R.Z,{Icon:i.MhP,type:"password",value:r,onChange:e=>d(e.target.value),placeholder:"Enter your API key",className:"input-sm bg-transparent"}),(0,a.jsxs)("a",{href:g[n],target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline mt-1.5 inline-block",children:["Get API key from ",n]})]})]})]})};let en=e=>'\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <script src="https://cdn.tailwindcss.com"></script>\n        </head>\n        <body class="h-full w-full m-0 p-0 overflow-auto">\n            '.concat(e,"\n        </body>\n        </html>\n    "),el=()=>{let{isAtBottom:e,scrollToBottom:t}=(0,W.a)(),s=(0,n.useCallback)(()=>{t()},[t]);return e?null:(0,a.jsx)("button",{onClick:s,className:"sticky bottom-4 btn btn-circle btn-primary btn-sm shadow-lg","aria-label":"Scroll to latest",children:(0,a.jsx)($.tv1,{className:"h-4 w-4"})})};var er=e=>{let{sketchId:t,onClose:s}=e,{isDarkMode:l}=(0,X.F)(),[r,i]=(0,n.useState)("result"),o=I(t),c=P(t),{updateSketch:d}=M(),{editedHtml:m,setEditedHtml:h,hasHtmlChanges:x}=function(e){let[t,s]=(0,n.useState)(null!=e?e:"");(0,n.useEffect)(()=>{s(null!=e?e:"")},[e]);let a=(0,n.useMemo)(()=>t!==e,[t,e]);return{editedHtml:t,setEditedHtml:s,hasHtmlChanges:a}}(null==o?void 0:o.html),[p,b]=(0,n.useState)("desktop"),[f,g]=(0,n.useState)(!1),[v,j]=(0,n.useState)(!0),y=(0,n.useRef)(null),N=async()=>{let{err:e}=await u.Sb.tryOf((async()=>{var e;let t=y.current,s=(null==t?void 0:t.contentDocument)||(null==t?void 0:null===(e=t.contentWindow)||void 0===e?void 0:e.document),a=null==s?void 0:s.body;if(!a)throw Error("Iframe body not found");let n=await (0,G.SE)(a,{cacheBust:!0,pixelRatio:3,backgroundColor:"#ffffff"});if(!n)throw Error("Blob not found");await navigator.clipboard.write([new ClipboardItem({"image/png":n})])})());if(e){console.error("Failed to copy:",e),V.default.error("Error copying to clipboard. Please check the console.");return}V.default.success("Image copied! Paste directly into Figma (Cmd/Ctrl+V)")};(0,n.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]);let w=(0,n.useMemo)(()=>en(m),[m]),k=async()=>{await d(t,{html:m})},E=async e=>{await d(t,{html:e})},C=()=>{let e=new Blob([w],{type:"text/html"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="".concat((null==o?void 0:o.prompt.split(" ").slice(0,5).join("_"))||"sketch",".html"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},T=()=>{var e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ea,{isCollapsed:v,onToggle:()=>j(e=>!e)}),(0,a.jsxs)("div",{className:"p-4 border-b border-base-300 space-y-2 flex-shrink-0",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm mb-2 opacity-70",children:"Controls"}),"code"===r&&(0,a.jsx)("button",{onClick:k,disabled:!x,className:"btn btn-primary btn-sm w-full",children:x?"Save Changes":"Saved"}),(0,a.jsxs)("button",{onClick:C,className:"btn btn-neutral btn-sm w-full gap-2",children:[(0,a.jsx)($._hL,{size:16})," Download HTML"]}),"result"===r&&(0,a.jsxs)("button",{onClick:N,className:"btn btn-primary btn-sm w-full gap-2",children:[(0,a.jsx)($.He2,{size:16})," Copy to FIGMA"]})]}),(0,a.jsx)(W.h,{className:"flex-grow overflow-y-auto relative no-scrollbar [&>*:first-child]:no-scrollbar",resize:"smooth",children:(0,a.jsxs)(W.h.Content,{children:[(0,a.jsxs)("div",{className:"p-4 pb-16",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm mb-3 opacity-70",children:"AI Generation History"}),0===c.length?(0,a.jsx)("p",{className:"text-xs opacity-50 text-center py-8",children:"No history yet"}):(0,a.jsx)("ul",{className:"space-y-3",children:c.map((e,t)=>{let s=(null==o?void 0:o.html)===e.html,n=en(e.html);return(0,a.jsx)("li",{className:(0,u.cn)("relative overflow-hidden rounded-xl transition-all duration-200",s?"ring-2 ring-primary shadow-lg":"hover:shadow-md cursor-pointer"),children:(0,a.jsxs)("div",{className:"p-4 ".concat(s?"bg-gradient-to-br from-primary/10 to-primary/5":"bg-base-300 group hover:bg-base-200"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,a.jsx)("div",{className:(0,u.cn)("flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold",s?"bg-primary text-primary-content":"bg-base-100 text-base-content opacity-60"),children:t+1}),s?(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full bg-primary/20 text-primary",children:[(0,a.jsx)($.UgA,{className:"size-3"}),(0,a.jsx)("span",{className:"text-[10px] font-semibold",children:"Active"})]}):(0,a.jsxs)(ee,{openDelay:200,closeDelay:100,children:[(0,a.jsx)(et,{asChild:!0,children:(0,a.jsxs)("button",{onClick:()=>E(e.html),className:"btn btn-xs btn-ghost gap-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[(0,a.jsx)($.bxQ,{className:"size-3"}),(0,a.jsx)("span",{className:"text-[10px]",children:"Restore"})]})}),(0,a.jsxs)(es,{side:"right",align:"start",className:"w-80 p-3 z-[9999]",children:[(0,a.jsxs)("h3",{className:"text-xs font-semibold mb-2",children:["Preview - Version ",t+1]}),(0,a.jsx)("div",{className:"w-full h-48 bg-base-300 rounded-lg overflow-hidden border border-base-300",children:(0,a.jsx)("iframe",{srcDoc:n,title:"Preview ".concat(t),sandbox:"allow-scripts allow-same-origin",className:"w-full h-full border-0",style:{width:"200%",height:"200%",transform:"scale(0.5)",transformOrigin:"top left"}})}),(0,a.jsx)("p",{className:"text-[10px] opacity-60 mt-2",children:e.timestamp})]})]})]}),(0,a.jsx)("span",{className:"text-[10px] opacity-50 whitespace-nowrap flex-shrink-0",children:e.timestamp})]}),(0,a.jsx)("p",{className:"text-xs leading-relaxed break-words whitespace-pre-wrap opacity-90 mt-3",children:e.prompt})]})},t)})})]}),(0,a.jsx)("div",{className:"sticky bottom-0 left-0 right-0 flex justify-center pb-4 pointer-events-none",children:(0,a.jsx)("div",{className:"pointer-events-auto",children:(0,a.jsx)(el,{})})})]})}),(0,a.jsx)(K,{sketchId:t,currentSketchHtml:null!==(e=null==o?void 0:o.html)&&void 0!==e?e:""})]})};return(0,a.jsxs)("div",{className:"fixed inset-0 bg-base-300 flex flex-col z-[99]",children:[(0,a.jsx)(J.Z,{}),(0,a.jsxs)("header",{className:"flex-shrink-0 bg-base-200/80 backdrop-blur-sm border-b border-base-300 h-14 flex items-center justify-between px-2 sm:px-4",children:[(0,a.jsxs)("div",{className:"text-xs sm:text-sm opacity-80 truncate flex-1 min-w-0 mr-2",children:[(0,a.jsx)("span",{className:"font-semibold hidden sm:inline",children:"Fullscreen Mode:"}),(0,a.jsx)("span",{className:"ml-1",children:null==o?void 0:o.prompt})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"join",children:[(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":"Result",children:(0,a.jsx)("button",{onClick:()=>i("result"),className:"btn btn-xs sm:btn-sm join-item ".concat("result"===r?"btn-primary":"btn-ghost"),children:(0,a.jsx)($.rDJ,{size:14,className:"sm:w-4 sm:h-4"})})}),(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":"Code",children:(0,a.jsx)("button",{onClick:()=>i("code"),className:"btn btn-xs sm:btn-sm join-item ".concat("code"===r?"btn-primary":"btn-ghost"),children:(0,a.jsx)($.xqv,{size:14,className:"sm:w-4 sm:h-4"})})})]}),(0,a.jsx)("div",{className:"divider divider-horizontal mx-1 hidden sm:flex"}),(0,a.jsxs)("div",{className:"join hidden sm:flex",children:[(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":"Mobile",children:(0,a.jsx)("button",{onClick:()=>b("mobile"),className:"btn btn-sm btn-ghost join-item ".concat("mobile"===p?"text-primary":""),children:(0,a.jsx)($.L$C,{size:16})})}),(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":"Tablet",children:(0,a.jsx)("button",{onClick:()=>b("tablet"),className:"btn btn-sm btn-ghost join-item ".concat("tablet"===p?"text-primary":""),children:(0,a.jsx)($.eXJ,{size:16})})}),(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":"Desktop",children:(0,a.jsx)("button",{onClick:()=>b("desktop"),className:"btn btn-sm btn-ghost join-item ".concat("desktop"===p?"text-primary":""),children:(0,a.jsx)($.hRw,{size:16})})})]}),(0,a.jsx)("div",{className:"divider divider-horizontal mx-1 lg:hidden"}),(0,a.jsx)("button",{onClick:()=>g(!0),className:"btn btn-xs sm:btn-sm btn-ghost lg:hidden",children:(0,a.jsx)($.cur,{size:16})}),(0,a.jsx)("div",{className:"divider divider-horizontal mx-1 sm:mx-2"}),(0,a.jsx)("div",{className:"tooltip tooltip-left","data-tip":"Close",children:(0,a.jsx)("button",{onClick:s,className:"btn btn-xs sm:btn-sm btn-ghost btn-square text-error hover:btn-error",children:(0,a.jsx)($.q5L,{size:16,className:"sm:w-[18px] sm:h-[18px]"})})})]})]}),(0,a.jsxs)("div",{className:"flex-grow flex h-full overflow-hidden",children:[(0,a.jsx)("main",{className:"flex-grow flex flex-col items-center justify-center p-2 sm:p-4 overflow-auto bg-base-300",children:(0,a.jsx)("div",{className:"bg-base-100 shadow-2xl transition-all duration-300 ease-in-out",style:{width:window.innerWidth<1024?"100%":({mobile:"375px",tablet:"768px",desktop:"100%"})[p],height:"100%",maxWidth:"100%"},children:"result"===r?(0,a.jsx)("iframe",{ref:y,srcDoc:w,title:"Sketch Result",sandbox:"allow-scripts allow-same-origin",className:"w-full h-full border-0"}):(0,a.jsx)(Y.ML,{theme:l?"vs-dark":"light",language:"html",value:m,onChange:e=>{h(null!=e?e:"")},loading:(0,a.jsx)(q.Z,{}),options:{minimap:{enabled:!1},fontSize:window.innerWidth<640?12:14}})})}),(0,a.jsx)("aside",{className:"w-80 flex-shrink-0 bg-base-200 border-l border-base-300 hidden lg:flex lg:flex-col",children:(0,a.jsx)(T,{})})]}),(0,a.jsx)(B.yo,{open:f,onOpenChange:g,children:(0,a.jsxs)(B.ue,{side:"right",className:"w-[85vw] sm:w-96 z-[99] gap-0",children:[(0,a.jsxs)(B.Tu,{children:[(0,a.jsx)(B.bC,{children:"Controls & History"}),(0,a.jsx)(B.Ei,{children:"Manage your sketch and view prompt history"})]}),(0,a.jsx)("div",{className:"flex flex-col h-[calc(100%-5rem)]",children:(0,a.jsx)(T,{})})]})})]})},ei=s(30080),eo=e=>{let{onNewSketch:t,onZoomChange:s,onFitToScreen:n,zoomLevel:r}=e;return(0,a.jsx)("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-10 bg-base-200/80 backdrop-blur-md border border-base-300 rounded-box shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center p-2 gap-2",children:[(0,a.jsxs)("button",{onClick:t,className:"btn btn-primary btn-sm gap-2 font-medium",children:[(0,a.jsx)(l.b9W,{className:"w-4 h-4"}),"New Sketch"]}),(0,a.jsx)("div",{className:"divider divider-horizontal mx-0"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>{s(Math.max(r-.1,.1))},className:"btn btn-ghost btn-sm btn-square","aria-label":"Zoom Out",disabled:r<=.1,children:(0,a.jsx)(l.PZm,{className:"w-5 h-5"})}),(0,a.jsxs)("button",{onClick:()=>{s(1)},className:"btn btn-ghost btn-sm min-w-[60px] font-mono","aria-label":"Reset Zoom",children:[Math.round(100*r),"%"]}),(0,a.jsx)("button",{onClick:()=>{s(Math.min(r+.1,3))},className:"btn btn-ghost btn-sm btn-square","aria-label":"Zoom In",disabled:r>=3,children:(0,a.jsx)(l.Z$5,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"divider divider-horizontal mx-0"}),(0,a.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":"Fit to Screen",children:(0,a.jsx)("button",{onClick:n,className:"btn btn-ghost btn-sm btn-square","aria-label":"Fit to Screen",children:(0,a.jsx)(ei.O8l,{className:"w-5 h-5"})})})]})})},ec=()=>{var e;let{sketches:t,selectedSketchId:s,setSelectedSketchId:r,addSketch:i,updateSketch:o,deleteSketch:c,duplicateSketch:d,getSketchById:m,canvasTransform:h,setCanvasTransform:u,setZoom:x,fitToScreen:p,generateHtml:b,editHtml:f}=M(),[g,v]=(0,n.useState)({isOpen:!1}),[j,y]=(0,n.useState)(!1),[N,w]=(0,n.useState)(null),k=(0,n.useRef)(null),E=(0,n.useRef)(!1),C=(0,n.useRef)({x:0,y:0}),T=async(e,t)=>{y(!0);try{let s=await b(e,t),a={id:"sketch_".concat(Date.now()),prompt:e,html:s,x:-h.x/h.scale+100,y:-h.y/h.scale+100,width:400,height:300,view:"result"};i(a),v({isOpen:!1})}catch(e){console.error("Failed to generate sketch:",e),V.default.error("Error generating sketch. Please check the console.")}finally{y(!1)}},S=async(e,t,s)=>{y(!0);let a=m(t);if(!a){y(!1);return}try{let n=await f(e,a.html,s);o(t,{html:n,prompt:e}),v({isOpen:!1})}catch(e){console.error("Failed to edit sketch:",e),V.default.error("Error editing sketch. Please check the console.")}finally{y(!1)}},R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;v({isOpen:!0,type:e,sketchId:t})},D=()=>{E.current=!1,k.current&&(k.current.style.cursor="grab")},L=()=>{var e,t;p((null===(e=k.current)||void 0===e?void 0:e.clientWidth)||window.innerWidth,(null===(t=k.current)||void 0===t?void 0:t.clientHeight)||window.innerHeight)},_=e=>{w(e)};return(0,n.useEffect)(()=>{let e=()=>D();return window.addEventListener("mouseup",e),()=>window.removeEventListener("mouseup",e)},[]),(0,n.useEffect)(()=>{k.current&&L()},[k.current]),(0,a.jsx)("div",{className:"mx-auto h-[calc(90dvh)] overflow-hidden flex flex-col bg-base-300 relative rounded",children:N?(0,a.jsx)(er,{sketchId:N,onClose:()=>{w(null)}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eo,{onNewSketch:()=>R("create"),onZoomChange:x,onFitToScreen:L,zoomLevel:h.scale}),(0,a.jsx)("div",{ref:k,className:"flex-grow w-full h-full relative overflow-hidden cursor-grab canvas-bg",onMouseDown:e=>{(e.target===k.current||e.target.classList.contains("canvas-bg"))&&(E.current=!0,C.current={x:e.clientX,y:e.clientY},k.current&&(k.current.style.cursor="grabbing"))},onMouseMove:e=>{if(!E.current)return;let t=e.clientX-C.current.x,s=e.clientY-C.current.y;u({...h,x:h.x+t,y:h.y+s}),C.current={x:e.clientX,y:e.clientY}},onWheel:e=>{let t=-(.001*e.deltaY),s=Math.min(Math.max(.1,h.scale+t),3),a=k.current.getBoundingClientRect(),n=e.clientX-a.left,l=e.clientY-a.top;u({x:n-(n-h.x)*(s/h.scale),y:l-(l-h.y)*(s/h.scale),scale:s})},style:{backgroundImage:"radial-gradient(circle at 1px 1px, oklch(var(--bc) / 0.2) 1px, transparent 0)",backgroundSize:"20px 20px"},children:(0,a.jsx)("div",{className:"absolute top-0 left-0",style:{transform:"translate(".concat(h.x,"px, ").concat(h.y,"px) scale(").concat(h.scale,")"),transformOrigin:"0 0"},children:t.map(e=>(0,a.jsx)(Z,{sketch:e,isSelected:s===e.id,onSelect:()=>r(e.id),onUpdate:o,onDelete:c,onDuplicate:d,onEdit:()=>R("edit",e.id),onFullscreen:()=>_(e.id),canvasScale:h.scale},e.id))})}),0===t.length&&!j&&(0,a.jsxs)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex flex-col items-center gap-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-base-content/60",children:"AI Sketch Board"}),(0,a.jsx)("p",{className:"text-base-content/40",children:"Create your first component to get started."}),(0,a.jsxs)("button",{onClick:()=>R("create"),className:"btn btn-primary gap-2",children:[(0,a.jsx)(l.b9W,{className:"w-5 h-5"})," New Sketch"]})]}),g.isOpen&&(0,a.jsx)(F,{onClose:()=>v({isOpen:!1}),onSubmit:(e,t)=>{"create"===g.type?T(e,t):"edit"===g.type&&g.sketchId&&S(e,g.sketchId,t)},isLoading:j,type:g.type||"create",initialPrompt:"edit"===g.type&&g.sketchId&&(null===(e=m(g.sketchId))||void 0===e?void 0:e.prompt)||""})]})})},ed=s(13154);function em(){return(0,a.jsx)("div",{className:"skeleton mx-auto h-[calc(90dvh)] rounded"})}function eh(e){let{children:t}=e,s=(0,z.Dv)(p);return"hasError"===s.state?(0,a.jsx)(ed.Z,{message:"Your browser does not support DB provided"}):"loading"===s.state?(0,a.jsx)(em,{}):(0,a.jsx)(A.M1,{db:s.data,children:t})}var eu=s(2962),ex=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eu.PB,{title:"De-sign",description:"de-sign is an AI design tool integrating multiple providers to generate and refine UI layouts in a real-time canvas."}),(0,a.jsx)(eh,{children:(0,a.jsx)(ec,{})})]})}},function(e){e.O(0,[4321,7909,6279,8738,5495,3448,4562,3764,9339,6367,5269,6293,3701,9113,2888,9774,179],function(){return e(e.s=2297)}),_N_E=e.O()}]);