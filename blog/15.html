<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta property="og:url" content="https://pasquale-favella.github.io/"/><meta property="og:image" content="https://pasquale-favella.github.io/og-image.png"/><meta property="og:locale" content="en_US"/><meta property="og:site_name" content="Pasquale Favella blogfolio"/><meta name="google-site-verification" content="BF08ecEW9P2w_w4mwWTU2LxdORMDiIO3XUeZLW7UC4o"/><link rel="icon" href="https://pasquale-favella.github.io/favicon.ico"/><title>Pasquale Favella | Setting Up Multiple Data Sources in a Spring Boot Application</title><meta name="robots" content="index,follow"/><meta name="description" content="Spring Boot is a popular Java framework that simplifies the process of building robust and scalable applications"/><meta property="og:title" content="Pasquale Favella | Setting Up Multiple Data Sources in a Spring Boot Application"/><meta property="og:description" content="Spring Boot is a popular Java framework that simplifies the process of building robust and scalable applications"/><meta property="og:type" content="article"/><meta property="article:tag" content="Java"/><meta property="article:tag" content="Spring Boot"/><meta name="next-head-count" content="16"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/dc3c3c2ae5a3a584.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/dc3c3c2ae5a3a584.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-07131f37003d1f4e.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-314c182fa7e2bf37.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-a767d6d8830842fe.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-059b9e7fc8b09221.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/5d416436-33d3c7295c991659.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/29107295-4cc022cea922dbb4.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/4245-3dfa6a5bbae30301.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-f4e990c90e0f396e.js" defer="" crossorigin=""></script><script src="/_next/static/Xsn4Taqlgj9Q8-UbxcNrE/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/Xsn4Taqlgj9Q8-UbxcNrE/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><header class="fixed top-0 left-0 right-0 z-40 shadow-sm backdrop-blur-[10px] bg-base-100/80 saturate-100"><div class="mx-auto flex h-[60px] max-w-6xl items-center justify-between px-8"><div><a aria-label="Pasquale&#x27;s website" href="/"><div class="flex items-center justify-between text-xl font-semibold">~ P: /blog<div class="Typewriter" data-testid="typewriter-wrapper"></div></div></a></div><div class="flex items-center gap-2"><div class="tooltip tooltip-bottom before:text-xs before:content-[attr(data-tip)]" data-tip="commands"><button class="btn btn-ghost btn-circle btn-sm"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"></path></svg></button></div><div class="tooltip tooltip-bottom before:text-xs before:content-[attr(data-tip)]" data-tip="change theme"><label class="swap swap-rotate btn btn-ghost btn-circle btn-sm"><input id="theme-toggle" type="checkbox"/><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="swap-on" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="swap-off" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6C10 10.4183 13.5817 14 18 14C19.4386 14 20.7885 13.6203 21.9549 12.9556C21.4738 18.0302 17.2005 22 12 22C6.47715 22 2 17.5228 2 12C2 6.79948 5.9698 2.52616 11.0444 2.04507C10.3797 3.21152 10 4.56142 10 6ZM4 12C4 16.4183 7.58172 20 12 20C14.9654 20 17.5757 18.3788 18.9571 15.9546C18.6407 15.9848 18.3214 16 18 16C12.4772 16 8 11.5228 8 6C8 5.67863 8.01524 5.35933 8.04536 5.04293C5.62119 6.42426 4 9.03458 4 12ZM18.1642 2.29104L19 2.5V3.5L18.1642 3.70896C17.4476 3.8881 16.8881 4.4476 16.709 5.16417L16.5 6H15.5L15.291 5.16417C15.1119 4.4476 14.5524 3.8881 13.8358 3.70896L13 3.5V2.5L13.8358 2.29104C14.5524 2.1119 15.1119 1.5524 15.291 0.835829L15.5 0H16.5L16.709 0.835829C16.8881 1.5524 17.4476 2.1119 18.1642 2.29104ZM23.1642 7.29104L24 7.5V8.5L23.1642 8.70896C22.4476 8.8881 21.8881 9.4476 21.709 10.1642L21.5 11H20.5L20.291 10.1642C20.1119 9.4476 19.5524 8.8881 18.8358 8.70896L18 8.5V7.5L18.8358 7.29104C19.5524 7.1119 20.1119 6.5524 20.291 5.83583L20.5 5H21.5L21.709 5.83583C21.8881 6.5524 22.4476 7.1119 23.1642 7.29104Z"></path></svg></label></div></div></div></header><main class="relative mx-auto min-h-layout max-w-6xl px-8 pt-20 mb-2"><a class="group fixed top-24 hidden items-center justify-center text-sm font-medium xl:inline-flex" href="/blog"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 transition duration-200 group-hover:translate-x-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"></path></svg><span>See all Posts</span></a><div class="prose md:prose-lg lg:prose-xl mx-auto  mb-3 lg:mb-5"><h1 class="text-4xl font-extrabold leading-tight md:text-5xl !mb-4">Setting Up Multiple Data Sources in a Spring Boot Application</h1><div class="flex gap-2"><a class="badge badge-lg border-base-content hover:border-accent-content hover:opacity-80 no-underline py-4" href="/blog?tag=Java"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9.243 3.03a1 1 0 01.727 1.213L9.53 6h2.94l.56-2.243a1 1 0 111.94.486L14.53 6H17a1 1 0 110 2h-2.97l-1 4H15a1 1 0 110 2h-2.47l-.56 2.242a1 1 0 11-1.94-.485L10.47 14H7.53l-.56 2.242a1 1 0 11-1.94-.485L5.47 14H3a1 1 0 110-2h2.97l1-4H5a1 1 0 110-2h2.47l.56-2.243a1 1 0 011.213-.727zM9.03 8l-1 4h2.938l1-4H9.031z" clip-rule="evenodd"></path></svg>Java</a><a class="badge badge-lg border-base-content hover:border-accent-content hover:opacity-80 no-underline py-4" href="/blog?tag=Spring+Boot"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9.243 3.03a1 1 0 01.727 1.213L9.53 6h2.94l.56-2.243a1 1 0 111.94.486L14.53 6H17a1 1 0 110 2h-2.97l-1 4H15a1 1 0 110 2h-2.47l-.56 2.242a1 1 0 11-1.94-.485L10.47 14H7.53l-.56 2.242a1 1 0 11-1.94-.485L5.47 14H3a1 1 0 110-2h2.97l1-4H5a1 1 0 110-2h2.47l.56-2.243a1 1 0 011.213-.727zM9.03 8l-1 4h2.938l1-4H9.031z" clip-rule="evenodd"></path></svg>Spring Boot</a></div></div><article class="prose md:prose-lg lg:prose-xl mx-auto"><p>Spring Boot is a popular Java framework that simplifies the process of building robust and scalable applications. One common requirement in enterprise applications is the need to work with multiple data sources. This could be due to various reasons, such as handling different databases, connecting to external services, or segregating data for performance and security purposes. In this article, we will explore how to set up and manage multiple data sources in a Spring Boot application.</p>
<h2>1. Why Use Multiple Data Sources?</h2>
<p>Before diving into the technical details, it's essential to understand why you might need multiple data sources in a Spring Boot application:</p>
<ul>
<li>
<p><strong>Data Isolation</strong>: Separate data sources can be used to isolate sensitive data from the main application database. For example, you may store user credentials in a separate database for added security.</p>
</li>
<li>
<p><strong>Performance Optimization</strong>: By segregating data, you can optimize the performance of your application. For instance, storing frequently accessed data in a dedicated database can improve response times.</p>
</li>
<li>
<p><strong>Integration with External Services</strong>: You might need to connect to external services or databases that are not part of your main application database.</p>
</li>
<li>
<p><strong>Legacy Systems</strong>: In enterprise environments, you may need to interact with legacy systems that use different data sources.</p>
</li>
</ul>
<h2>2. Configuration and Dependency Setup</h2>
<p>To set up multiple data sources in a Spring Boot application, you need to follow these steps:</p>
<h3>2.1. Adding Dependencies</h3>
<p>In your <code>pom.xml</code> file, include the necessary dependencies:</p>

<div style="position: relative">
	<pre><code class="hljs language-xml"><span class="hljs-comment">&lt;!-- Spring Boot Starter --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- Spring Data JPA for the primary data source --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- HikariCP for connection pooling --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.zaxxer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>HikariCP<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- JDBC driver for your primary database --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mysql.cj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- Additional dependencies for secondary data sources --&gt;</span>
<span class="hljs-comment">&lt;!-- Add dependencies for secondary databases here --&gt;</span>
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="<!-- Spring Boot Starter -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter</artifactId>
</dependency>

<!-- Spring Data JPA for the primary data source -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>

<!-- HikariCP for connection pooling -->
<dependency>
    <groupId>com.zaxxer</groupId>
    <artifactId>HikariCP</artifactId>
</dependency>

<!-- JDBC driver for your primary database -->
<dependency>
    <groupId>com.mysql.cj</groupId>
    <artifactId>mysql-connector-java</artifactId>
</dependency>

<!-- Additional dependencies for secondary data sources -->
<!-- Add dependencies for secondary databases here -->
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<p>Ensure you include the JDBC driver for your primary database and any additional dependencies required for your secondary data sources.</p>
<h3>2.2. Creating Configuration Properties</h3>
<p>Create configuration properties for your data sources in <code>application.properties</code> or <code>application.yml</code>. Define properties for the primary and secondary data sources, such as URL, username, password, and driver class. For example:</p>

<div style="position: relative">
	<pre><code class="hljs language-properties"><span class="hljs-comment"># Primary DataSource</span>
<span class="hljs-attr">spring.datasource.primary.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/primary_db</span>
<span class="hljs-attr">spring.datasource.primary.username</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">spring.datasource.primary.password</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">spring.datasource.primary.driver-class-name</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
<span class="hljs-comment">
# Secondary DataSource</span>
<span class="hljs-attr">spring.datasource.secondary.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/secondary_db</span>
<span class="hljs-attr">spring.datasource.secondary.username</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">spring.datasource.secondary.password</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">spring.datasource.secondary.driver-class-name</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="# Primary DataSource
spring.datasource.primary.url=jdbc:mysql://localhost:3306/primary_db
spring.datasource.primary.username=root
spring.datasource.primary.password=root
spring.datasource.primary.driver-class-name=com.mysql.cj.jdbc.Driver

# Secondary DataSource
spring.datasource.secondary.url=jdbc:mysql://localhost:3306/secondary_db
spring.datasource.secondary.username=root
spring.datasource.secondary.password=root
spring.datasource.secondary.driver-class-name=com.mysql.cj.jdbc.Driver
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<h2>3. Configuring Multiple Data Sources</h2>
<p>In this section, we will configure multiple data sources and create beans for them.</p>
<h3>3.1. Defining Data Source Beans</h3>
<p>In your Spring Boot application, define multiple <code>DataSource</code> beans in a configuration class. For example:</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableTransactionManagement</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceConfig</span> {

    <span class="hljs-meta">@Primary</span>
    <span class="hljs-meta">@Bean(name = &quot;primaryDataSource&quot;)</span>
    <span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.datasource.primary&quot;)</span>
    <span class="hljs-keyword">public</span> DataSource <span class="hljs-title function_">primaryDataSource</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> DataSourceBuilder.create().build();
    }

    <span class="hljs-meta">@Bean(name = &quot;secondaryDataSource&quot;)</span>
    <span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.datasource.secondary&quot;)</span>
    <span class="hljs-keyword">public</span> DataSource <span class="hljs-title function_">secondaryDataSource</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> DataSourceBuilder.create().build();
    }
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@Configuration
@EnableTransactionManagement
public class DataSourceConfig {

    @Primary
    @Bean(name = &quot;primaryDataSource&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource.primary&quot;)
    public DataSource primaryDataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean(name = &quot;secondaryDataSource&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource.secondary&quot;)
    public DataSource secondaryDataSource() {
        return DataSourceBuilder.create().build();
    }
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<p>In the code above, we use <code>@ConfigurationProperties</code> to bind the properties from <code>application.properties</code> to the respective <code>DataSource</code> beans.</p>
<h3>3.2. Creating JdbcTemplate Beans</h3>
<p>To interact with the databases, create <code>JdbcTemplate</code> beans for each data source. These <code>JdbcTemplate</code> beans are responsible for executing SQL queries.</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcTemplateConfig</span> {

    <span class="hljs-meta">@Primary</span>
    <span class="hljs-meta">@Bean(name = &quot;primaryJdbcTemplate&quot;)</span>
    <span class="hljs-keyword">public</span> JdbcTemplate <span class="hljs-title function_">primaryJdbcTemplate</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;primaryDataSource&quot;)</span> DataSource dataSource)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcTemplate</span>(dataSource);
    }

    <span class="hljs-meta">@Bean(name = &quot;secondaryJdbcTemplate&quot;)</span>
    <span class="hljs-keyword">public</span> JdbcTemplate <span class="hljs-title function_">secondaryJdbcTemplate</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;secondaryDataSource&quot;)</span> DataSource dataSource)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcTemplate</span>(dataSource);
    }
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@Configuration
public class JdbcTemplateConfig {

    @Primary
    @Bean(name = &quot;primaryJdbcTemplate&quot;)
    public JdbcTemplate primaryJdbcTemplate(@Qualifier(&quot;primaryDataSource&quot;) DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }

    @Bean(name = &quot;secondaryJdbcTemplate&quot;)
    public JdbcTemplate secondaryJdbcTemplate(@Qualifier(&quot;secondaryDataSource&quot;) DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<h2>4. Implementing Repository and Service Layers</h2>
<p>Now that you have configured multiple data sources, you can create repository and service layers to interact with each data source independently.</p>
<h3>4.1. Creating Entity Classes</h3>
<p>Define entity classes for each data source. These classes represent the database tables and their relationships. Annotate them with <code>@Entity</code> and define the appropriate mappings.</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = &quot;primary_table&quot;)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrimaryEntity</span> {
    <span class="hljs-comment">// Define entity properties and relationships</span>
}

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = &quot;secondary_table&quot;)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecondaryEntity</span> {
    <span class="hljs-comment">// Define entity properties and relationships</span>
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@Entity
@Table(name = &quot;primary_table&quot;)
public class PrimaryEntity {
    // Define entity properties and relationships
}

@Entity
@Table(name = &quot;secondary_table&quot;)
public class SecondaryEntity {
    // Define entity properties and relationships
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<h3>4.2. Building Repository Interfaces</h3>
<p>Create repository interfaces for each entity using Spring Data JPA. These interfaces will provide CRUD (Create, Read, Update, Delete) operations.</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PrimaryRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;PrimaryEntity, Long&gt; {
    <span class="hljs-comment">// Define custom query methods if needed</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SecondaryRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;SecondaryEntity, Long&gt; {
    <span class="hljs-comment">// Define custom query methods if needed</span>
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="public interface PrimaryRepository extends JpaRepository<PrimaryEntity, Long> {
    // Define custom query methods if needed
}

public interface SecondaryRepository extends JpaRepository<SecondaryEntity, Long> {
    // Define custom query methods if needed
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<h3>4.3. Developing Service Classes</h3>
<p>Build service classes that encapsulate business logic and interact with the repositories. These services will use the respective <code>JdbcTemplate</code>  beans to execute queries on the correct data source.</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrimaryService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JdbcTemplate primaryJdbcTemplate;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PrimaryService</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;primaryJdbcTemplate&quot;)</span> JdbcTemplate primaryJdbcTemplate)</span> {
        <span class="hljs-built_in">this</span>.primaryJdbcTemplate = primaryJdbcTemplate;
    }

    <span class="hljs-comment">// Implement service methods using primaryJdbcTemplate</span>
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecondaryService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JdbcTemplate secondaryJdbcTemplate;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SecondaryService</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;secondaryJdbcTemplate&quot;)</span> JdbcTemplate secondaryJdbcTemplate)</span> {
        <span class="hljs-built_in">this</span>.secondaryJdbcTemplate = secondaryJdbcTemplate;
    }

    <span class="hljs-comment">// Implement service methods using secondaryJdbcTemplate</span>
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@Service
public class PrimaryService {

    private final JdbcTemplate primaryJdbcTemplate;

    @Autowired
    public PrimaryService(@Qualifier(&quot;primaryJdbcTemplate&quot;) JdbcTemplate primaryJdbcTemplate) {
        this.primaryJdbcTemplate = primaryJdbcTemplate;
    }

    // Implement service methods using primaryJdbcTemplate
}

@Service
public class SecondaryService {

    private final JdbcTemplate secondaryJdbcTemplate;

    @Autowired
    public SecondaryService(@Qualifier(&quot;secondaryJdbcTemplate&quot;) JdbcTemplate secondaryJdbcTemplate) {
        this.secondaryJdbcTemplate = secondaryJdbcTemplate;
    }

    // Implement service methods using secondaryJdbcTemplate
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<h2>5. Transaction Management</h2>
<p>When working with multiple data sources, it's crucial to manage transactions correctly. Spring Boot provides transaction management capabilities that you can leverage.</p>
<h3>5.1. Configuring Transaction Managers</h3>
<p>Configure transaction managers for each data source in your configuration class:</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableTransactionManagement</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransactionManagerConfig</span> {

    <span class="hljs-meta">@Primary</span>
    <span class="hljs-meta">@Bean(name = &quot;primaryTransactionManager&quot;)</span>
    <span class="hljs-keyword">public</span> PlatformTransactionManager <span class="hljs-title function_">primaryTransactionManager</span><span class="hljs-params">(
            <span class="hljs-meta">@Qualifier(&quot;primaryDataSource&quot;)</span> DataSource primaryDataSource)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataSourceTransactionManager</span>(primaryDataSource);
    }

    <span class="hljs-meta">@Bean(name = &quot;secondaryTransactionManager&quot;)</span>
    <span class="hljs-keyword">public</span> PlatformTransactionManager <span class="hljs-title function_">secondaryTransactionManager</span><span class="hljs-params">(
            <span class="hljs-meta">@Qualifier(&quot;secondaryDataSource&quot;)</span> DataSource secondaryDataSource)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataSourceTransactionManager</span>(secondaryDataSource);
    }
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@Configuration
@EnableTransactionManagement
public class TransactionManagerConfig {

    @Primary
    @Bean(name = &quot;primaryTransactionManager&quot;)
    public PlatformTransactionManager primaryTransactionManager(
            @Qualifier(&quot;primaryDataSource&quot;) DataSource primaryDataSource) {
        return new DataSourceTransactionManager(primaryDataSource);
    }

    @Bean(name = &quot;secondaryTransactionManager&quot;)
    public PlatformTransactionManager secondaryTransactionManager(
            @Qualifier(&quot;secondaryDataSource&quot;) DataSource secondaryDataSource) {
        return new DataSourceTransactionManager(secondaryDataSource);
    }
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<p>In the code above, we define <code>PlatformTransactionManager</code> beans for both data sources.</p>
<h3>5.2. Transactional Annotations</h3>
<p>Use the <code>@Transactional</code> annotation to specify transaction boundaries in your service methods. You can indicate which transaction manager to use for each method.</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrimaryService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JdbcTemplate primaryJdbcTemplate;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PrimaryService</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;primaryJdbcTemplate&quot;)</span> JdbcTemplate primaryJdbcTemplate)</span> {
        <span class="hljs-built_in">this</span>.primaryJdbcTemplate = primaryJdbcTemplate;
    }

    <span class="hljs-meta">@Transactional(transactionManager = &quot;primaryTransactionManager&quot;)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performPrimaryDataOperation</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Perform database operations using primaryJdbcTemplate</span>
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecondaryService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JdbcTemplate secondaryJdbcTemplate;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SecondaryService</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;secondaryJdbcTemplate&quot;)</span> JdbcTemplate secondaryJdbcTemplate)</span> {
        <span class="hljs-built_in">this</span>.secondaryJdbcTemplate = secondaryJdbcTemplate;
    }

    <span class="hljs-meta">@Transactional(transactionManager = &quot;secondaryTransactionManager&quot;)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performSecondaryDataOperation</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Perform database operations using secondaryJdbcTemplate</span>
    }
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@Service
public class PrimaryService {

    private final JdbcTemplate primaryJdbcTemplate;

    @Autowired
    public PrimaryService(@Qualifier(&quot;primaryJdbcTemplate&quot;) JdbcTemplate primaryJdbcTemplate) {
        this.primaryJdbcTemplate = primaryJdbcTemplate;
    }

    @Transactional(transactionManager = &quot;primaryTransactionManager&quot;)
    public void performPrimaryDataOperation() {
        // Perform database operations using primaryJdbcTemplate
    }
}

@Service
public class SecondaryService {

    private final JdbcTemplate secondaryJdbcTemplate;

    @Autowired
    public SecondaryService(@Qualifier(&quot;secondaryJdbcTemplate&quot;) JdbcTemplate secondaryJdbcTemplate) {
        this.secondaryJdbcTemplate = secondaryJdbcTemplate;
    }

    @Transactional(transactionManager = &quot;secondaryTransactionManager&quot;)
    public void performSecondaryDataOperation() {
        // Perform database operations using secondaryJdbcTemplate
    }
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<p>By specifying the <code>transactionManager</code> attribute in the <code>@Transactional</code> annotation, you ensure that each method operates within the correct transaction context.</p>
<h2>6. Testing Multiple Data Sources</h2>
<p>To ensure the reliability and correctness of your multiple data source setup, you need to create comprehensive tests.</p>
<h3>6.1. Unit Testing</h3>
<p>For unit testing, you can use tools like JUnit and Mockito to mock the data source interactions. Create test cases for your service methods and validate their behavior.</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@RunWith(MockitoJUnitRunner.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrimaryServiceTest</span> {

    <span class="hljs-meta">@InjectMocks</span>
    <span class="hljs-keyword">private</span> PrimaryService primaryService;

    <span class="hljs-meta">@Mock</span>
    <span class="hljs-keyword">private</span> JdbcTemplate primaryJdbcTemplate;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testPerformPrimaryDataOperation</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Mock database interaction and test the service method</span>
    }
}

<span class="hljs-meta">@RunWith(MockitoJUnitRunner.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecondaryServiceTest</span> {

    <span class="hljs-meta">@InjectMocks</span>
    <span class="hljs-keyword">private</span> SecondaryService secondaryService;

    <span class="hljs-meta">@Mock</span>
    <span class="hljs-keyword">private</span> JdbcTemplate secondaryJdbcTemplate;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testPerformSecondaryDataOperation</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Mock database interaction and test the service method</span>
    }
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@RunWith(MockitoJUnitRunner.class)
public class PrimaryServiceTest {

    @InjectMocks
    private PrimaryService primaryService;

    @Mock
    private JdbcTemplate primaryJdbcTemplate;

    @Test
    public void testPerformPrimaryDataOperation() {
        // Mock database interaction and test the service method
    }
}

@RunWith(MockitoJUnitRunner.class)
public class SecondaryServiceTest {

    @InjectMocks
    private SecondaryService secondaryService;

    @Mock
    private JdbcTemplate secondaryJdbcTemplate;

    @Test
    public void testPerformSecondaryDataOperation() {
        // Mock database interaction and test the service method
    }
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<h3>6.2. Integration Testing</h3>
<p>For integration testing, you can use Spring's <code>@SpringBootTest</code> annotation to create test configurations that mimic your production environment. You can also use an embedded database like H2 for testing.</p>

<div style="position: relative">
	<pre><code class="hljs language-java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MultipleDataSourceIntegrationTest</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> PrimaryService primaryService;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> SecondaryService secondaryService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testMultipleDataSources</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Write integration tests to validate interactions between services</span>
    }
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="@SpringBootTest
public class MultipleDataSourceIntegrationTest {

    @Autowired
    private PrimaryService primaryService;

    @Autowired
    private SecondaryService secondaryService;

    @Test
    public void testMultipleDataSources() {
        // Write integration tests to validate interactions between services
    }
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<h2>7. Conclusion</h2>
<p>Setting up and managing multiple data sources in a Spring Boot application can be a challenging but necessary task for many enterprise applications. By following the steps outlined in this article, you can achieve data isolation, optimize performance, and integrate seamlessly with various data sources.</p>
<p>Remember to configure the necessary dependencies, create and configure data source beans and JdbcTemplate beans, implement repository and service layers, and manage transactions correctly. Comprehensive unit and integration testing are crucial to ensure the reliability and correctness of your multiple data source setup.</p>
<p>With the right design and careful implementation, Spring Boot makes it possible to work with multiple data sources efficiently, enabling you to build robust and scalable applications that meet the complex data requirements of modern enterprise systems.</p>
</article><div class="my-8"></div></main><footer class="text-gray-600"><div class="max-w-6xl px-5 py-4 mx-auto flex items-center sm:flex-row flex-col"><a class="text-primary hover:underline underline-offset-2" aria-label="Email to paskfdev@gmail.com" title="Email to paskfdev@gmail.com" href="mailto:paskfdev@gmail.com">Pasquale Favella</a><p class="text-sm text-gray-500 sm:ml-4 sm:pl-4 sm:border-l-2 sm:border-gray-200 sm:py-2 sm:mt-0 mt-4">Â©<!-- -->2025<!-- --> â€¢ made with ðŸ’š</p><span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center items-center sm:justify-start gap-4"><a class="transition-all duration-300 hover:text-primary" href="https://github.com/Pasquale-Favella"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a class="transition-all duration-300 hover:text-primary" href="https://it.linkedin.com/in/pasquale-favella-1a3682187"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a></span></div><div class="fixed bottom-4 right-1 sm:bottom-10 sm:right-6 z-50 tooltip tooltip-left before:text-xs before:content-[attr(data-tip)]" data-tip="ask a question" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rbl6:" data-state="closed"><button class="btn btn-ghost btn-circle "><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="40" width="40" xmlns="http://www.w3.org/2000/svg"><path d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM7.194 6.766a1.688 1.688 0 0 0-.227-.272 1.467 1.467 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 5.734 6C4.776 6 4 6.746 4 7.667c0 .92.776 1.666 1.734 1.666.343 0 .662-.095.931-.26-.137.389-.39.804-.81 1.22a.405.405 0 0 0 .011.59c.173.16.447.155.614-.01 1.334-1.329 1.37-2.758.941-3.706a2.461 2.461 0 0 0-.227-.4zM11 9.073c-.136.389-.39.804-.81 1.22a.405.405 0 0 0 .012.59c.172.16.446.155.613-.01 1.334-1.329 1.37-2.758.942-3.706a2.466 2.466 0 0 0-.228-.4 1.686 1.686 0 0 0-.227-.273 1.466 1.466 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 10.07 6c-.957 0-1.734.746-1.734 1.667 0 .92.777 1.666 1.734 1.666.343 0 .662-.095.931-.26z"></path></svg></button></div></footer></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"content":"Spring Boot is a popular Java framework that simplifies the process of building robust and scalable applications. One common requirement in enterprise applications is the need to work with multiple data sources. This could be due to various reasons, such as handling different databases, connecting to external services, or segregating data for performance and security purposes. In this article, we will explore how to set up and manage multiple data sources in a Spring Boot application.\r\n\r\n## 1. Why Use Multiple Data Sources?\r\n\r\nBefore diving into the technical details, it's essential to understand why you might need multiple data sources in a Spring Boot application:\r\n\r\n- **Data Isolation**: Separate data sources can be used to isolate sensitive data from the main application database. For example, you may store user credentials in a separate database for added security.\r\n\r\n- **Performance Optimization**: By segregating data, you can optimize the performance of your application. For instance, storing frequently accessed data in a dedicated database can improve response times.\r\n\r\n- **Integration with External Services**: You might need to connect to external services or databases that are not part of your main application database.\r\n\r\n- **Legacy Systems**: In enterprise environments, you may need to interact with legacy systems that use different data sources.\r\n\r\n## 2. Configuration and Dependency Setup\r\n\r\nTo set up multiple data sources in a Spring Boot application, you need to follow these steps:\r\n\r\n### 2.1. Adding Dependencies\r\n\r\nIn your `pom.xml` file, include the necessary dependencies:\r\n\r\n```xml\r\n\u003c!-- Spring Boot Starter --\u003e\r\n\u003cdependency\u003e\r\n    \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e\r\n    \u003cartifactId\u003espring-boot-starter\u003c/artifactId\u003e\r\n\u003c/dependency\u003e\r\n\r\n\u003c!-- Spring Data JPA for the primary data source --\u003e\r\n\u003cdependency\u003e\r\n    \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e\r\n    \u003cartifactId\u003espring-boot-starter-data-jpa\u003c/artifactId\u003e\r\n\u003c/dependency\u003e\r\n\r\n\u003c!-- HikariCP for connection pooling --\u003e\r\n\u003cdependency\u003e\r\n    \u003cgroupId\u003ecom.zaxxer\u003c/groupId\u003e\r\n    \u003cartifactId\u003eHikariCP\u003c/artifactId\u003e\r\n\u003c/dependency\u003e\r\n\r\n\u003c!-- JDBC driver for your primary database --\u003e\r\n\u003cdependency\u003e\r\n    \u003cgroupId\u003ecom.mysql.cj\u003c/groupId\u003e\r\n    \u003cartifactId\u003emysql-connector-java\u003c/artifactId\u003e\r\n\u003c/dependency\u003e\r\n\r\n\u003c!-- Additional dependencies for secondary data sources --\u003e\r\n\u003c!-- Add dependencies for secondary databases here --\u003e\r\n```\r\nEnsure you include the JDBC driver for your primary database and any additional dependencies required for your secondary data sources.\r\n\r\n### 2.2. Creating Configuration Properties\r\n\r\nCreate configuration properties for your data sources in `application.properties` or `application.yml`. Define properties for the primary and secondary data sources, such as URL, username, password, and driver class. For example:\r\n\r\n```properties\r\n# Primary DataSource\r\nspring.datasource.primary.url=jdbc:mysql://localhost:3306/primary_db\r\nspring.datasource.primary.username=root\r\nspring.datasource.primary.password=root\r\nspring.datasource.primary.driver-class-name=com.mysql.cj.jdbc.Driver\r\n\r\n# Secondary DataSource\r\nspring.datasource.secondary.url=jdbc:mysql://localhost:3306/secondary_db\r\nspring.datasource.secondary.username=root\r\nspring.datasource.secondary.password=root\r\nspring.datasource.secondary.driver-class-name=com.mysql.cj.jdbc.Driver\r\n```\r\n\r\n## 3. Configuring Multiple Data Sources\r\n\r\nIn this section, we will configure multiple data sources and create beans for them.\r\n\r\n### 3.1. Defining Data Source Beans\r\n\r\nIn your Spring Boot application, define multiple `DataSource` beans in a configuration class. For example:\r\n\r\n```java\r\n@Configuration\r\n@EnableTransactionManagement\r\npublic class DataSourceConfig {\r\n\r\n    @Primary\r\n    @Bean(name = \"primaryDataSource\")\r\n    @ConfigurationProperties(prefix = \"spring.datasource.primary\")\r\n    public DataSource primaryDataSource() {\r\n        return DataSourceBuilder.create().build();\r\n    }\r\n\r\n    @Bean(name = \"secondaryDataSource\")\r\n    @ConfigurationProperties(prefix = \"spring.datasource.secondary\")\r\n    public DataSource secondaryDataSource() {\r\n        return DataSourceBuilder.create().build();\r\n    }\r\n}\r\n```\r\n\r\nIn the code above, we use `@ConfigurationProperties` to bind the properties from `application.properties` to the respective `DataSource` beans.\r\n\r\n### 3.2. Creating JdbcTemplate Beans\r\n\r\nTo interact with the databases, create `JdbcTemplate` beans for each data source. These `JdbcTemplate` beans are responsible for executing SQL queries.\r\n\r\n```java\r\n@Configuration\r\npublic class JdbcTemplateConfig {\r\n\r\n    @Primary\r\n    @Bean(name = \"primaryJdbcTemplate\")\r\n    public JdbcTemplate primaryJdbcTemplate(@Qualifier(\"primaryDataSource\") DataSource dataSource) {\r\n        return new JdbcTemplate(dataSource);\r\n    }\r\n\r\n    @Bean(name = \"secondaryJdbcTemplate\")\r\n    public JdbcTemplate secondaryJdbcTemplate(@Qualifier(\"secondaryDataSource\") DataSource dataSource) {\r\n        return new JdbcTemplate(dataSource);\r\n    }\r\n}\r\n```\r\n\r\n## 4. Implementing Repository and Service Layers\r\n\r\nNow that you have configured multiple data sources, you can create repository and service layers to interact with each data source independently.\r\n\r\n### 4.1. Creating Entity Classes\r\n\r\nDefine entity classes for each data source. These classes represent the database tables and their relationships. Annotate them with `@Entity` and define the appropriate mappings.\r\n\r\n```java\r\n@Entity\r\n@Table(name = \"primary_table\")\r\npublic class PrimaryEntity {\r\n    // Define entity properties and relationships\r\n}\r\n\r\n@Entity\r\n@Table(name = \"secondary_table\")\r\npublic class SecondaryEntity {\r\n    // Define entity properties and relationships\r\n}\r\n```\r\n\r\n### 4.2. Building Repository Interfaces\r\n\r\nCreate repository interfaces for each entity using Spring Data JPA. These interfaces will provide CRUD (Create, Read, Update, Delete) operations.\r\n\r\n```java\r\npublic interface PrimaryRepository extends JpaRepository\u003cPrimaryEntity, Long\u003e {\r\n    // Define custom query methods if needed\r\n}\r\n\r\npublic interface SecondaryRepository extends JpaRepository\u003cSecondaryEntity, Long\u003e {\r\n    // Define custom query methods if needed\r\n}\r\n```\r\n\r\n### 4.3. Developing Service Classes\r\n\r\nBuild service classes that encapsulate business logic and interact with the repositories. These services will use the respective `JdbcTemplate`  beans to execute queries on the correct data source.\r\n\r\n```java\r\n@Service\r\npublic class PrimaryService {\r\n\r\n    private final JdbcTemplate primaryJdbcTemplate;\r\n\r\n    @Autowired\r\n    public PrimaryService(@Qualifier(\"primaryJdbcTemplate\") JdbcTemplate primaryJdbcTemplate) {\r\n        this.primaryJdbcTemplate = primaryJdbcTemplate;\r\n    }\r\n\r\n    // Implement service methods using primaryJdbcTemplate\r\n}\r\n\r\n@Service\r\npublic class SecondaryService {\r\n\r\n    private final JdbcTemplate secondaryJdbcTemplate;\r\n\r\n    @Autowired\r\n    public SecondaryService(@Qualifier(\"secondaryJdbcTemplate\") JdbcTemplate secondaryJdbcTemplate) {\r\n        this.secondaryJdbcTemplate = secondaryJdbcTemplate;\r\n    }\r\n\r\n    // Implement service methods using secondaryJdbcTemplate\r\n}\r\n```\r\n\r\n## 5. Transaction Management\r\n\r\nWhen working with multiple data sources, it's crucial to manage transactions correctly. Spring Boot provides transaction management capabilities that you can leverage.\r\n\r\n### 5.1. Configuring Transaction Managers\r\n\r\nConfigure transaction managers for each data source in your configuration class:\r\n\r\n```java\r\n@Configuration\r\n@EnableTransactionManagement\r\npublic class TransactionManagerConfig {\r\n\r\n    @Primary\r\n    @Bean(name = \"primaryTransactionManager\")\r\n    public PlatformTransactionManager primaryTransactionManager(\r\n            @Qualifier(\"primaryDataSource\") DataSource primaryDataSource) {\r\n        return new DataSourceTransactionManager(primaryDataSource);\r\n    }\r\n\r\n    @Bean(name = \"secondaryTransactionManager\")\r\n    public PlatformTransactionManager secondaryTransactionManager(\r\n            @Qualifier(\"secondaryDataSource\") DataSource secondaryDataSource) {\r\n        return new DataSourceTransactionManager(secondaryDataSource);\r\n    }\r\n}\r\n```\r\n\r\nIn the code above, we define `PlatformTransactionManager` beans for both data sources.\r\n\r\n### 5.2. Transactional Annotations\r\n\r\nUse the `@Transactional` annotation to specify transaction boundaries in your service methods. You can indicate which transaction manager to use for each method.\r\n\r\n```java\r\n@Service\r\npublic class PrimaryService {\r\n\r\n    private final JdbcTemplate primaryJdbcTemplate;\r\n\r\n    @Autowired\r\n    public PrimaryService(@Qualifier(\"primaryJdbcTemplate\") JdbcTemplate primaryJdbcTemplate) {\r\n        this.primaryJdbcTemplate = primaryJdbcTemplate;\r\n    }\r\n\r\n    @Transactional(transactionManager = \"primaryTransactionManager\")\r\n    public void performPrimaryDataOperation() {\r\n        // Perform database operations using primaryJdbcTemplate\r\n    }\r\n}\r\n\r\n@Service\r\npublic class SecondaryService {\r\n\r\n    private final JdbcTemplate secondaryJdbcTemplate;\r\n\r\n    @Autowired\r\n    public SecondaryService(@Qualifier(\"secondaryJdbcTemplate\") JdbcTemplate secondaryJdbcTemplate) {\r\n        this.secondaryJdbcTemplate = secondaryJdbcTemplate;\r\n    }\r\n\r\n    @Transactional(transactionManager = \"secondaryTransactionManager\")\r\n    public void performSecondaryDataOperation() {\r\n        // Perform database operations using secondaryJdbcTemplate\r\n    }\r\n}\r\n```\r\n\r\nBy specifying the `transactionManager` attribute in the `@Transactional` annotation, you ensure that each method operates within the correct transaction context.\r\n\r\n## 6. Testing Multiple Data Sources\r\n\r\nTo ensure the reliability and correctness of your multiple data source setup, you need to create comprehensive tests.\r\n\r\n### 6.1. Unit Testing\r\n\r\nFor unit testing, you can use tools like JUnit and Mockito to mock the data source interactions. Create test cases for your service methods and validate their behavior.\r\n\r\n```java\r\n@RunWith(MockitoJUnitRunner.class)\r\npublic class PrimaryServiceTest {\r\n\r\n    @InjectMocks\r\n    private PrimaryService primaryService;\r\n\r\n    @Mock\r\n    private JdbcTemplate primaryJdbcTemplate;\r\n\r\n    @Test\r\n    public void testPerformPrimaryDataOperation() {\r\n        // Mock database interaction and test the service method\r\n    }\r\n}\r\n\r\n@RunWith(MockitoJUnitRunner.class)\r\npublic class SecondaryServiceTest {\r\n\r\n    @InjectMocks\r\n    private SecondaryService secondaryService;\r\n\r\n    @Mock\r\n    private JdbcTemplate secondaryJdbcTemplate;\r\n\r\n    @Test\r\n    public void testPerformSecondaryDataOperation() {\r\n        // Mock database interaction and test the service method\r\n    }\r\n}\r\n```\r\n\r\n### 6.2. Integration Testing\r\n\r\nFor integration testing, you can use Spring's `@SpringBootTest` annotation to create test configurations that mimic your production environment. You can also use an embedded database like H2 for testing.\r\n\r\n```java\r\n@SpringBootTest\r\npublic class MultipleDataSourceIntegrationTest {\r\n\r\n    @Autowired\r\n    private PrimaryService primaryService;\r\n\r\n    @Autowired\r\n    private SecondaryService secondaryService;\r\n\r\n    @Test\r\n    public void testMultipleDataSources() {\r\n        // Write integration tests to validate interactions between services\r\n    }\r\n}\r\n```\r\n\r\n## 7. Conclusion\r\nSetting up and managing multiple data sources in a Spring Boot application can be a challenging but necessary task for many enterprise applications. By following the steps outlined in this article, you can achieve data isolation, optimize performance, and integrate seamlessly with various data sources.\r\n\r\nRemember to configure the necessary dependencies, create and configure data source beans and JdbcTemplate beans, implement repository and service layers, and manage transactions correctly. Comprehensive unit and integration testing are crucial to ensure the reliability and correctness of your multiple data source setup.\r\n\r\nWith the right design and careful implementation, Spring Boot makes it possible to work with multiple data sources efficiently, enabling you to build robust and scalable applications that meet the complex data requirements of modern enterprise systems.","slug":"15","title":"Setting Up Multiple Data Sources in a Spring Boot Application","meta_description":"Spring Boot is a popular Java framework that simplifies the process of building robust and scalable applications","tags":["Java","Spring Boot"]},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"15"},"buildId":"Xsn4Taqlgj9Q8-UbxcNrE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>