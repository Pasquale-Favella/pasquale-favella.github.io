<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta property="og:url" content="https://pasquale-favella.github.io/"/><meta property="og:type" content="website"/><meta property="og:image" content="https://pasquale-favella.github.io/og-image.png"/><meta property="og:locale" content="en_US"/><meta property="og:site_name" content="Pasquale Favella blogfolio"/><link rel="icon" href="/favicon.ico"/><title>Pasquale Favella | Angular View-Model (VM) Pattern with combineLatest</title><meta name="robots" content="index,follow"/><meta name="description" content="Pasquale Favella Blog - Angular View-Model (VM) Pattern with combineLatest"/><meta property="og:title" content="Pasquale Favella | Angular View-Model (VM) Pattern with combineLatest"/><meta property="og:description" content="Pasquale Favella Blog - Angular View-Model (VM) Pattern with combineLatest"/><meta name="next-head-count" content="13"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/ce54e2df92485342.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ce54e2df92485342.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-bef7b7d8881548da.js" defer=""></script><script src="/_next/static/chunks/framework-73b8966a3c579ab0.js" defer=""></script><script src="/_next/static/chunks/main-8b0a8fea1e6bc305.js" defer=""></script><script src="/_next/static/chunks/pages/_app-209b8bf11c621b33.js" defer=""></script><script src="/_next/static/chunks/252f366e-91067360a9e05d4e.js" defer=""></script><script src="/_next/static/chunks/d64684d8-1675c1d2c69a656b.js" defer=""></script><script src="/_next/static/chunks/29107295-8ab47bb7d9547e26.js" defer=""></script><script src="/_next/static/chunks/654-0882e080c3b30056.js" defer=""></script><script src="/_next/static/chunks/861-aad12832f5cb69b1.js" defer=""></script><script src="/_next/static/chunks/263-4a8117eb1be7deec.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-8d9f23b309192d2e.js" defer=""></script><script src="/_next/static/i2OmoDciPUC_u-z-eiBoC/_buildManifest.js" defer=""></script><script src="/_next/static/i2OmoDciPUC_u-z-eiBoC/_ssgManifest.js" defer=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><header class="fixed top-0 left-0 right-0 z-40 shadow-sm backdrop-blur-[10px] bg-base-100/80 saturate-100"><div class="mx-auto flex h-[60px] max-w-6xl items-center justify-between px-8"><div><a aria-label="Pasquale&#x27;s website" href="/"><div class="flex items-center justify-between text-xl font-semibold">~ P: /blog<div class="Typewriter" data-testid="typewriter-wrapper"></div></div></a></div><div class="flex items-center gap-2"><div class="tooltip tooltip-bottom before:text-xs before:content-[attr(data-tip)]" data-tip="commands"><button class="btn btn-ghost btn-circle normal-case btn-sm"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"></path></svg></button></div><div class="tooltip tooltip-bottom before:text-xs before:content-[attr(data-tip)]" data-tip="change theme"><label class="swap swap-rotate btn btn-ghost btn-circle btn-sm"><input type="checkbox"/><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="swap-off" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="swap-on" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path fill-rule="nonzero" d="M10 6a8 8 0 0 0 11.955 6.956C21.474 18.03 17.2 22 12 22 6.477 22 2 17.523 2 12c0-5.2 3.97-9.474 9.044-9.955A7.963 7.963 0 0 0 10 6zm-6 6a8 8 0 0 0 8 8 8.006 8.006 0 0 0 6.957-4.045c-.316.03-.636.045-.957.045-5.523 0-10-4.477-10-10 0-.321.015-.64.045-.957A8.006 8.006 0 0 0 4 12zm14.164-9.709L19 2.5v1l-.836.209a2 2 0 0 0-1.455 1.455L16.5 6h-1l-.209-.836a2 2 0 0 0-1.455-1.455L13 3.5v-1l.836-.209A2 2 0 0 0 15.29.836L15.5 0h1l.209.836a2 2 0 0 0 1.455 1.455zm5 5L24 7.5v1l-.836.209a2 2 0 0 0-1.455 1.455L21.5 11h-1l-.209-.836a2 2 0 0 0-1.455-1.455L18 8.5v-1l.836-.209a2 2 0 0 0 1.455-1.455L20.5 5h1l.209.836a2 2 0 0 0 1.455 1.455z"></path></g></svg></label></div></div></div></header><main class="relative mx-auto min-h-layout max-w-6xl px-8 pt-24 pb-2"><a class="group fixed top-[6.5rem] hidden items-center justify-center text-sm font-medium xl:inline-flex" href="/blog"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 transition duration-200 group-hover:translate-x-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"></path></svg><span>See all Posts</span></a><div class="prose md:prose-lg lg:prose-xl mx-auto  mb-3 lg:mb-5"><h1 class="text-4xl font-extrabold leading-tight md:text-5xl">Angular View-Model (VM) Pattern with combineLatest</h1></div><article class="prose md:prose-lg lg:prose-xl mx-auto"><p>When developing Angular applications, it's important to have a clear separation of concerns between the UI and the data layer. One way to achieve this is by using the View-Model (VM) pattern, where the VM acts as an intermediary between the UI and the data layer.</p>
<p>In this article, we'll explore how to use the VM pattern with the <code>combineLatest</code> operator in Angular to efficiently manage complex UI interactions.</p>
<h2>The VM Pattern</h2>
<p>The VM pattern is a design pattern that separates the concerns of the UI and the data layer. The VM acts as a mediator between the two layers, handling data requests and updates on behalf of the UI.</p>
<p>In Angular, the VM is typically implemented as a component class that contains the UI state and logic. The VM class interacts with the data layer through services and provides data to the UI through observables.</p>
<p>One of the key benefits of using the VM pattern is that it enables developers to decouple the UI from the data layer, making it easier to test and maintain the codebase.</p>
<h2>Using combineLatest</h2>
<p>The <code>combineLatest</code> operator is a powerful tool in the RxJS library that enables developers to combine multiple observables into a single observable. This can be especially useful in the context of the VM pattern, where multiple data streams need to be combined to update the UI state.</p>
<p>Consider a scenario where we have a component that displays a list of posts for a selected user. To implement this functionality using the VM pattern, we would create a VM class that contains two observables: one for the selected user and one for the posts.</p>
<p>We can use the <code>combineLatest</code> operator to combine these two observables into a single observable that emits the posts for the selected user. Here's an example:</p>

<div style="position: relative">
	<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">OnInit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;
<span class="hljs-keyword">import</span> { combineLatest, <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs&#x27;</span>;
<span class="hljs-keyword">import</span> { map } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;rxjs/operators&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Post</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./post&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PostService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./post.service&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">User</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./user&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UserService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./user.service&#x27;</span>;

@<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;app-post-list&#x27;</span>,
  <span class="hljs-attr">template</span>: <span class="hljs-string">`
    &lt;h2&gt;Posts by {{ selectedUser?.name }}&lt;/h2&gt;
    &lt;ul&gt;
      &lt;li *ngFor=&quot;let post of posts$ | async&quot;&gt;
        {{ post.title }}
      &lt;/li&gt;
    &lt;/ul&gt;
  `</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostListComponent</span> implements <span class="hljs-title class_">OnInit</span> {
  <span class="hljs-attr">selectedUser</span>: <span class="hljs-title class_">User</span> | <span class="hljs-literal">undefined</span>;
  <span class="hljs-attr">posts$</span>: <span class="hljs-title class_">Observable</span>&lt;<span class="hljs-title class_">Post</span>[]&gt; | <span class="hljs-literal">undefined</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    private userService: UserService,
    private postService: PostService
  </span>) {}

  <span class="hljs-title function_">ngOnInit</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// Combine the selected user and posts observables using combineLatest</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">posts$</span> = <span class="hljs-title function_">combineLatest</span>([
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">userService</span>.<span class="hljs-property">selectedUser$</span>,
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">postService</span>.<span class="hljs-property">posts$</span>
    ]).<span class="hljs-title function_">pipe</span>(
      <span class="hljs-comment">// Map the combined observables to only return posts by the selected user</span>
      <span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[selectedUser, posts]</span>) =&gt;</span>
        selectedUser ? posts.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">post</span> =&gt;</span> post.<span class="hljs-property">userId</span> === selectedUser.<span class="hljs-property">id</span>) : []
      )
    );
  }

  <span class="hljs-title function_">onSelectUser</span>(<span class="hljs-params">user: User</span>) {
    <span class="hljs-comment">// Set the selected user</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userService</span>.<span class="hljs-title function_">setSelectedUser</span>(user);
  }
}
</code></pre>

	<button class="markdown-it-code-copy btn btn-ghost btn-circle btn-sm" data-clipboard-text="import { Component, OnInit } from &lt;@angular/core&lt;;
import { combineLatest, Observable } from &lt;rxjs&lt;;
import { map } from &lt;rxjs/operators&lt;;
import { Post } from &lt;./post&lt;;
import { PostService } from &lt;./post.service&lt;;
import { User } from &lt;./user&lt;;
import { UserService } from &lt;./user.service&lt;;

@Component({
  selector: &lt;app-post-list&lt;,
  template: `
    <h2>Posts by {{ selectedUser?.name }}</h2>
    <ul>
      <li *ngFor=&quot;let post of posts$ | async&quot;>
        {{ post.title }}
      </li>
    </ul>
  `
})
export class PostListComponent implements OnInit {
  selectedUser: User | undefined;
  posts$: Observable<Post[]> | undefined;

  constructor(
    private userService: UserService,
    private postService: PostService
  ) {}

  ngOnInit() {
    // Combine the selected user and posts observables using combineLatest
    this.posts$ = combineLatest([
      this.userService.selectedUser$,
      this.postService.posts$
    ]).pipe(
      // Map the combined observables to only return posts by the selected user
      map(([selectedUser, posts]) =>
        selectedUser ? posts.filter(post => post.userId === selectedUser.id) : []
      )
    );
  }

  onSelectUser(user: User) {
    // Set the selected user
    this.userService.setSelectedUser(user);
  }
}
" style="position: absolute; top: 7.5px; right: 6px; cursor: pointer; outline: none;" title="Copy">
		<span style="font-size: 21px; opacity: 0.4;" class="fa fa-solid fa-clone text-neutral-content"></span>
	</button>
</div>
<p>In this example, we have a <code>PostListComponent</code> that displays a list of posts for a selected user.</p>
<p>The <code>ngOnInit</code> method of the component sets up the <code>posts$</code> observable by combining the <code>selectedUser$</code> observable from the <code>UserService</code> and the <code>posts$</code> observable from the <code>PostService</code> using <code>combineLatest</code>. The <code>map</code> operator is used to filter the posts to only include those by the selected user.</p>
<p>The <code>onSelectUser</code> method is used to update the selected user in the <code>UserService</code>.</p>
<p>By using <code>combineLatest</code> in this way, we are able to efficiently manage complex UI interactions while maintaining a separation of concerns between the UI and the data layer.</p>
<h2>Conclusion</h2>
<p>In this article, we explored how to use the VM pattern with the <code>combineLatest</code> operator in Angular to efficiently manage complex UI interactions. By decoupling the UI from the data layer and using reactive programming techniques, we can create more maintainable and testable codebases.</p>
<p>As with any design pattern or library, it's important to use these tools in a way that makes sense for your specific application. By understanding the principles behind the VM pattern and <code>combineLatest</code>, we can make informed decisions about when and how to use them in our own projects.</p>
</article><div class="my-8"></div></main><footer class="text-gray-600 "><div class="max-w-6xl px-5 py-4 mx-auto flex items-center sm:flex-row flex-col"><a class="text-primary hover:underline underline-offset-2" aria-label="Email to paskfdev@gmail.com" title="Email to paskfdev@gmail.com" href="mailto:paskfdev@gmail.com">Pasquale Favella</a><p class="text-sm text-gray-500 sm:ml-4 sm:pl-4 sm:border-l-2 sm:border-gray-200 sm:py-2 sm:mt-0 mt-4">©<!-- -->2023<!-- --> • made with 💚</p><span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start gap-4"><a class="transition-all duration-300 hover:text-primary" href="https://github.com/Pasquale-Favella"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a class="transition-all duration-300 hover:text-primary" href="https://it.linkedin.com/in/pasquale-favella-1a3682187"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a></span></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"content":"When developing Angular applications, it's important to have a clear separation of concerns between the UI and the data layer. One way to achieve this is by using the View-Model (VM) pattern, where the VM acts as an intermediary between the UI and the data layer.\r\n\r\nIn this article, we'll explore how to use the VM pattern with the `combineLatest` operator in Angular to efficiently manage complex UI interactions.\r\n\r\n## The VM Pattern\r\n\r\nThe VM pattern is a design pattern that separates the concerns of the UI and the data layer. The VM acts as a mediator between the two layers, handling data requests and updates on behalf of the UI.\r\n\r\nIn Angular, the VM is typically implemented as a component class that contains the UI state and logic. The VM class interacts with the data layer through services and provides data to the UI through observables.\r\n\r\nOne of the key benefits of using the VM pattern is that it enables developers to decouple the UI from the data layer, making it easier to test and maintain the codebase.\r\n\r\n## Using combineLatest\r\n\r\nThe `combineLatest` operator is a powerful tool in the RxJS library that enables developers to combine multiple observables into a single observable. This can be especially useful in the context of the VM pattern, where multiple data streams need to be combined to update the UI state.\r\n\r\nConsider a scenario where we have a component that displays a list of posts for a selected user. To implement this functionality using the VM pattern, we would create a VM class that contains two observables: one for the selected user and one for the posts.\r\n\r\nWe can use the `combineLatest` operator to combine these two observables into a single observable that emits the posts for the selected user. Here's an example:\r\n\r\n```js\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { combineLatest, Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { Post } from './post';\r\nimport { PostService } from './post.service';\r\nimport { User } from './user';\r\nimport { UserService } from './user.service';\r\n\r\n@Component({\r\n  selector: 'app-post-list',\r\n  template: `\r\n    \u003ch2\u003ePosts by {{ selectedUser?.name }}\u003c/h2\u003e\r\n    \u003cul\u003e\r\n      \u003cli *ngFor=\"let post of posts$ | async\"\u003e\r\n        {{ post.title }}\r\n      \u003c/li\u003e\r\n    \u003c/ul\u003e\r\n  `\r\n})\r\nexport class PostListComponent implements OnInit {\r\n  selectedUser: User | undefined;\r\n  posts$: Observable\u003cPost[]\u003e | undefined;\r\n\r\n  constructor(\r\n    private userService: UserService,\r\n    private postService: PostService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    // Combine the selected user and posts observables using combineLatest\r\n    this.posts$ = combineLatest([\r\n      this.userService.selectedUser$,\r\n      this.postService.posts$\r\n    ]).pipe(\r\n      // Map the combined observables to only return posts by the selected user\r\n      map(([selectedUser, posts]) =\u003e\r\n        selectedUser ? posts.filter(post =\u003e post.userId === selectedUser.id) : []\r\n      )\r\n    );\r\n  }\r\n\r\n  onSelectUser(user: User) {\r\n    // Set the selected user\r\n    this.userService.setSelectedUser(user);\r\n  }\r\n}\r\n```\r\nIn this example, we have a `PostListComponent` that displays a list of posts for a selected user.\r\n\r\nThe `ngOnInit` method of the component sets up the `posts$` observable by combining the `selectedUser$` observable from the `UserService` and the `posts$` observable from the `PostService` using `combineLatest`. The `map` operator is used to filter the posts to only include those by the selected user.\r\n\r\nThe `onSelectUser` method is used to update the selected user in the `UserService`.\r\n\r\nBy using `combineLatest` in this way, we are able to efficiently manage complex UI interactions while maintaining a separation of concerns between the UI and the data layer.\r\n\r\n## Conclusion\r\n\r\nIn this article, we explored how to use the VM pattern with the `combineLatest` operator in Angular to efficiently manage complex UI interactions. By decoupling the UI from the data layer and using reactive programming techniques, we can create more maintainable and testable codebases.\r\n\r\nAs with any design pattern or library, it's important to use these tools in a way that makes sense for your specific application. By understanding the principles behind the VM pattern and `combineLatest`, we can make informed decisions about when and how to use them in our own projects.","slug":"10","title":"Angular View-Model (VM) Pattern with combineLatest"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"10"},"buildId":"i2OmoDciPUC_u-z-eiBoC","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>